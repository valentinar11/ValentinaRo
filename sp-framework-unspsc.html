<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UNOPS PDJ ¬∑ SP Framework - UNSPSC Codes</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/primeicons@6.0.1/primeicons.css" />
    <style>
      :root {
        /* UNOPS Preset Primary Colors */
        --primary-50: #e6f7ff;
        --primary-100: #bae7ff;
        --primary-200: #7dd3fc;
        --primary-300: #38bdf8;
        --primary-400: #0ea5e9;
        --primary-500: #0092D1;
        --primary-600: #0284c7;
        --primary-700: #0369a1;
        --primary-800: #003a56;
        --primary-900: #001d2b;

        /* Surface Colors */
        --surface-0: #ffffff;
        --surface-50: #f5f8fb;
        --surface-100: #ebf1f8;
        --surface-200: #dde8f2;
        --surface-300: #cfdfec;
        --surface-400: #a3a3a3;
        --surface-600: #95a7ba;
        --surface-800: #596170;
        --surface-900: #3b3e4a;

        /* Neutral */
        --neutral-50: #f5f8fb;
        --neutral-100: #ebf1f8;
        --neutral-200: #dde8f2;
        --neutral-300: #cfdfec;
        --neutral-400: #a3a3a3;
        --neutral-500: #95a7ba;
        --neutral-600: #596170;
        --neutral-700: #404040;
        --neutral-800: #3b3e4a;
        --neutral-900: #3b3e4a;

        /* Semantic Colors */
        --success-50: #d2e7cd;
        --success-100: #e8f5e9;
        --success-500: #4c9f38;
        --success-600: #4c9f38;
        --success-700: #388e3c;
        
        --info-50: #bfe4f4;
        --info-100: #e3f2fd;
        --info-400: #0092d1;
        --info-500: #2196f3;
        --info-600: #2563eb;
        --info-700: #1976d2;
        
        --warning-50: #f9d6c3;
        --warning-100: #fff3e0;
        --warning-500: #e85c0e;
        --warning-600: #d97706;
        --warning-700: #f57c00;
        
        --danger-50: #f6cac6;
        --danger-100: #fee2e2;
        --danger-500: #da291c;
        --danger-600: #dc2626;

        --purple-50: #f3e8ff;
        --purple-100: #e9d5ff;
        --purple-500: #9333ea;
        --purple-700: #7c3aed;

        /* Text Colors */
        --text-primary: var(--surface-900);
        --text-secondary: var(--surface-800);
        --text-muted: var(--surface-600);

        /* Spacing Scale */
        --spacing-xs: 6px;
        --spacing-sm: 12px;
        --spacing-md: 20px;
        --spacing-lg: 28px;
        --spacing-xl: 36px;
        --spacing-2xl: 48px;
        --spacing-3xl: 64px;

        /* Border Radius */
        --radius-sm: 4px;
        --radius-md: 6px;
        --radius-lg: 8px;
        --radius-xl: 16px;

        /* Shadow System */
        --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.05);
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
        --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.08);
        --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
        --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
        --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);
        --shadow-card: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.06);

        /* Transitions */
        --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
        --transition-base: 200ms cubic-bezier(0.4, 0, 0.2, 1);
        --transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: 'Lato', 'Noto Sans', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        background: var(--surface-50);
        color: var(--text-primary);
        line-height: 1.5;
        min-height: 100vh;
      }

      /* Header */
      .header {
        background: var(--surface-0);
        border-bottom: 1px solid var(--surface-200);
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .header-top {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--spacing-md) var(--spacing-xl);
      }

      .logo-container {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
      }

      .logo {
        font-weight: 700;
        font-size: 20px;
        letter-spacing: 0.12em;
        color: var(--primary-400);
      }

      .portal-badge {
        background: var(--primary-400);
        color: white;
        font-size: 12px;
        font-weight: 600;
        padding: 4px 12px;
        border-radius: 4px;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .user-menu {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
      }

      .user-info {
        text-align: right;
      }

      .user-company {
        font-size: 12px;
        color: var(--text-muted);
      }

      .user-name {
        font-size: 14px;
        font-weight: 500;
        color: var(--text-primary);
      }

      .user-avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background: var(--primary-100);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        color: var(--primary-600);
        cursor: pointer;
      }

      /* Header Actions */
      .header-actions {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        margin-left: auto;
        margin-right: var(--spacing-lg);
      }

      .header-action-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 8px;
        background: transparent;
        border: none;
        border-radius: var(--radius-md);
        color: var(--text-primary);
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        font-size: 13px;
      }

      .header-action-btn:hover {
        background: var(--surface-100);
        transform: scale(1.1);
      }

      .header-action-btn i {
        font-size: 20px;
        color: var(--text-muted);
        transition: color 0.2s ease;
      }

      .header-action-btn:hover i {
        color: var(--primary-500);
      }

      .notification-badge {
        position: absolute;
        top: -4px;
        right: -4px;
        background: var(--danger-500);
        color: white;
        font-size: 10px;
        font-weight: 700;
        min-width: 18px;
        height: 18px;
        border-radius: 9px;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0 5px;
        border: 2px solid white;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      }

      .ai-badge {
        background: linear-gradient(135deg, #8b5cf6, #6366f1);
        color: white;
        font-size: 9px;
        font-weight: 700;
        padding: 2px 6px;
        border-radius: 4px;
        margin-left: 4px;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .ai-icon-wrapper {
        width: 24px;
        height: 24px;
        background: linear-gradient(135deg, #8b5cf6, #6366f1);
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
      }

      .ai-icon-wrapper i {
        font-size: 14px;
        color: white !important;
      }

      .language-selector {
        gap: 4px;
      }

      .lang-flag {
        font-size: 18px;
      }

      /* App Container */
      .app-container {
        display: flex;
        flex-direction: row;
        min-height: calc(100vh - 65px);
        width: 100%;
      }

      /* Sidebar */
      .sidebar {
        width: 300px;
        min-width: 300px;
        max-width: 300px;
        background-color: #0192D1;
        color: white;
        display: flex;
        flex-direction: column;
        border-right: none;
        flex-shrink: 0;
        overflow-y: auto;
      }

      .sidebar-menu {
        flex: 1;
        padding: 16px 0;
      }

      .menu-section {
        margin-bottom: var(--spacing-sm);
      }

      .menu-section-title {
        padding: 8px 20px 12px 20px;
        font-size: 11px;
        font-weight: 700;
        color: rgba(255,255,255,0.5);
        font-family: 'Lato', sans-serif;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .menu-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 20px;
        font-size: 14px;
        color: white;
        cursor: pointer;
        transition: all 0.2s;
        text-decoration: none;
        border-left: 3px solid transparent;
      }

      .menu-item:hover {
        background: rgba(255,255,255,0.1);
      }

      .menu-item.active {
        background: rgba(255,255,255,0.15);
        border-left-color: white;
        font-weight: 600;
      }

      .menu-item.disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .menu-item.disabled:hover {
        background-color: transparent;
      }

      .menu-icon {
        font-size: 16px;
        opacity: 0.9;
        width: 20px;
        text-align: center;
      }

      .menu-divider {
        height: 1px;
        background: rgba(255,255,255,0.15);
        margin: var(--spacing-md) var(--spacing-md);
      }

      .menu-group {
        margin-bottom: var(--spacing-xs);
      }
      
      .menu-group-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 20px;
        font-size: 13px;
        color: rgba(255,255,255,0.9);
        cursor: pointer;
        transition: all 0.2s;
      }
      
      .menu-group-header:hover {
        color: white;
        background: rgba(255,255,255,0.05);
      }
      
      .menu-group-header i {
        font-size: 12px;
        transition: transform 0.2s;
      }
      
      .menu-group.collapsed .menu-group-header i.pi-chevron-down {
        transform: rotate(-90deg);
      }
      
      .menu-group.collapsed .menu-group-items {
        display: none;
      }
      
      .menu-group-items {
        padding-left: 12px;
      }
      
      .menu-group-items .menu-item {
        padding: 10px 20px 10px 28px;
        font-size: 13px;
        border-left: none;
      }
      
      .menu-group-items .menu-item.active {
        background: rgba(255,255,255,0.15);
        border-left: none;
        border-radius: 0 4px 4px 0;
        margin-right: 8px;
      }

      /* Main Content */
      .main-content {
        flex: 1;
        padding: var(--spacing-xl);
        overflow-y: auto;
        min-width: 0;
        position: relative;
        display: flex;
        flex-direction: column;
      }

      /* Page Header */
      .page-header {
        margin-bottom: var(--spacing-lg);
      }

      .page-title {
        font-size: 28px;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: var(--spacing-sm);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .page-title i {
        color: var(--primary-500);
      }

      .page-subtitle {
        font-size: 14px;
        color: var(--text-secondary);
      }

      .breadcrumb {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 13px;
        color: var(--text-muted);
        margin-bottom: var(--spacing-sm);
      }

      .breadcrumb a {
        color: var(--primary-500);
        text-decoration: none;
      }

      .breadcrumb a:hover {
        text-decoration: underline;
      }

      .breadcrumb-separator {
        color: var(--surface-400);
      }

      /* Page Action Bar */
      .page-action-bar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: var(--spacing-sm);
        padding: var(--spacing-md) var(--spacing-lg);
        margin-bottom: var(--spacing-md);
        background: var(--surface-0);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-card);
        border: 1px solid var(--surface-200);
      }

      .page-action-bar-left {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .page-action-bar-right {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      /* Buttons */
      .btn {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 10px 16px;
        border-radius: var(--radius-sm);
        font-size: 14px;
        font-weight: 500;
        font-family: 'Lato', 'Noto Sans', system-ui, sans-serif;
        cursor: pointer;
        border: none;
        transition: all 0.2s;
        text-decoration: none;
      }

      .btn-secondary {
        background: var(--surface-100);
        color: var(--text-primary);
        border: 1px solid var(--surface-200);
      }

      .btn-secondary:hover {
        background: var(--surface-200);
        border-color: var(--surface-300);
      }

      .btn-primary {
        background: var(--primary-500);
        color: white;
      }

      .btn-primary:hover {
        background: var(--primary-600);
      }

      .btn-success {
        background: var(--success-500);
        color: white;
      }

      .btn-success:hover {
        background: var(--success-700);
      }

      .btn-danger {
        background: var(--danger-500);
        color: white;
      }

      .btn-danger:hover {
        background: var(--danger-600);
      }

      .btn-sm {
        padding: 6px 12px;
        font-size: 13px;
      }

      .btn-icon {
        padding: 8px;
        min-width: 36px;
        justify-content: center;
      }

      .btn i {
        font-size: 14px;
      }

      /* Search Input */
      .search-input-wrapper {
        position: relative;
        flex: 1;
        max-width: 400px;
      }

      .search-input-wrapper i {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-muted);
        font-size: 14px;
      }

      .search-input {
        width: 100%;
        padding: 10px 12px 10px 36px;
        border: 1px solid var(--surface-200);
        border-radius: var(--radius-md);
        font-size: 14px;
        font-family: inherit;
        background: var(--surface-0);
        transition: all 0.2s;
      }

      .search-input:focus {
        outline: none;
        border-color: var(--primary-400);
        box-shadow: 0 0 0 3px var(--primary-50);
      }

      /* Filter Chips */
      .filter-chips {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        flex-wrap: wrap;
      }

      .filter-chip {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background: var(--surface-100);
        border: 1px solid var(--surface-200);
        border-radius: 20px;
        font-size: 13px;
        color: var(--text-primary);
        cursor: pointer;
        transition: all 0.2s;
      }

      .filter-chip:hover {
        background: var(--surface-200);
      }

      .filter-chip.active {
        background: var(--primary-50);
        border-color: var(--primary-400);
        color: var(--primary-600);
      }

      .filter-chip i {
        font-size: 12px;
      }

      /* Card */
      .card {
        background: white;
        border-radius: var(--radius-lg);
        border: 1px solid var(--surface-200);
        box-shadow: var(--shadow-card);
        overflow: hidden;
      }

      .card-header {
        padding: var(--spacing-md) var(--spacing-lg);
        border-bottom: 1px solid var(--surface-200);
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: var(--surface-50);
      }

      .card-title {
        font-size: 16px;
        font-weight: 600;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .card-title i {
        color: var(--primary-500);
      }

      .card-body {
        padding: 0;
      }

      /* Data Table */
      .data-table-container {
        overflow-x: auto;
      }

      .data-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 13px;
      }

      .data-table th {
        background: var(--surface-100);
        padding: 14px 16px;
        text-align: left;
        font-weight: 600;
        font-size: 12px;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        border-bottom: 2px solid var(--surface-200);
        white-space: nowrap;
        position: sticky;
        top: 0;
        z-index: 10;
      }

      .data-table th.sortable {
        cursor: pointer;
        user-select: none;
      }

      .data-table th.sortable:hover {
        background: var(--surface-200);
      }

      .data-table th.sortable i {
        margin-left: 4px;
        font-size: 10px;
        color: var(--text-muted);
      }

      .data-table td {
        padding: 12px 16px;
        border-bottom: 1px solid var(--surface-200);
        color: var(--text-primary);
        vertical-align: top;
      }

      .data-table tbody tr:hover {
        background: var(--surface-50);
      }

      .data-table tbody tr:last-child td {
        border-bottom: none;
      }

      .data-table .code-cell {
        font-family: 'Consolas', 'Monaco', monospace;
        font-weight: 600;
        color: var(--primary-600);
        background: var(--primary-50);
        padding: 4px 8px;
        border-radius: var(--radius-sm);
        font-size: 12px;
      }

      .data-table .description-cell {
        max-width: 250px;
        white-space: normal;
        line-height: 1.4;
      }

      .data-table .category-cell {
        font-size: 12px;
        color: var(--text-secondary);
      }

      /* Valid Ranges Cell */
      .valid-ranges {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .valid-range-item {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 6px 10px;
        background: var(--surface-50);
        border: 1px solid var(--surface-200);
        border-radius: var(--radius-sm);
        font-size: 12px;
      }

      .valid-range-item .date-range {
        display: flex;
        align-items: center;
        gap: 4px;
        color: var(--text-secondary);
      }

      .valid-range-item .date-value {
        color: var(--text-primary);
        font-weight: 500;
      }

      .valid-range-item .range-actions {
        display: flex;
        gap: 4px;
        margin-left: auto;
      }

      .valid-range-item .btn-icon-sm {
        padding: 4px;
        background: transparent;
        border: none;
        cursor: pointer;
        border-radius: var(--radius-sm);
        color: var(--text-muted);
        transition: all 0.2s;
      }

      .valid-range-item .btn-icon-sm:hover {
        background: var(--surface-200);
        color: var(--text-primary);
      }

      .valid-range-item .btn-icon-sm.danger:hover {
        background: var(--danger-50);
        color: var(--danger-500);
      }

      .add-range-btn {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 4px 8px;
        background: transparent;
        border: 1px dashed var(--surface-300);
        border-radius: var(--radius-sm);
        font-size: 11px;
        color: var(--primary-500);
        cursor: pointer;
        transition: all 0.2s;
      }

      .add-range-btn:hover {
        background: var(--primary-50);
        border-color: var(--primary-400);
      }

      .no-dates {
        color: var(--text-muted);
        font-size: 12px;
        font-style: italic;
      }

      /* Category Badge */
      .category-badge {
        display: inline-flex;
        align-items: center;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.03em;
      }

      .category-badge.none {
        background: var(--surface-100);
        color: var(--text-muted);
      }

      .category-badge.part2 {
        background: var(--info-50);
        color: var(--info-600);
      }

      .category-badge.part3 {
        background: var(--warning-50);
        color: var(--warning-500);
      }

      /* Row Actions */
      .row-actions {
        display: flex;
        gap: 4px;
        justify-content: flex-end;
      }

      .row-actions .btn-icon {
        padding: 6px;
        min-width: 28px;
        background: transparent;
        border: 1px solid transparent;
      }

      .row-actions .btn-icon:hover {
        background: var(--surface-100);
        border-color: var(--surface-200);
      }

      /* Stats Summary */
      .stats-summary {
        display: flex;
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-lg);
      }

      .stat-card {
        flex: 1;
        background: var(--surface-0);
        border: 1px solid var(--surface-200);
        border-radius: var(--radius-lg);
        padding: var(--spacing-md);
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
      }

      .stat-icon {
        width: 48px;
        height: 48px;
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
      }

      .stat-icon.blue {
        background: var(--primary-50);
        color: var(--primary-500);
      }

      .stat-icon.green {
        background: var(--success-50);
        color: var(--success-500);
      }

      .stat-icon.orange {
        background: var(--warning-50);
        color: var(--warning-500);
      }

      .stat-icon.purple {
        background: var(--purple-50);
        color: var(--purple-500);
      }

      .stat-content {
        flex: 1;
      }

      .stat-value {
        font-size: 24px;
        font-weight: 700;
        color: var(--text-primary);
      }

      .stat-label {
        font-size: 13px;
        color: var(--text-muted);
      }

      /* Pagination */
      .pagination {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--spacing-md) var(--spacing-lg);
        border-top: 1px solid var(--surface-200);
        background: var(--surface-50);
      }

      .pagination-info {
        font-size: 13px;
        color: var(--text-muted);
      }

      .pagination-controls {
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .pagination-btn {
        padding: 6px 12px;
        background: var(--surface-0);
        border: 1px solid var(--surface-200);
        border-radius: var(--radius-sm);
        font-size: 13px;
        cursor: pointer;
        transition: all 0.2s;
      }

      .pagination-btn:hover:not(:disabled) {
        background: var(--surface-100);
        border-color: var(--surface-300);
      }

      .pagination-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .pagination-btn.active {
        background: var(--primary-500);
        color: white;
        border-color: var(--primary-500);
      }

      /* Modal */
      .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(4px);
      }

      .modal-overlay.active {
        display: flex;
      }

      .modal-content {
        background: white;
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-xl);
        max-width: 800px;
        width: 90%;
        max-height: 90vh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      .modal-header {
        padding: var(--spacing-lg);
        border-bottom: 1px solid var(--surface-200);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .modal-title i {
        color: var(--primary-500);
      }

      .modal-close-btn {
        width: 36px;
        height: 36px;
        border: none;
        background: var(--surface-100);
        border-radius: var(--radius-md);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
        color: var(--text-secondary);
        transition: all 0.2s;
      }

      .modal-close-btn:hover {
        background: var(--danger-50);
        color: var(--danger-500);
      }

      .modal-body {
        flex: 1;
        overflow-y: auto;
        padding: var(--spacing-lg);
      }

      .modal-footer {
        padding: var(--spacing-md) var(--spacing-lg);
        border-top: 1px solid var(--surface-200);
        display: flex;
        justify-content: flex-end;
        gap: var(--spacing-sm);
        background: var(--surface-50);
      }

      /* Form Elements */
      .form-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: var(--spacing-md);
      }

      .form-grid.cols-3 {
        grid-template-columns: repeat(3, 1fr);
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .form-group.full-width {
        grid-column: 1 / -1;
      }

      .form-label {
        font-size: 13px;
        font-weight: 500;
        color: var(--text-primary);
      }

      .form-label .required {
        color: var(--danger-500);
      }

      .form-control {
        padding: 10px 12px;
        border: 1px solid var(--surface-200);
        border-radius: var(--radius-md);
        font-size: 14px;
        font-family: inherit;
        background: var(--surface-0);
        transition: all 0.2s;
      }

      .form-control:focus {
        outline: none;
        border-color: var(--primary-400);
        box-shadow: 0 0 0 3px var(--primary-50);
      }

      .form-control:disabled {
        background: var(--surface-100);
        color: var(--text-muted);
      }

      select.form-control {
        cursor: pointer;
      }

      textarea.form-control {
        resize: vertical;
        min-height: 80px;
      }

      .form-hint {
        font-size: 12px;
        color: var(--text-muted);
      }

      /* Valid Ranges Form Section */
      .valid-ranges-section {
        margin-top: var(--spacing-lg);
        padding-top: var(--spacing-lg);
        border-top: 1px solid var(--surface-200);
      }

      .valid-ranges-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--spacing-md);
      }

      .valid-ranges-title {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-primary);
      }

      .valid-ranges-list {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-sm);
      }

      .valid-range-row {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        padding: var(--spacing-sm) var(--spacing-md);
        background: var(--surface-50);
        border: 1px solid var(--surface-200);
        border-radius: var(--radius-md);
      }

      .valid-range-row .form-group {
        flex: 1;
        margin: 0;
      }

      .valid-range-row .form-label {
        font-size: 11px;
        margin-bottom: 4px;
      }

      .valid-range-row .form-control {
        padding: 8px 10px;
        font-size: 13px;
      }

      .remove-range-btn {
        padding: 8px;
        background: transparent;
        border: none;
        cursor: pointer;
        color: var(--text-muted);
        border-radius: var(--radius-sm);
        transition: all 0.2s;
      }

      .remove-range-btn:hover {
        background: var(--danger-50);
        color: var(--danger-500);
      }

      .empty-ranges {
        padding: var(--spacing-lg);
        text-align: center;
        color: var(--text-muted);
        font-size: 13px;
        border: 1px dashed var(--surface-300);
        border-radius: var(--radius-md);
      }

      /* Tooltip */
      .tooltip-trigger {
        position: relative;
        cursor: help;
      }

      .tooltip-trigger .tooltip-content {
        display: none;
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        padding: 8px 12px;
        background: var(--surface-900);
        color: white;
        font-size: 12px;
        border-radius: var(--radius-sm);
        white-space: nowrap;
        z-index: 100;
        margin-bottom: 4px;
      }

      .tooltip-trigger:hover .tooltip-content {
        display: block;
      }

      /* Part 3 Comment Cell */
      .part3-comment {
        max-width: 200px;
        font-size: 12px;
        color: var(--warning-600);
        background: var(--warning-50);
        padding: 6px 10px;
        border-radius: var(--radius-sm);
        white-space: normal;
        line-height: 1.4;
      }
    </style>
  </head>
  <body>
    <div class="app">
      <!-- Header -->
      <header class="header" role="banner">
        <div class="header-top">
          <div class="logo-container">
            <div class="logo">UNOPS</div>
            <span class="portal-badge">Procurement</span>
            <span style="color: var(--surface-400); margin: 0 8px; font-size: 18px;">|</span>
            <span style="color: var(--primary-500); font-weight: 600; font-size: 14px;">DRiVE</span>
          </div>

          <!-- Header Actions -->
          <div class="header-actions">
            <!-- Accessibility Button -->
            <div class="header-action-btn" title="Accessibility Options" aria-label="Accessibility Options">
              <i class="pi pi-eye" aria-hidden="true"></i>
            </div>

            <!-- Language Selector -->
            <div class="header-action-btn language-selector" title="Change Language" aria-label="Change Language">
              <span class="lang-flag">üåê</span>
            </div>

            <!-- AI Assistant -->
            <div class="header-action-btn ai-assistant-btn" title="AI Assistant" aria-label="AI Procurement Assistant">
              <div class="ai-icon-wrapper">
                <i class="pi pi-bolt" aria-hidden="true"></i>
              </div>
              <span class="ai-badge">NEW</span>
            </div>

            <!-- Help/Questions -->
            <div class="header-action-btn" title="Help Center" aria-label="Help Center">
              <i class="pi pi-question-circle" aria-hidden="true"></i>
            </div>

            <!-- Notifications -->
            <div class="header-action-btn notification-btn" title="Notifications" aria-label="View Notifications">
              <i class="pi pi-bell" aria-hidden="true"></i>
              <span class="notification-badge">3</span>
            </div>
          </div>

          <div class="user-menu">
            <div class="user-info">
              <div class="user-company">UNOPS Internal</div>
              <div class="user-name">Jane Doe</div>
            </div>
            <div class="user-avatar" aria-label="User menu">JD</div>
          </div>
        </div>
      </header>

      <!-- App Container -->
      <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
          <nav class="sidebar-menu">
            <!-- Administrative Applications -->
            <div class="menu-section">
              <div class="menu-section-title">Administrative Applications</div>
              
              <!-- System Settings -->
              <div class="menu-group collapsed">
                <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                  <span><i class="pi pi-cog"></i> System Settings</span>
                  <i class="pi pi-chevron-down"></i>
                </div>
                <div class="menu-group-items">
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-users"></i></span><span>User Role Management</span></a>
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-id-card"></i></span><span>Role Management</span></a>
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-sliders-h"></i></span><span>Attribute Management</span></a>
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-database"></i></span><span>Data Management</span></a>
                  <a class="menu-item" href="translation-management.html"><span class="menu-icon"><i class="pi pi-language"></i></span><span>Translations</span></a>
                </div>
              </div>
              
              <!-- Components -->
              <div class="menu-group collapsed">
                <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                  <span><i class="pi pi-box"></i> Components</span>
                  <i class="pi pi-chevron-down"></i>
                </div>
                <div class="menu-group-items">
                  <a class="menu-item"><span class="menu-icon"><i class="pi pi-list"></i></span><span>Evaluation Criteria Library</span></a>
                  <a class="menu-item"><span class="menu-icon"><i class="pi pi-cog"></i></span><span>Specifications Library</span></a>
                </div>
              </div>
              
              <!-- Forms -->
              <div class="menu-group collapsed">
                <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                  <span><i class="pi pi-file-edit"></i> Forms</span>
                  <i class="pi pi-chevron-down"></i>
                </div>
                <div class="menu-group-items">
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-folder"></i></span><span>Forms Library</span></a>
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-pencil"></i></span><span>Form Builder</span></a>
                </div>
              </div>
              
              <!-- Templates -->
              <div class="menu-group collapsed">
                <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                  <span><i class="pi pi-copy"></i> Templates</span>
                  <i class="pi pi-chevron-down"></i>
                </div>
                <div class="menu-group-items">
                  <a class="menu-item" href="template-library.html"><span class="menu-icon"><i class="pi pi-folder"></i></span><span>Templates Library</span></a>
                  <a class="menu-item" href="template-builder-workspace.html"><span class="menu-icon"><i class="pi pi-pencil"></i></span><span>Template Builder</span></a>
                </div>
              </div>
            </div>
            
            <div class="menu-divider"></div>
            
            <!-- Business Applications -->
            <div class="menu-section">
              <div class="menu-section-title">Business Applications</div>
              
              <!-- eTendering -->
              <div class="menu-group collapsed">
                <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                  <span><i class="pi pi-briefcase"></i> eTendering</span>
                  <i class="pi pi-chevron-down"></i>
                </div>
                <div class="menu-group-items">
                  <a class="menu-item" href="tender-dashboard-complete.html"><span class="menu-icon"><i class="pi pi-chart-bar"></i></span><span>Overview</span></a>
                  <a class="menu-item" href="tender-dashboard-complete.html"><span class="menu-icon"><i class="pi pi-folder-open"></i></span><span>Tenders</span></a>
                  <a class="menu-item" href="tender-authoring.html"><span class="menu-icon"><i class="pi pi-plus"></i></span><span>Create Tender</span></a>
                </div>
              </div>
              
              <!-- Award & Review -->
              <div class="menu-group collapsed">
                <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                  <span><i class="pi pi-check-square"></i> Award & Review</span>
                  <i class="pi pi-chevron-down"></i>
                </div>
                <div class="menu-group-items">
                  <a class="menu-item" href="CPC.html"><span class="menu-icon"><i class="pi pi-chart-bar"></i></span><span>Overview</span></a>
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-folder"></i></span><span>Cases</span></a>
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-calendar"></i></span><span>Meetings</span></a>
                </div>
              </div>
              
              <!-- DRiVE - Expanded -->
              <div class="menu-group">
                <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                  <span><i class="pi pi-shield"></i> DRiVE</span>
                  <i class="pi pi-chevron-down"></i>
                </div>
                <div class="menu-group-items">
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-chart-bar"></i></span><span>Overview</span></a>
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-inbox"></i></span><span>Response Library</span></a>
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-check-circle"></i></span><span>Verification</span></a>
                  <a class="menu-item" href="capa-interactive-mockup.html"><span class="menu-icon"><i class="pi pi-exclamation-triangle"></i></span><span>CAPA</span></a>
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-question-circle"></i></span><span>Questionnaire Management</span></a>
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-chart-line"></i></span><span>Risk Management</span></a>
                  
                  <!-- Data Management Sub-group -->
                  <div class="menu-group" style="margin-left: -12px; margin-top: 4px;">
                    <div class="menu-group-header" onclick="toggleMenuGroup(this)" style="padding-left: 40px;">
                      <span><i class="pi pi-database"></i> Data Management</span>
                      <i class="pi pi-chevron-down"></i>
                    </div>
                    <div class="menu-group-items">
                      <a class="menu-item active" href="sp-framework-unspsc.html" style="padding-left: 52px;"><span class="menu-icon"><i class="pi pi-tags"></i></span><span>SP Framework</span></a>
                      <a class="menu-item disabled" style="padding-left: 52px;"><span class="menu-icon"><i class="pi pi-sitemap"></i></span><span>Category Mapping</span></a>
                      <a class="menu-item disabled" style="padding-left: 52px;"><span class="menu-icon"><i class="pi pi-file-import"></i></span><span>Data Import</span></a>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Contracts -->
              <div class="menu-group collapsed">
                <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                  <span><i class="pi pi-file"></i> Contracts</span>
                  <i class="pi pi-chevron-down"></i>
                </div>
                <div class="menu-group-items">
                  <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-list"></i></span><span>Contract Management</span></a>
                </div>
              </div>
              
              <!-- Supplier Management -->
              <div class="menu-group collapsed">
                <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                  <span><i class="pi pi-truck"></i> Supplier Management</span>
                  <i class="pi pi-chevron-down"></i>
                </div>
                <div class="menu-group-items">
                  <a class="menu-item" href="supplier-management-procurement.html"><span class="menu-icon"><i class="pi pi-building"></i></span><span>Suppliers</span></a>
                </div>
              </div>
            </div>
          </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
          <!-- Breadcrumb -->
          <div class="breadcrumb">
            <a href="#">DRiVE</a>
            <span class="breadcrumb-separator"><i class="pi pi-chevron-right"></i></span>
            <a href="#">Data Management</a>
            <span class="breadcrumb-separator"><i class="pi pi-chevron-right"></i></span>
            <span>SP Framework</span>
          </div>

          <!-- Page Header -->
          <div class="page-header">
            <h1 class="page-title"><i class="pi pi-tags"></i> SP Framework - UNSPSC Rules</h1>
            <p class="page-subtitle">Manage UNSPSC codes and their procurement category classifications for the SP Framework validation rules.</p>
          </div>

          <!-- Stats Summary -->
          <div class="stats-summary">
            <div class="stat-card">
              <div class="stat-icon blue">
                <i class="pi pi-tags"></i>
              </div>
              <div class="stat-content">
                <div class="stat-value">156</div>
                <div class="stat-label">Total UNSPSC Rules</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon green">
                <i class="pi pi-check-circle"></i>
              </div>
              <div class="stat-content">
                <div class="stat-value">142</div>
                <div class="stat-label">Active Rules</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon orange">
                <i class="pi pi-exclamation-triangle"></i>
              </div>
              <div class="stat-content">
                <div class="stat-value">28</div>
                <div class="stat-label">Part 2/3 Flagged</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon purple">
                <i class="pi pi-calendar"></i>
              </div>
              <div class="stat-content">
                <div class="stat-value">14</div>
                <div class="stat-label">With Date Ranges</div>
              </div>
            </div>
          </div>

          <!-- Page Action Bar -->
          <div class="page-action-bar">
            <div class="page-action-bar-left">
              <div class="search-input-wrapper">
                <i class="pi pi-search"></i>
                <input type="text" class="search-input" placeholder="Search by UNSPSC code or description..." />
              </div>
              <div class="filter-chips">
                <div class="filter-chip active">
                  <i class="pi pi-list"></i> All Rules
                </div>
                <div class="filter-chip">
                  <i class="pi pi-flag"></i> Part 2/3 Only
                </div>
                <div class="filter-chip">
                  <i class="pi pi-calendar"></i> With Dates
                </div>
              </div>
            </div>
            <div class="page-action-bar-right">
              <button class="btn btn-secondary"><i class="pi pi-download"></i> Export</button>
              <button class="btn btn-secondary"><i class="pi pi-upload"></i> Import</button>
              <button class="btn btn-primary" onclick="openAddModal()"><i class="pi pi-plus"></i> Add Rule</button>
            </div>
          </div>

          <!-- Data Table Card -->
          <div class="card">
            <div class="card-header">
              <div class="card-title">
                <i class="pi pi-table"></i>
                UNSPSC Rules
                <span style="font-size: 13px; font-weight: 400; color: var(--text-muted);">(Showing 1-25 of 156)</span>
              </div>
              <div style="display: flex; gap: 8px;">
                <select class="form-control" style="padding: 6px 10px; font-size: 12px; min-width: 140px;">
                  <option>Category Level 1</option>
                  <option selected>Equipment and Materials</option>
                  <option>Services</option>
                  <option>Works</option>
                </select>
              </div>
            </div>
            <div class="card-body">
              <div class="data-table-container">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th class="sortable">UNSPSC <i class="pi pi-sort-alt"></i></th>
                      <th>Level 1</th>
                      <th>Level 2</th>
                      <th>Level 3</th>
                      <th class="sortable">Description <i class="pi pi-sort-alt"></i></th>
                      <th>Part 2/3 Category</th>
                      <th>Part 3 Comment</th>
                      <th>Valid Ranges</th>
                      <th style="text-align: center; width: 80px;">Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><span class="code-cell">46151605</span></td>
                      <td class="category-cell">Equipment and Materials</td>
                      <td class="category-cell">Demining and Disarmament</td>
                      <td class="category-cell">Demining Equipment and Related Products</td>
                      <td class="description-cell">Weapon or explosives detectors and supplies</td>
                      <td><span class="category-badge none">None of the below or N/A</span></td>
                      <td>‚Äî</td>
                      <td>
                        <div class="valid-ranges">
                          <div class="valid-range-item">
                            <div class="date-range">
                              <span class="date-value">1/Jan/2026</span>
                              <span>‚Üí</span>
                              <span class="date-value">3/Jan/2026</span>
                            </div>
                            <div class="range-actions">
                              <button class="btn-icon-sm" title="Edit"><i class="pi pi-pencil"></i></button>
                              <button class="btn-icon-sm danger" title="Remove"><i class="pi pi-times"></i></button>
                            </div>
                          </div>
                          <button class="add-range-btn" onclick="openAddRangeModal('46151605')"><i class="pi pi-plus"></i> Add range</button>
                        </div>
                      </td>
                      <td>
                        <div class="row-actions">
                          <button class="btn btn-icon btn-sm" title="View Rule" onclick="openViewModal('46151605')"><i class="pi pi-eye"></i></button>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td><span class="code-cell">92111604</span></td>
                      <td class="category-cell">Equipment and Materials</td>
                      <td class="category-cell">Demining and Disarmament</td>
                      <td class="category-cell">Demining and Explosive Detection Services</td>
                      <td class="description-cell">Weapons destruction</td>
                      <td><span class="category-badge none">None of the below or N/A</span></td>
                      <td>‚Äî</td>
                      <td>
                        <span class="no-dates">No date restrictions</span>
                        <button class="add-range-btn" onclick="openAddRangeModal('92111604')"><i class="pi pi-plus"></i> Add range</button>
                      </td>
                      <td>
                        <div class="row-actions">
                          <button class="btn btn-icon btn-sm" title="View Rule" onclick="openViewModal('92111604')"><i class="pi pi-eye"></i></button>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td><span class="code-cell">92111616</span></td>
                      <td class="category-cell">Equipment and Materials</td>
                      <td class="category-cell">Demining and Disarmament</td>
                      <td class="category-cell">Demining and Explosive Detection Services</td>
                      <td class="description-cell">Landmine prohibition action and explosive remnants of war advocacy</td>
                      <td><span class="category-badge none">None of the below or N/A</span></td>
                      <td>‚Äî</td>
                      <td>
                        <span class="no-dates">No date restrictions</span>
                        <button class="add-range-btn" onclick="openAddRangeModal('92111616')"><i class="pi pi-plus"></i> Add range</button>
                      </td>
                      <td>
                        <div class="row-actions">
                          <button class="btn btn-icon btn-sm" title="View Rule" onclick="openViewModal('92111616')"><i class="pi pi-eye"></i></button>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td><span class="code-cell">81102811</span></td>
                      <td class="category-cell">Equipment and Materials</td>
                      <td class="category-cell">Demining and Disarmament</td>
                      <td class="category-cell">Demining and Explosive Detection Services</td>
                      <td class="description-cell">Explosive Detection Dogs (EDD) with handler (Canine explosive detection team)</td>
                      <td><span class="category-badge none">None of the below or N/A</span></td>
                      <td>‚Äî</td>
                      <td>
                        <span class="no-dates">No date restrictions</span>
                        <button class="add-range-btn" onclick="openAddRangeModal('81102811')"><i class="pi pi-plus"></i> Add range</button>
                      </td>
                      <td>
                        <div class="row-actions">
                          <button class="btn btn-icon btn-sm" title="View Rule" onclick="openViewModal('81102811')"><i class="pi pi-eye"></i></button>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td><span class="code-cell">26111609</span></td>
                      <td class="category-cell">Equipment and Materials</td>
                      <td class="category-cell">Electricity Generation and Storage</td>
                      <td class="category-cell">Generators - Other</td>
                      <td class="description-cell">Gas turbine generator</td>
                      <td><span class="category-badge part2">Part 2: Generators</span></td>
                      <td>‚Äî</td>
                      <td>
                        <span class="no-dates">No date restrictions</span>
                        <button class="add-range-btn" onclick="openAddRangeModal('26111609')"><i class="pi pi-plus"></i> Add range</button>
                      </td>
                      <td>
                        <div class="row-actions">
                          <button class="btn btn-icon btn-sm" title="View Rule" onclick="openViewModal('26111609')"><i class="pi pi-eye"></i></button>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td><span class="code-cell">26111607</span></td>
                      <td class="category-cell">Equipment and Materials</td>
                      <td class="category-cell">Electricity Generation and Storage</td>
                      <td class="category-cell">Generators - Solar</td>
                      <td class="description-cell">Solar generators</td>
                      <td><span class="category-badge part2">Part 2: Generators</span></td>
                      <td>‚Äî</td>
                      <td>
                        <span class="no-dates">No date restrictions</span>
                        <button class="add-range-btn" onclick="openAddRangeModal('26111607')"><i class="pi pi-plus"></i> Add range</button>
                      </td>
                      <td>
                        <div class="row-actions">
                          <button class="btn btn-icon btn-sm" title="View Rule" onclick="openViewModal('26111607')"><i class="pi pi-eye"></i></button>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td><span class="code-cell">26111601</span></td>
                      <td class="category-cell">Equipment and Materials</td>
                      <td class="category-cell">Electricity Generation and Storage</td>
                      <td class="category-cell">Generators - Diesel</td>
                      <td class="description-cell">Diesel generators</td>
                      <td><span class="category-badge part3">Part 3: Diesel generators</span></td>
                      <td>
                        <div class="part3-comment">Part 3: Diesel generators. This is a direct mention of a product containing diesel generators.</div>
                      </td>
                      <td>
                        <span class="no-dates">No date restrictions</span>
                        <button class="add-range-btn" onclick="openAddRangeModal('26111601')"><i class="pi pi-plus"></i> Add range</button>
                      </td>
                      <td>
                        <div class="row-actions">
                          <button class="btn btn-icon btn-sm" title="View Rule" onclick="openViewModal('26111601')"><i class="pi pi-eye"></i></button>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td><span class="code-cell">26111705</span></td>
                      <td class="category-cell">Equipment and Materials</td>
                      <td class="category-cell">Electricity Generation and Storage</td>
                      <td class="category-cell">Batteries</td>
                      <td class="description-cell">Dry cell batteries</td>
                      <td><span class="category-badge none">None of the below or N/A</span></td>
                      <td>‚Äî</td>
                      <td>
                        <span class="no-dates">No date restrictions</span>
                        <button class="add-range-btn" onclick="openAddRangeModal('26111705')"><i class="pi pi-plus"></i> Add range</button>
                      </td>
                      <td>
                        <div class="row-actions">
                          <button class="btn btn-icon btn-sm" title="View Rule" onclick="openViewModal('26111705')"><i class="pi pi-eye"></i></button>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td><span class="code-cell">26111704</span></td>
                      <td class="category-cell">Equipment and Materials</td>
                      <td class="category-cell">Electricity Generation and Storage</td>
                      <td class="category-cell">Batteries</td>
                      <td class="description-cell">Battery chargers</td>
                      <td><span class="category-badge none">None of the below or N/A</span></td>
                      <td>‚Äî</td>
                      <td>
                        <div class="valid-ranges">
                          <div class="valid-range-item">
                            <div class="date-range">
                              <span class="date-value">15/Feb/2026</span>
                              <span>‚Üí</span>
                              <span class="date-value">31/Dec/2026</span>
                            </div>
                            <div class="range-actions">
                              <button class="btn-icon-sm" title="Edit"><i class="pi pi-pencil"></i></button>
                              <button class="btn-icon-sm danger" title="Remove"><i class="pi pi-times"></i></button>
                            </div>
                          </div>
                          <div class="valid-range-item">
                            <div class="date-range">
                              <span class="date-value">1/Jan/2027</span>
                              <span>‚Üí</span>
                              <span class="date-value">30/Jun/2027</span>
                            </div>
                            <div class="range-actions">
                              <button class="btn-icon-sm" title="Edit"><i class="pi pi-pencil"></i></button>
                              <button class="btn-icon-sm danger" title="Remove"><i class="pi pi-times"></i></button>
                            </div>
                          </div>
                          <button class="add-range-btn" onclick="openAddRangeModal('26111704')"><i class="pi pi-plus"></i> Add range</button>
                        </div>
                      </td>
                      <td>
                        <div class="row-actions">
                          <button class="btn btn-icon btn-sm" title="View Rule" onclick="openViewModal('26111704')"><i class="pi pi-eye"></i></button>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td><span class="code-cell">46221507</span></td>
                      <td class="category-cell">Equipment and Materials</td>
                      <td class="category-cell">Demining and Disarmament</td>
                      <td class="category-cell">Demining Equipment and Related Products</td>
                      <td class="description-cell">Demining machine parts and accessories</td>
                      <td><span class="category-badge none">None of the below or N/A</span></td>
                      <td>‚Äî</td>
                      <td>
                        <span class="no-dates">No date restrictions</span>
                        <button class="add-range-btn" onclick="openAddRangeModal('46221507')"><i class="pi pi-plus"></i> Add range</button>
                      </td>
                      <td>
                        <div class="row-actions">
                          <button class="btn btn-icon btn-sm" title="View Rule" onclick="openViewModal('46221507')"><i class="pi pi-eye"></i></button>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              
              <!-- Pagination -->
              <div class="pagination">
                <div class="pagination-info">
                  Showing <strong>1-10</strong> of <strong>156</strong> rules
                </div>
                <div class="pagination-controls">
                  <button class="pagination-btn" disabled><i class="pi pi-angle-left"></i></button>
                  <button class="pagination-btn active">1</button>
                  <button class="pagination-btn">2</button>
                  <button class="pagination-btn">3</button>
                  <button class="pagination-btn">...</button>
                  <button class="pagination-btn">16</button>
                  <button class="pagination-btn"><i class="pi pi-angle-right"></i></button>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <!-- Add/View Rule Modal -->
    <div class="modal-overlay" id="ruleModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title"><i class="pi pi-plus-circle" id="modalIcon"></i> <span id="modalTitle">Add New UNSPSC Rule</span></h2>
          <button class="modal-close-btn" onclick="closeModal()"><i class="pi pi-times"></i></button>
        </div>
        <div class="modal-body">
          <div class="form-grid">
            <div class="form-group">
              <label class="form-label">UNSPSC Code <span class="required">*</span></label>
              <input type="text" class="form-control" id="unspscCode" placeholder="e.g., 46151605" maxlength="8" />
              <span class="form-hint">8-digit UNSPSC code</span>
            </div>
            <div class="form-group">
              <label class="form-label">Procurement Category Level 1 <span class="required">*</span></label>
              <select class="form-control" id="categoryLevel1">
                <option value="">Select Level 1 Category</option>
                <option value="equipment">Equipment and Materials</option>
                <option value="services">Services</option>
                <option value="works">Works</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Procurement Category Level 2 <span class="required">*</span></label>
              <select class="form-control" id="categoryLevel2">
                <option value="">Select Level 2 Category</option>
                <option value="demining">Demining and Disarmament</option>
                <option value="electricity">Electricity Generation and Storage</option>
                <option value="vehicles">Vehicles</option>
                <option value="medical">Medical Equipment</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Procurement Category Level 3 <span class="required">*</span></label>
              <select class="form-control" id="categoryLevel3">
                <option value="">Select Level 3 Category</option>
                <option value="demining-equipment">Demining Equipment and Related Products</option>
                <option value="demining-services">Demining and Explosive Detection Services</option>
                <option value="generators-diesel">Generators - Diesel</option>
                <option value="generators-solar">Generators - Solar</option>
                <option value="generators-other">Generators - Other</option>
                <option value="batteries">Batteries</option>
              </select>
            </div>
            <div class="form-group full-width">
              <label class="form-label">UNSPSC Description <span class="required">*</span></label>
              <input type="text" class="form-control" id="unspscDescription" placeholder="Enter UNSPSC description" />
            </div>
            <div class="form-group">
              <label class="form-label">Part 2/3 Category</label>
              <select class="form-control" id="part23Category">
                <option value="none">None of the below or N/A</option>
                <option value="part2-generators">Part 2: Generators</option>
                <option value="part3-diesel">Part 3: Diesel generators</option>
                <option value="part2-vehicles">Part 2: Vehicles</option>
                <option value="part3-vehicles">Part 3: Commercial Vehicles</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Part 3 Comment</label>
              <input type="text" class="form-control" id="part3Comment" placeholder="Optional comment for Part 3 items" />
            </div>
          </div>

          <!-- Valid Ranges Section -->
          <div class="valid-ranges-section">
            <div class="valid-ranges-header">
              <h3 class="valid-ranges-title"><i class="pi pi-calendar"></i> Valid Date Ranges</h3>
              <button class="btn btn-sm btn-secondary" id="addRangeInModalBtn" onclick="addValidRange()"><i class="pi pi-plus"></i> Add Range</button>
            </div>
            <div class="valid-ranges-list" id="validRangesList">
              <div class="empty-ranges" id="emptyRangesMessage">
                <i class="pi pi-calendar-times" style="font-size: 24px; margin-bottom: 8px; display: block;"></i>
                No date restrictions defined. This rule will apply at all times.<br>
                <span style="font-size: 12px; color: var(--text-muted);">Click "Add Range" to define specific validity periods.</span>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <div class="view-mode-notice" id="viewModeNotice" style="display: none; flex: 1; text-align: left;">
            <span style="color: var(--warning-600); font-size: 13px;">
              <i class="pi pi-info-circle"></i> 
              Rule parameters cannot be modified. To change parameters, create a new rule.
            </span>
          </div>
          <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
          <button class="btn btn-primary" id="saveRuleBtn" onclick="saveRule()"><i class="pi pi-check"></i> Save Rule</button>
        </div>
      </div>
    </div>

    <!-- Quick Add Date Range Modal -->
    <div class="modal-overlay" id="rangeModal">
      <div class="modal-content" style="max-width: 450px;">
        <div class="modal-header">
          <h2 class="modal-title"><i class="pi pi-calendar-plus"></i> Add Valid Range</h2>
          <button class="modal-close-btn" onclick="closeRangeModal()"><i class="pi pi-times"></i></button>
        </div>
        <div class="modal-body">
          <p style="margin-bottom: var(--spacing-md); color: var(--text-secondary); font-size: 13px;">
            Adding validity range for UNSPSC: <strong id="rangeUnspscCode">‚Äî</strong>
          </p>
          <div class="form-grid">
            <div class="form-group">
              <label class="form-label">Valid From <span class="required">*</span></label>
              <input type="date" class="form-control" id="rangeValidFrom" />
            </div>
            <div class="form-group">
              <label class="form-label">Valid To <span class="required">*</span></label>
              <input type="date" class="form-control" id="rangeValidTo" />
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeRangeModal()">Cancel</button>
          <button class="btn btn-primary" onclick="saveRange()"><i class="pi pi-check"></i> Add Range</button>
        </div>
      </div>
    </div>

    <script>
      // Menu Toggle
      function toggleMenuGroup(header) {
        const group = header.parentElement;
        group.classList.toggle('collapsed');
      }

      // Modal Functions
      function openAddModal() {
        document.getElementById('modalTitle').textContent = 'Add New UNSPSC Rule';
        document.getElementById('modalIcon').className = 'pi pi-plus-circle';
        document.getElementById('ruleModal').classList.add('active');
        clearForm();
      }

      function openViewModal(unspscCode) {
        document.getElementById('modalTitle').textContent = 'View UNSPSC Rule - ' + unspscCode;
        document.getElementById('modalIcon').className = 'pi pi-eye';
        document.getElementById('ruleModal').classList.add('active');
        
        // Disable all form fields for view mode
        document.getElementById('unspscCode').value = unspscCode;
        document.getElementById('unspscCode').disabled = true;
        document.getElementById('categoryLevel1').disabled = true;
        document.getElementById('categoryLevel2').disabled = true;
        document.getElementById('categoryLevel3').disabled = true;
        document.getElementById('unspscDescription').disabled = true;
        document.getElementById('part23Category').disabled = true;
        document.getElementById('part3Comment').disabled = true;
        
        // Hide save button, show close only, hide Add Range button in modal
        document.getElementById('saveRuleBtn').style.display = 'none';
        document.getElementById('viewModeNotice').style.display = 'flex';
        document.getElementById('addRangeInModalBtn').style.display = 'none';
        
        // In real implementation, populate form with existing data
      }

      function closeModal() {
        document.getElementById('ruleModal').classList.remove('active');
        
        // Reset all form field states
        document.getElementById('unspscCode').disabled = false;
        document.getElementById('categoryLevel1').disabled = false;
        document.getElementById('categoryLevel2').disabled = false;
        document.getElementById('categoryLevel3').disabled = false;
        document.getElementById('unspscDescription').disabled = false;
        document.getElementById('part23Category').disabled = false;
        document.getElementById('part3Comment').disabled = false;
        
        // Reset button states
        document.getElementById('saveRuleBtn').style.display = 'inline-flex';
        document.getElementById('viewModeNotice').style.display = 'none';
        document.getElementById('addRangeInModalBtn').style.display = 'inline-flex';
        document.getElementById('modalIcon').className = 'pi pi-plus-circle';
      }

      function clearForm() {
        document.getElementById('unspscCode').value = '';
        document.getElementById('categoryLevel1').value = '';
        document.getElementById('categoryLevel2').value = '';
        document.getElementById('categoryLevel3').value = '';
        document.getElementById('unspscDescription').value = '';
        document.getElementById('part23Category').value = 'none';
        document.getElementById('part3Comment').value = '';
        document.getElementById('validRangesList').innerHTML = `
          <div class="empty-ranges" id="emptyRangesMessage">
            <i class="pi pi-calendar-times" style="font-size: 24px; margin-bottom: 8px; display: block;"></i>
            No date restrictions defined. This rule will apply at all times.<br>
            <span style="font-size: 12px; color: var(--text-muted);">Click "Add Range" to define specific validity periods.</span>
          </div>
        `;
      }

      function saveRule() {
        // Validation would go here
        alert('Rule saved successfully!');
        closeModal();
      }

      // Valid Ranges
      let rangeCounter = 0;

      function addValidRange() {
        const list = document.getElementById('validRangesList');
        const emptyMsg = document.getElementById('emptyRangesMessage');
        if (emptyMsg) emptyMsg.remove();

        rangeCounter++;
        const rangeHtml = `
          <div class="valid-range-row" id="range-${rangeCounter}">
            <div class="form-group">
              <label class="form-label">Valid From</label>
              <input type="date" class="form-control" />
            </div>
            <div class="form-group">
              <label class="form-label">Valid To</label>
              <input type="date" class="form-control" />
            </div>
            <button class="remove-range-btn" onclick="removeValidRange(${rangeCounter})" title="Remove range">
              <i class="pi pi-trash"></i>
            </button>
          </div>
        `;
        list.insertAdjacentHTML('beforeend', rangeHtml);
      }

      function removeValidRange(id) {
        const range = document.getElementById('range-' + id);
        if (range) range.remove();

        const list = document.getElementById('validRangesList');
        if (list.children.length === 0) {
          list.innerHTML = `
            <div class="empty-ranges" id="emptyRangesMessage">
              <i class="pi pi-calendar-times" style="font-size: 24px; margin-bottom: 8px; display: block;"></i>
              No date restrictions defined. This rule will apply at all times.<br>
              <span style="font-size: 12px; color: var(--text-muted);">Click "Add Range" to define specific validity periods.</span>
            </div>
          `;
        }
      }

      // Quick Range Modal (for inline adding)
      let currentRangeUnspsc = '';

      function openAddRangeModal(unspscCode) {
        currentRangeUnspsc = unspscCode;
        document.getElementById('rangeUnspscCode').textContent = unspscCode;
        document.getElementById('rangeValidFrom').value = '';
        document.getElementById('rangeValidTo').value = '';
        document.getElementById('rangeModal').classList.add('active');
      }

      function closeRangeModal() {
        document.getElementById('rangeModal').classList.remove('active');
      }

      function saveRange() {
        const from = document.getElementById('rangeValidFrom').value;
        const to = document.getElementById('rangeValidTo').value;
        
        if (!from || !to) {
          alert('Please fill in both dates');
          return;
        }

        alert(`Range added for ${currentRangeUnspsc}: ${from} to ${to}`);
        closeRangeModal();
        // In real implementation, update the table row
      }

      // Filter chips
      document.querySelectorAll('.filter-chip').forEach(chip => {
        chip.addEventListener('click', function() {
          document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
          this.classList.add('active');
        });
      });

      // Close modals on outside click
      document.querySelectorAll('.modal-overlay').forEach(overlay => {
        overlay.addEventListener('click', function(e) {
          if (e.target === this) {
            this.classList.remove('active');
          }
        });
      });
    </script>
  </body>
</html>

