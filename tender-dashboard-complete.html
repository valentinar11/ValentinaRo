<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNOPS Procurement - Tender Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/primeicons@6.0.1/primeicons.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* UNOPS Preset Primary Colors */
            --primary-50: #e6f7ff;
            --primary-100: #bae7ff;
            --primary-200: #7dd3fc;
            --primary-300: #38bdf8;
            --primary-400: #0ea5e9;
            --primary-500: #0092D1;
            --primary-600: #0284c7;
            --primary-700: #0369a1;
            --surface-0: #ffffff;
            --surface-50: #f5f8fb;
            --surface-100: #ebf1f8;
            --surface-200: #dde8f2;
            --surface-300: #cfdfec;
            --surface-600: #95a7ba;
            --surface-800: #596170;
            --surface-900: #3b3e4a;
            --success-500: #4c9f38;
            --success-50: #d2e7cd;
            --info-400: #0092d1;
            --info-50: #bfe4f4;
            --warning-500: #e85c0e;
            --warning-50: #f9d6c3;
            --danger-500: #da291c;
            --danger-50: #f6cac6;
            --text-primary: var(--surface-900);
            --text-secondary: var(--surface-800);
            --text-muted: var(--surface-600);
            --spacing-xs: 6px;
            --spacing-sm: 12px;
            --spacing-md: 20px;
            --spacing-lg: 28px;
            --spacing-xl: 36px;
            --spacing-2xl: 48px;
            --radius-sm: 4px;
            --radius-md: 6px;
            --radius-lg: 8px;
            --shadow-card: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.06);
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Lato', 'Noto Sans', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--surface-50);
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: var(--surface-0);
            border-bottom: 1px solid var(--surface-200);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-md) var(--spacing-xl);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .logo {
            font-weight: 700;
            font-size: 20px;
            letter-spacing: 0.12em;
            color: var(--primary-400);
        }

        .portal-badge {
            background: var(--primary-400);
            color: white;
            font-size: 12px;
            font-weight: 600;
            padding: 4px 12px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .user-info {
            text-align: right;
        }

        .user-company {
            font-size: 12px;
            color: var(--text-muted);
        }

        .user-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--primary-100);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--primary-600);
            cursor: pointer;
        }

        /* Layout */
        .app-container {
            display: flex;
            min-height: calc(100vh - 65px);
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background-color: #0192D1;
            color: white;
            display: flex;
            flex-direction: column;
            border-right: none;
            transition: width 0.3s ease;
            position: relative;
        }

        .sidebar.collapsed {
            width: 60px;
        }

        .sidebar-toggle {
            position: absolute;
            top: 10px;
            right: -15px;
            width: 30px;
            height: 30px;
            background: var(--primary-400);
            border: 2px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            color: white;
            font-size: 14px;
            transition: transform 0.3s ease;
        }

        .sidebar.collapsed .sidebar-toggle {
            transform: rotate(180deg);
        }

        .sidebar.collapsed .menu-section-title,
        .sidebar.collapsed .menu-item span:not(.menu-icon) {
            display: none;
        }

        .sidebar-menu {
            flex: 1;
            padding: 20px 0;
        }

        .menu-section {
            margin-bottom: var(--spacing-lg);
        }

        .menu-section-title {
            padding: 0 20px 15px 20px;
            font-size: 20px;
            font-weight: bold;
            text-transform: none;
            letter-spacing: 0;
            color: white;
            font-family: 'Lato', sans-serif;
            margin-bottom: var(--spacing-sm);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: white;
            text-decoration: none;
            font-size: 16px;
            font-weight: normal;
            font-family: 'Lato', sans-serif;
            transition: background-color 0.2s ease;
            border-left: none;
            cursor: pointer;
            margin: 0 10px;
            border-radius: 5px;
        }

        .menu-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .menu-item.active {
            background-color: #006599;
            color: white;
        }

        .menu-icon {
            font-size: 18px;
            width: 20px;
            text-align: center;
            flex-shrink: 0;
        }

        .menu-badge {
            margin-left: auto;
            padding: 2px 8px;
            background: var(--danger-500);
            color: white;
            font-size: 11px;
            font-weight: 600;
            border-radius: 999px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: var(--spacing-xl);
            overflow-y: auto;
        }

        .page-header {
            margin-bottom: var(--spacing-xl);
        }

        .page-title {
            font-size: 28px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .page-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .stat-card {
            background: var(--surface-0);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            box-shadow: var(--shadow-card);
            border: 1px solid var(--surface-200);
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary-400);
            margin-bottom: var(--spacing-xs);
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .stat-icon {
            font-size: 24px;
            margin-bottom: var(--spacing-sm);
        }

        /* Filter Bar */
        .filter-bar {
            background: white;
            padding: 20px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--surface-200);
            margin-bottom: 24px;
            display: flex;
            gap: 16px;
            align-items: center;
            flex-wrap: wrap;
            box-shadow: var(--shadow-card);
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-label {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-muted);
        }

        .filter-select {
            padding: 8px 12px;
            border: 1px solid var(--surface-200);
            border-radius: var(--radius-sm);
            font-size: 13px;
            background: white;
            cursor: pointer;
            min-width: 150px;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary-400);
        }

        /* Tender Cards */
        .tender-grid {
            display: grid;
            gap: 20px;
        }

        .tender-card {
            background: white;
            border-radius: var(--radius-lg);
            border: 1px solid var(--surface-200);
            padding: 24px;
            transition: all 0.2s;
            cursor: pointer;
            box-shadow: var(--shadow-card);
        }

        .tender-card:hover {
            box-shadow: var(--shadow-md);
            border-color: var(--primary-400);
        }

        .tender-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 16px;
        }

        .tender-title-section {
            flex: 1;
        }

        .tender-id {
            font-size: 12px;
            color: var(--text-muted);
            font-weight: 500;
            margin-bottom: 4px;
        }

        .tender-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.active {
            background: var(--info-50);
            color: var(--info-400);
        }

        .status-badge.draft {
            background: var(--surface-200);
            color: var(--text-secondary);
        }

        .status-badge.review {
            background: var(--warning-50);
            color: var(--warning-500);
        }

        .status-badge.closed {
            background: var(--success-50);
            color: var(--success-500);
        }

        .tender-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--surface-200);
        }

        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .meta-label {
            font-size: 12px;
            color: var(--text-muted);
            font-weight: 500;
        }

        .meta-value {
            font-size: 14px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .tender-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        /* Buttons */
        .btn {
            border-radius: var(--radius-sm);
            border: 1px solid transparent;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary-400);
            color: #fff;
            border-color: var(--primary-400);
        }

        .btn-primary:hover {
            background: var(--primary-500);
            border-color: var(--primary-500);
        }

        .btn-secondary {
            background: transparent;
            border-color: var(--primary-400);
            color: var(--primary-400);
        }

        .btn-secondary:hover {
            background: var(--primary-50);
        }

        .btn-ghost {
            background: transparent;
            border-color: var(--surface-200);
            color: var(--text-secondary);
        }

        .btn-ghost:hover {
            background: var(--surface-100);
            border-color: var(--surface-300);
        }

        .btn-danger {
            background: var(--danger-500);
            color: white;
        }

        .btn-danger:hover {
            background: #b91c1c;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 13px;
        }

        /* Sidebar Panel */
        .sidebar-panel {
            position: fixed;
            right: 0;
            top: 0;
            width: 600px;
            height: 100vh;
            background: var(--surface-0);
            box-shadow: -2px 0 8px rgba(0, 0, 0, 0.1);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 110;
            overflow-y: auto;
        }

        .sidebar-panel.open {
            transform: translateX(0);
        }

        .sidebar-panel-header {
            padding: var(--spacing-lg);
            background: var(--primary-600);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .sidebar-panel-title {
            font-size: 18px;
            font-weight: 600;
        }

        .sidebar-panel-body {
            padding: var(--spacing-xl);
        }

        .collapsible-section-compact {
            border-bottom: 1px solid var(--surface-200);
            margin-bottom: var(--spacing-sm);
        }

        .collapsible-header-compact {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md);
            cursor: pointer;
            transition: background 0.2s;
            font-size: 14px;
        }

        .collapsible-header-compact:hover {
            background: var(--surface-50);
        }

        .collapsible-content-compact {
            padding: 0 var(--spacing-md) var(--spacing-md);
            display: none;
        }

        .collapsible-icon {
            transition: transform 0.3s;
            font-size: 12px;
        }

        .collapsible-icon.rotated {
            transform: rotate(-90deg);
        }

        .info-row {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: var(--spacing-md);
            padding: var(--spacing-sm) 0;
            border-bottom: 1px solid var(--surface-100);
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 13px;
        }

        .info-value {
            color: var(--text-primary);
            font-size: 14px;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: 16px;
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 25px rgba(0, 0, 0, 0.15);
        }

        .modal-header {
            padding: 24px;
            border-bottom: 1px solid var(--surface-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-muted);
            padding: 4px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }

        .modal-close:hover {
            background: var(--surface-100);
            color: var(--text-primary);
        }

        .modal-body {
            padding: 24px;
            overflow-y: auto;
            flex: 1;
        }

        .modal-footer {
            padding: 20px 24px;
            border-top: 1px solid var(--surface-200);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* Progress Steps */
        .progress-steps {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            margin-bottom: 32px;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--surface-300);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
        }

        .step-number.active {
            background: var(--primary-400);
        }

        .step-number.completed {
            background: var(--success-500);
        }

        .step-label {
            font-size: 14px;
            color: var(--text-muted);
        }

        .step-label.active {
            color: var(--text-primary);
            font-weight: 600;
        }

        .step-connector {
            width: 40px;
            height: 2px;
            background: var(--surface-300);
        }

        /* Amendment Steps */
        .amendment-step {
            display: none;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .form-label.required::after {
            content: ' *';
            color: var(--danger-500);
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--surface-200);
            border-radius: var(--radius-sm);
            font-size: 14px;
            font-family: inherit;
            transition: all 0.2s;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-400);
            box-shadow: 0 0 0 3px var(--primary-50);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .help-text {
            display: block;
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        /* Alert */
        .alert {
            padding: 16px;
            border-radius: var(--radius-sm);
            margin-bottom: 20px;
            display: flex;
            gap: 12px;
            align-items: start;
        }

        .alert-info {
            background: var(--info-50);
            border-left: 4px solid var(--info-400);
            color: var(--text-secondary);
        }

        .alert-warning {
            background: var(--warning-50);
            border-left: 4px solid var(--warning-500);
            color: #92400e;
        }

        .alert-danger {
            background: var(--danger-50);
            border-left: 4px solid var(--danger-500);
            color: #991b1b;
        }

        .alert-success {
            background: var(--success-50);
            border-left: 4px solid var(--success-500);
            color: #166534;
        }

        /* Category Grid */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .category-option {
            position: relative;
        }

        .category-checkbox {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

        .category-label {
            display: flex;
            flex-direction: column;
            padding: 12px;
            border: 2px solid var(--surface-200);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .category-checkbox:checked + .category-label {
            border-color: var(--primary-400);
            background: var(--primary-50);
        }

        .category-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tier-badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .tier-badge.tier-1 {
            background: var(--success-50);
            color: #15803d;
        }

        .tier-badge.tier-2 {
            background: var(--warning-50);
            color: #92400e;
        }

        .category-description {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Workflow Preview */
        .workflow-preview {
            background: var(--surface-50);
            border: 1px solid var(--surface-200);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 20px;
        }

        .workflow-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .workflow-steps {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .workflow-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .workflow-step-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-400);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .workflow-step-label {
            font-size: 11px;
            color: var(--text-muted);
            text-align: center;
            max-width: 100px;
        }

        .workflow-arrow {
            font-size: 20px;
            color: var(--text-muted);
        }

        /* Deadline Review */
        .deadline-review {
            background: var(--warning-50);
            border: 2px solid var(--warning-500);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 20px;
        }

        .deadline-review-title {
            font-size: 16px;
            font-weight: 600;
            color: #92400e;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .deadline-fields {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .info-box {
            padding: var(--spacing-md);
            background: var(--info-50);
            border-left: 4px solid var(--info-400);
            border-radius: var(--radius-sm);
            margin-bottom: var(--spacing-lg);
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Tender Details View */
        .view-section {
            display: none;
        }

        .view-section.active {
            display: block;
        }

        .tender-info-banner {
            background: linear-gradient(135deg, var(--primary-600) 0%, var(--primary-400) 100%);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            color: white;
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--shadow-card);
        }

        .tender-banner-ref {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: var(--spacing-sm);
        }

        .tender-banner-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: var(--spacing-md);
        }

        .tender-banner-meta {
            display: flex;
            gap: var(--spacing-xl);
            flex-wrap: wrap;
        }

        .banner-meta-item {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .banner-meta-label {
            font-size: 12px;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .banner-meta-value {
            font-size: 16px;
            font-weight: 600;
        }

        .overview-section {
            background: var(--surface-0);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-card);
            border: 1px solid var(--surface-200);
            margin-bottom: var(--spacing-lg);
        }

        .overview-section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-md);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .overview-section-icon {
            font-size: 24px;
        }

        .collapsible-item-card {
            background: var(--surface-50);
            border: 1px solid var(--surface-200);
            border-radius: var(--radius-md);
            margin-bottom: var(--spacing-md);
            overflow: hidden;
            transition: all 0.3s;
        }

        .collapsible-item-card:hover {
            box-shadow: var(--shadow-sm);
        }

        .collapsible-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-lg);
            cursor: pointer;
            background: var(--surface-50);
            transition: all 0.2s;
            user-select: none;
        }

        .collapsible-item-header:hover {
            background: var(--surface-100);
            transform: translateX(2px);
        }

        .collapsible-arrow {
            font-size: 14px;
            color: var(--primary-400);
            transition: transform 0.3s ease;
            margin-left: var(--spacing-md);
            font-weight: bold;
            display: inline-block;
        }

        .collapsible-arrow.rotated {
            transform: rotate(180deg);
            color: var(--primary-600);
        }

        .collapsible-item-content {
            max-height: 0;
            overflow: hidden;
            padding: 0 var(--spacing-lg);
            background: var(--surface-0);
            transition: max-height 0.4s ease, padding 0.4s ease;
        }

        .collapsible-item-content.expanded {
            max-height: 1000px;
            padding: 0 var(--spacing-lg) var(--spacing-lg);
        }

        .spec-detail-row {
            display: flex;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) 0;
            border-bottom: 1px solid var(--surface-100);
        }

        .spec-detail-row:last-child {
            border-bottom: none;
        }

        .spec-detail-label {
            font-weight: 600;
            color: var(--text-secondary);
            min-width: 140px;
            font-size: 13px;
        }

        .spec-detail-value {
            color: var(--text-primary);
            flex: 1;
            font-size: 13px;
            line-height: 1.5;
        }

        .deadline-warning {
            background: var(--warning-50);
            border-left: 4px solid var(--warning-500);
            border-radius: var(--radius-sm);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .deadline-icon {
            font-size: 24px;
        }

        .deadline-text {
            flex: 1;
        }

        .tender-overview-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: var(--spacing-xl);
            margin-bottom: var(--spacing-xl);
        }

        .overview-main {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .overview-sidebar-section {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .timeline {
            position: relative;
            padding-left: var(--spacing-xl);
        }

        .timeline-item {
            position: relative;
            padding-bottom: var(--spacing-lg);
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -24px;
            top: 8px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--primary-400);
            border: 3px solid var(--surface-0);
            box-shadow: 0 0 0 2px var(--primary-400);
        }

        .timeline-item::after {
            content: '';
            position: absolute;
            left: -19px;
            top: 20px;
            width: 2px;
            height: calc(100% - 8px);
            background: var(--surface-200);
        }

        .timeline-item:last-child::after {
            display: none;
        }

        .timeline-date {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
        }

        .timeline-content {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .tender-overview-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
            }
            .menu-section-title {
                display: none;
            }
            .menu-item span:not(.menu-icon) {
                display: none;
            }
            .sidebar:hover {
                width: 280px;
            }
            .sidebar:hover .menu-section-title,
            .sidebar:hover .menu-item span:not(.menu-icon) {
                display: block;
            }
            .sidebar-panel {
                width: 100%;
            }
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .category-grid {
                grid-template-columns: 1fr;
            }
            .tender-banner-meta {
                flex-direction: column;
                gap: var(--spacing-md);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-top">
            <div class="logo-container">
                <div class="logo">UNOPS</div>
                <span class="portal-badge">Procurement</span>
            </div>
            <div class="user-menu">
                <div class="user-info">
                    <div class="user-company">UNOPS Internal</div>
                    <div class="user-name">Jane Doe</div>
                </div>
                <div class="user-avatar">JD</div>
            </div>
        </div>
    </header>

    <!-- App Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="mainSidebar">
            <div class="sidebar-toggle" onclick="toggleSidebar()">
                <i class="pi pi-chevron-left"></i>
            </div>
            <nav class="sidebar-menu">
                <div class="menu-section">
                    <div class="menu-section-title">Main</div>
                    <a class="menu-item active" onclick="showDashboard()">
                        <span class="menu-icon">üìä</span>
                        <span>Dashboard</span>
                    </a>
                    <a class="menu-item">
                        <span class="menu-icon">üìã</span>
                        <span>My Tenders</span>
                        <span class="menu-badge">8</span>
                    </a>
                    <a class="menu-item">
                        <span class="menu-icon">üîç</span>
                        <span>Create Tender</span>
                    </a>
                </div>

                <div class="menu-section">
                    <div class="menu-section-title">Management</div>
                    <a class="menu-item">
                        <span class="menu-icon">üìÅ</span>
                        <span>Reports</span>
                    </a>
                    <a class="menu-item">
                        <span class="menu-icon">üìà</span>
                        <span>Analytics</span>
                    </a>
                    <a class="menu-item">
                        <span class="menu-icon">‚öôÔ∏è</span>
                        <span>Settings</span>
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard View -->
            <div class="view-section active" id="view-dashboard">
                <!-- Page Header -->
                <div class="page-header">
                    <h1 class="page-title">Tender Dashboard</h1>
                    <p class="page-subtitle">Manage and monitor all your procurement tenders</p>
                </div>

            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üìã</div>
                    <div class="stat-value">8</div>
                    <div class="stat-label">Active Tenders</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚úçÔ∏è</div>
                    <div class="stat-value">3</div>
                    <div class="stat-label">Draft Tenders</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚è∞</div>
                    <div class="stat-value">5</div>
                    <div class="stat-label">Under Review</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚úÖ</div>
                    <div class="stat-value">24</div>
                    <div class="stat-label">Closed</div>
                </div>
            </div>

            <!-- Filter Bar -->
            <div class="filter-bar">
                <div class="filter-group">
                    <span class="filter-label">Status:</span>
                    <select class="filter-select" onchange="filterTenders()">
                        <option value="all">All Statuses</option>
                        <option value="active">Active</option>
                        <option value="draft">Draft</option>
                        <option value="review">Under Review</option>
                        <option value="closed">Closed</option>
                    </select>
                </div>
                <div class="filter-group">
                    <span class="filter-label">Sort by:</span>
                    <select class="filter-select">
                        <option value="recent">Most Recent</option>
                        <option value="deadline">Deadline</option>
                        <option value="value">Value</option>
                    </select>
                </div>
                <div style="flex: 1;"></div>
                <button class="btn btn-primary">
                    <i class="pi pi-plus"></i>
                    Create New Tender
                </button>
            </div>

            <!-- Tender Grid -->
            <div class="tender-grid" id="tenderGrid">
                <!-- Tender Card 1 -->
                <div class="tender-card" data-status="active">
                    <div class="tender-header">
                        <div class="tender-title-section">
                            <div class="tender-id">RFQ/2024/001</div>
                            <div class="tender-title">Supply of Medical Equipment</div>
                        </div>
                        <span class="status-badge active">Active</span>
                    </div>
                    <div class="tender-meta">
                        <div class="meta-item">
                            <span class="meta-label">Posted Date</span>
                            <span class="meta-value">15 Nov 2024</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Deadline</span>
                            <span class="meta-value">15 Dec 2024</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Est. Value</span>
                            <span class="meta-value">$250,000</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Bids Received</span>
                            <span class="meta-value">3 / 12 interested</span>
                        </div>
                    </div>
                    <div class="tender-actions">
                        <button class="btn btn-primary btn-sm" onclick="currentTenderId='RFQ/2024/001'; currentTenderTitle='Supply of Medical Equipment'; showTenderDetails()">
                            <i class="pi pi-eye"></i> View Full Details
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="viewTenderPreview('RFQ/2024/001', 'Supply of Medical Equipment')">
                            <i class="pi pi-file-o"></i> Quick Preview
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="openAmendModal('RFQ/2024/001', 'Supply of Medical Equipment')">
                            <i class="pi pi-pencil"></i> Amend
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="openCancelModal('RFQ/2024/001', 'Supply of Medical Equipment')">
                            <i class="pi pi-times-circle"></i> Cancel
                        </button>
                    </div>
                </div>

                <!-- Tender Card 2 -->
                <div class="tender-card" data-status="active">
                    <div class="tender-header">
                        <div class="tender-title-section">
                            <div class="tender-id">ITB/2024/045</div>
                            <div class="tender-title">Construction of Office Building</div>
                        </div>
                        <span class="status-badge active">Active</span>
                    </div>
                    <div class="tender-meta">
                        <div class="meta-item">
                            <span class="meta-label">Posted Date</span>
                            <span class="meta-value">10 Nov 2024</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Deadline</span>
                            <span class="meta-value">10 Jan 2025</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Est. Value</span>
                            <span class="meta-value">$1,500,000</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Bids Received</span>
                            <span class="meta-value">7 / 25 interested</span>
                        </div>
                    </div>
                    <div class="tender-actions">
                        <button class="btn btn-primary btn-sm" onclick="currentTenderId='ITB/2024/045'; currentTenderTitle='Construction of Office Building'; showTenderDetails()">
                            <i class="pi pi-eye"></i> View Full Details
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="viewTenderPreview('ITB/2024/045', 'Construction of Office Building')">
                            <i class="pi pi-file-o"></i> Quick Preview
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="openAmendModal('ITB/2024/045', 'Construction of Office Building')">
                            <i class="pi pi-pencil"></i> Amend
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="openCancelModal('ITB/2024/045', 'Construction of Office Building')">
                            <i class="pi pi-times-circle"></i> Cancel
                        </button>
                    </div>
                </div>

                <!-- Tender Card 3 -->
                <div class="tender-card" data-status="review">
                    <div class="tender-header">
                        <div class="tender-title-section">
                            <div class="tender-id">RFP/2024/078</div>
                            <div class="tender-title">IT Infrastructure Services</div>
                        </div>
                        <span class="status-badge review">Under Review</span>
                    </div>
                    <div class="tender-meta">
                        <div class="meta-item">
                            <span class="meta-label">Submitted</span>
                            <span class="meta-value">28 Nov 2024</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Reviewer</span>
                            <span class="meta-value">PR Team</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Est. Value</span>
                            <span class="meta-value">$500,000</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Status</span>
                            <span class="meta-value">Pending Approval</span>
                        </div>
                    </div>
                    <div class="tender-actions">
                        <button class="btn btn-primary btn-sm" onclick="currentTenderId='RFP/2024/078'; currentTenderTitle='IT Infrastructure Services'; showTenderDetails()">
                            <i class="pi pi-eye"></i> View Full Details
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="viewTenderPreview('RFP/2024/078', 'IT Infrastructure Services')">
                            <i class="pi pi-file-o"></i> Quick Preview
                        </button>
                        <button class="btn btn-secondary btn-sm">
                            <i class="pi pi-pencil"></i> Edit Draft
                        </button>
                    </div>
                </div>

                <!-- Tender Card 4 -->
                <div class="tender-card" data-status="active">
                    <div class="tender-header">
                        <div class="tender-title-section">
                            <div class="tender-id">RFQ/2024/102</div>
                            <div class="tender-title">Vehicle Fleet Procurement</div>
                        </div>
                        <span class="status-badge active">Active</span>
                    </div>
                    <div class="tender-meta">
                        <div class="meta-item">
                            <span class="meta-label">Posted Date</span>
                            <span class="meta-value">20 Nov 2024</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Deadline</span>
                            <span class="meta-value">20 Dec 2024</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Est. Value</span>
                            <span class="meta-value">$850,000</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Bids Received</span>
                            <span class="meta-value">1 / 8 interested</span>
                        </div>
                    </div>
                    <div class="tender-actions">
                        <button class="btn btn-primary btn-sm" onclick="currentTenderId='RFQ/2024/102'; currentTenderTitle='Vehicle Fleet Procurement'; showTenderDetails()">
                            <i class="pi pi-eye"></i> View Full Details
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="viewTenderPreview('RFQ/2024/102', 'Vehicle Fleet Procurement')">
                            <i class="pi pi-file-o"></i> Quick Preview
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="openAmendModal('RFQ/2024/102', 'Vehicle Fleet Procurement')">
                            <i class="pi pi-pencil"></i> Amend
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="openCancelModal('RFQ/2024/102', 'Vehicle Fleet Procurement')">
                            <i class="pi pi-times-circle"></i> Cancel
                        </button>
                    </div>
                </div>

                <!-- Tender Card 5 -->
                <div class="tender-card" data-status="draft">
                    <div class="tender-header">
                        <div class="tender-title-section">
                            <div class="tender-id">DRAFT-2024-156</div>
                            <div class="tender-title">Consulting Services - HR Management</div>
                        </div>
                        <span class="status-badge draft">Draft</span>
                    </div>
                    <div class="tender-meta">
                        <div class="meta-item">
                            <span class="meta-label">Created</span>
                            <span class="meta-value">25 Nov 2024</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Last Modified</span>
                            <span class="meta-value">28 Nov 2024</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Est. Value</span>
                            <span class="meta-value">$120,000</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Completion</span>
                            <span class="meta-value">75%</span>
                        </div>
                    </div>
                    <div class="tender-actions">
                        <button class="btn btn-primary btn-sm">
                            <i class="pi pi-pencil"></i> Continue Editing
                        </button>
                        <button class="btn btn-secondary btn-sm">
                            <i class="pi pi-copy"></i> Duplicate
                        </button>
                        <button class="btn btn-secondary btn-sm">
                            <i class="pi pi-trash"></i> Delete
                        </button>
                    </div>
                </div>
            </div>
            </div>
            <!-- End Dashboard View -->

            <!-- Tender Details View -->
            <div class="view-section" id="view-tender-details">
                <!-- Tender Info Banner -->
                <div class="tender-info-banner">
                    <div class="tender-banner-ref" id="details-tender-id">Reference: RFQ/2024/001</div>
                    <h2 class="tender-banner-title" id="details-tender-title">Supply and Delivery of Medical Equipment and Supplies</h2>
                    <div class="tender-banner-meta">
                        <div class="banner-meta-item">
                            <span class="banner-meta-label">Type</span>
                            <span class="banner-meta-value">ITB</span>
                        </div>
                        <div class="banner-meta-item">
                            <span class="banner-meta-label">Category</span>
                            <span class="banner-meta-value">Goods</span>
                        </div>
                        <div class="banner-meta-item">
                            <span class="banner-meta-label">Value</span>
                            <span class="banner-meta-value">$250,000 USD</span>
                        </div>
                        <div class="banner-meta-item">
                            <span class="banner-meta-label">Deadline</span>
                            <span class="banner-meta-value">15 Jan 2025</span>
                        </div>
                        <div class="banner-meta-item">
                            <span class="banner-meta-label">Status</span>
                            <span class="banner-meta-value">Open</span>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div style="display: flex; gap: var(--spacing-md); margin-bottom: var(--spacing-xl); flex-wrap: wrap;">
                    <button class="btn btn-secondary" onclick="showDashboard()">
                        <i class="pi pi-arrow-left"></i> Back to Dashboard
                    </button>
                    <div style="flex: 1;"></div>
                    <button class="btn btn-primary" onclick="openAmendModalFromDetails()">
                        <i class="pi pi-pencil"></i> Amend Tender
                    </button>
                    <button class="btn btn-danger" onclick="openCancelModalFromDetails()">
                        <i class="pi pi-times-circle"></i> Cancel Tender
                    </button>
                    <button class="btn btn-secondary">
                        <i class="pi pi-comment"></i> Manage Clarifications
                    </button>
                </div>

                <div class="deadline-warning">
                    <div class="deadline-icon">‚è∞</div>
                    <div class="deadline-text">
                        <strong>5 days, 14 hours remaining</strong> until bid submission deadline.
                    </div>
                </div>

                <div class="tender-overview-grid">
                    <div class="overview-main">
                        <!-- General Information -->
                        <div class="overview-section">
                            <h3 class="overview-section-title">
                                <span class="overview-section-icon">üìã</span>
                                General Information
                            </h3>
                            <div class="info-row">
                                <div class="info-label">Method</div>
                                <div class="info-value">ITB - Invitation to Bid</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Category</div>
                                <div class="info-value">Goods</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Countries</div>
                                <div class="info-value">Afghanistan, Bangladesh, Ethiopia</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Bid Validity</div>
                                <div class="info-value">90 days</div>
                            </div>
                        </div>

                        <!-- Scope & Objectives -->
                        <div class="overview-section">
                            <h3 class="overview-section-title">
                                <span class="overview-section-icon">üéØ</span>
                                Scope & Objectives
                            </h3>
                            <p style="line-height: 1.6; color: var(--text-secondary);">
                                UNOPS requires the supply and delivery of medical equipment for healthcare facilities. Equipment must meet international standards and include installation and training services.
                            </p>
                        </div>

                        <!-- Items & Specifications -->
                        <div class="overview-section">
                            <h3 class="overview-section-title">
                                <span class="overview-section-icon">üì¶</span>
                                Items & Specifications
                            </h3>
                            <p style="line-height: 1.6; color: var(--text-muted); margin-bottom: var(--spacing-md); font-size: 14px;">
                                The following items are being procured. Click on each item to view detailed specifications.
                            </p>

                            <!-- Item 1: Ultrasound Machines -->
                            <div class="collapsible-item-card">
                                <div class="collapsible-item-header" onclick="toggleItemCard(this, event)">
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600; font-size: 15px; margin-bottom: 4px;">Ultrasound Machines</div>
                                        <div style="font-size: 12px; color: var(--text-muted);">UNSPSC: 42182104 ‚Ä¢ Quantity: 5 Units</div>
                                    </div>
                                    <span class="collapsible-arrow">‚ñº</span>
                                </div>
                                <div class="collapsible-item-content">
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Type:</span>
                                        <span class="spec-detail-value">Portable Ultrasound System</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Display:</span>
                                        <span class="spec-detail-value">Color Doppler with minimum 15" LED monitor</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Probes:</span>
                                        <span class="spec-detail-value">Minimum 3 probes (Convex, Linear, Phased Array)</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Features:</span>
                                        <span class="spec-detail-value">3D/4D imaging capability, DICOM compatible, battery backup</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Warranty:</span>
                                        <span class="spec-detail-value">Minimum 2 years parts and labor</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Delivery:</span>
                                        <span class="spec-detail-value">Within 90 days of contract signing</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Item 2: Patient Monitors -->
                            <div class="collapsible-item-card">
                                <div class="collapsible-item-header" onclick="toggleItemCard(this, event)">
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600; font-size: 15px; margin-bottom: 4px;">Patient Monitors</div>
                                        <div style="font-size: 12px; color: var(--text-muted);">UNSPSC: 42182108 ‚Ä¢ Quantity: 20 Units</div>
                                    </div>
                                    <span class="collapsible-arrow">‚ñº</span>
                                </div>
                                <div class="collapsible-item-content">
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Type:</span>
                                        <span class="spec-detail-value">Multi-Parameter Patient Monitor</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Display:</span>
                                        <span class="spec-detail-value">Minimum 12" TFT color LCD touchscreen</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Parameters:</span>
                                        <span class="spec-detail-value">ECG (3/5/12 lead), SpO2, NIBP, Temperature, Respiration Rate, IBP (optional)</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Battery:</span>
                                        <span class="spec-detail-value">Built-in rechargeable, minimum 4 hours runtime</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Alarms:</span>
                                        <span class="spec-detail-value">Visual and audible with adjustable limits</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Warranty:</span>
                                        <span class="spec-detail-value">Minimum 2 years parts and labor</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Delivery:</span>
                                        <span class="spec-detail-value">Within 60 days of contract signing</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Item 3: Surgical Lights -->
                            <div class="collapsible-item-card">
                                <div class="collapsible-item-header" onclick="toggleItemCard(this, event)">
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600; font-size: 15px; margin-bottom: 4px;">Surgical Lights</div>
                                        <div style="font-size: 12px; color: var(--text-muted);">UNSPSC: 42192201 ‚Ä¢ Quantity: 8 Units</div>
                                    </div>
                                    <span class="collapsible-arrow">‚ñº</span>
                                </div>
                                <div class="collapsible-item-content">
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Type:</span>
                                        <span class="spec-detail-value">LED Surgical Operating Light, Mobile</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Illumination:</span>
                                        <span class="spec-detail-value">Minimum 120,000 lux at 1m distance</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Color Temperature:</span>
                                        <span class="spec-detail-value">4000-5000K, adjustable</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">LED Lifespan:</span>
                                        <span class="spec-detail-value">Minimum 50,000 hours</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Mobility:</span>
                                        <span class="spec-detail-value">Floor mounted with wheels, brake system, 360¬∞ rotation</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Warranty:</span>
                                        <span class="spec-detail-value">Minimum 3 years parts and labor</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Delivery:</span>
                                        <span class="spec-detail-value">Within 75 days of contract signing</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Item 4: Anesthesia Machines -->
                            <div class="collapsible-item-card">
                                <div class="collapsible-item-header" onclick="toggleItemCard(this, event)">
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600; font-size: 15px; margin-bottom: 4px;">Anesthesia Machines</div>
                                        <div style="font-size: 12px; color: var(--text-muted);">UNSPSC: 42182101 ‚Ä¢ Quantity: 3 Units</div>
                                    </div>
                                    <span class="collapsible-arrow">‚ñº</span>
                                </div>
                                <div class="collapsible-item-content">
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Type:</span>
                                        <span class="spec-detail-value">Advanced Anesthesia Workstation</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Ventilator:</span>
                                        <span class="spec-detail-value">Integrated with volume and pressure control modes</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Vaporizers:</span>
                                        <span class="spec-detail-value">Minimum 2 agent-specific vaporizers (Sevoflurane, Isoflurane)</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Monitoring:</span>
                                        <span class="spec-detail-value">Integrated patient monitoring (O2, CO2, agent concentration, pressure, flow)</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Display:</span>
                                        <span class="spec-detail-value">15" color touchscreen with waveform display</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Standards:</span>
                                        <span class="spec-detail-value">ISO 80601-2-13 compliant</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Warranty:</span>
                                        <span class="spec-detail-value">Minimum 2 years parts and labor</span>
                                    </div>
                                    <div class="spec-detail-row">
                                        <span class="spec-detail-label">Delivery:</span>
                                        <span class="spec-detail-value">Within 120 days of contract signing</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tender Particulars -->
                        <div class="overview-section">
                            <h3 class="overview-section-title">
                                <span class="overview-section-icon">‚öôÔ∏è</span>
                                Tender Particulars
                            </h3>
                            <div class="info-row">
                                <div class="info-label">Bid Security</div>
                                <div class="info-value">Required - $5,000 USD</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Performance Security</div>
                                <div class="info-value">10% of contract value</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Advance Payment</div>
                                <div class="info-value">Allowed - Up to 20%</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Advance Payment Security</div>
                                <div class="info-value">Required - Bank guarantee for full amount</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Liquidated Damages</div>
                                <div class="info-value">0.5% per week of delay, maximum 10%</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Alternative Offers</div>
                                <div class="info-value">Allowed</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Site Visit</div>
                                <div class="info-value">Not required</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Pre-Bid Meeting</div>
                                <div class="info-value">Optional - 20 December 2024, 10:00 AM UTC (Virtual)</div>
                            </div>
                        </div>

                        <!-- Evaluation Criteria -->
                        <div class="overview-section">
                            <h3 class="overview-section-title">
                                <span class="overview-section-icon">üìä</span>
                                Evaluation Criteria
                            </h3>
                            <div class="info-box">
                                <strong>Method:</strong> Lowest Evaluated Substantially Responsive Bid
                            </div>
                            <p style="margin-top: var(--spacing-md); line-height: 1.6; color: var(--text-secondary);">
                                Technical evaluation (pass/fail) followed by financial comparison of compliant bids.
                            </p>
                        </div>
                    </div>

                    <!-- Sidebar -->
                    <div class="overview-sidebar-section">
                        <!-- Key Dates -->
                        <div class="overview-section">
                            <h3 class="overview-section-title">
                                <span class="overview-section-icon">üìÖ</span>
                                Key Dates
                            </h3>
                            <div class="timeline">
                                <div class="timeline-item">
                                    <div class="timeline-date">5 Dec 2024</div>
                                    <div class="timeline-content">Published</div>
                                </div>
                                <div class="timeline-item">
                                    <div class="timeline-date">10 Jan 2025</div>
                                    <div class="timeline-content">Clarification Deadline</div>
                                </div>
                                <div class="timeline-item">
                                    <div class="timeline-date">15 Jan 2025</div>
                                    <div class="timeline-content">Submission Deadline</div>
                                </div>
                            </div>
                        </div>

                        <!-- Statistics -->
                        <div class="overview-section">
                            <h3 class="overview-section-title">
                                <span class="overview-section-icon">üìà</span>
                                Tender Statistics
                            </h3>
                            <div class="info-row">
                                <div class="info-label">Suppliers Interested</div>
                                <div class="info-value">12</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Bids Submitted</div>
                                <div class="info-value">3</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Clarifications</div>
                                <div class="info-value">5 questions</div>
                            </div>
                            <div class="info-row">
                                <div class="info-label">Documents</div>
                                <div class="info-value">8 files</div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="overview-section">
                            <h3 class="overview-section-title">
                                <span class="overview-section-icon">‚ö°</span>
                                Quick Actions
                            </h3>
                            <button class="btn btn-secondary" style="width: 100%; margin-bottom: var(--spacing-sm);">
                                <i class="pi pi-download"></i> Download Package
                            </button>
                            <button class="btn btn-secondary" style="width: 100%; margin-bottom: var(--spacing-sm);">
                                <i class="pi pi-users"></i> View Participants
                            </button>
                            <button class="btn btn-secondary" style="width: 100%;">
                                <i class="pi pi-history"></i> View History
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Tender Details View -->
        </main>
    </div>

    <!-- Tender Preview Sidebar -->
    <div class="sidebar-panel" id="tender-preview-sidebar">
        <div class="sidebar-panel-header">
            <div>
                <div class="sidebar-panel-title">Tender Details</div>
                <div style="font-size: 13px; opacity: 0.9;" id="preview-tender-id">RFQ/2024/001</div>
            </div>
            <button class="modal-close" style="color: white;" onclick="closeTenderPreview()">√ó</button>
        </div>
        <div class="sidebar-panel-body">
            <!-- Title -->
            <h3 style="font-size: 18px; font-weight: 600; margin-bottom: var(--spacing-lg); color: var(--text-primary);" id="preview-tender-title">
                Supply of Medical Equipment
            </h3>

            <!-- Quick Actions -->
            <div style="display: flex; gap: var(--spacing-sm); margin-bottom: var(--spacing-xl);">
                <button class="btn btn-primary btn-sm" style="flex: 1;" onclick="closeTenderPreview(); openAmendModalFromPreview()">
                    <i class="pi pi-pencil"></i> Amend
                </button>
                <button class="btn btn-danger btn-sm" style="flex: 1;" onclick="closeTenderPreview(); openCancelModalFromPreview()">
                    <i class="pi pi-times-circle"></i> Cancel
                </button>
            </div>

            <!-- General Information -->
            <div class="collapsible-section-compact">
                <div class="collapsible-header-compact" onclick="toggleCollapseSidebar(this)">
                    <span><strong>üìã General Information</strong></span>
                    <span class="collapsible-icon">‚ñº</span>
                </div>
                <div class="collapsible-content-compact" style="display: block;">
                    <div class="info-row">
                        <div class="info-label">Method</div>
                        <div class="info-value">ITB - Invitation to Bid</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Category</div>
                        <div class="info-value">Goods</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Value</div>
                        <div class="info-value">$250,000 USD</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Deadline</div>
                        <div class="info-value">15 Jan 2025, 23:59 UTC</div>
                    </div>
                </div>
            </div>

            <!-- Scope -->
            <div class="collapsible-section-compact">
                <div class="collapsible-header-compact" onclick="toggleCollapseSidebar(this)">
                    <span><strong>üìù Scope & Description</strong></span>
                    <span class="collapsible-icon">‚ñº</span>
                </div>
                <div class="collapsible-content-compact" style="display: block;">
                    <p style="font-size: 13px; line-height: 1.6; color: var(--text-secondary);">
                        Supply and delivery of medical equipment and supplies for healthcare facilities in multiple locations. Equipment must meet international standards and include installation and training services.
                    </p>
                </div>
            </div>

            <!-- Key Dates -->
            <div class="collapsible-section-compact">
                <div class="collapsible-header-compact" onclick="toggleCollapseSidebar(this)">
                    <span><strong>üìÖ Key Dates</strong></span>
                    <span class="collapsible-icon">‚ñº</span>
                </div>
                <div class="collapsible-content-compact">
                    <div class="info-row">
                        <div class="info-label">Published</div>
                        <div class="info-value">5 Dec 2024</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Clarification Deadline</div>
                        <div class="info-value">10 Jan 2025</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Submission Deadline</div>
                        <div class="info-value">15 Jan 2025, 23:59 UTC</div>
                    </div>
                </div>
            </div>

            <!-- Particulars -->
            <div class="collapsible-section-compact">
                <div class="collapsible-header-compact" onclick="toggleCollapseSidebar(this)">
                    <span><strong>‚öôÔ∏è Tender Particulars</strong></span>
                    <span class="collapsible-icon">‚ñº</span>
                </div>
                <div class="collapsible-content-compact">
                    <div class="info-row">
                        <div class="info-label">Bid Security</div>
                        <div class="info-value">Required - $5,000</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Performance Security</div>
                        <div class="info-value">10% of contract value</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Alternative Offers</div>
                        <div class="info-value">Allowed</div>
                    </div>
                </div>
            </div>

            <button class="btn btn-primary" style="width: 100%; margin-top: var(--spacing-lg);" onclick="closeTenderPreview(); showTenderDetails()">
                <i class="pi pi-external-link"></i> View Full Tender Details
            </button>
        </div>
    </div>

    <!-- Amendment Modal -->
    <div class="modal-overlay" id="amendModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="pi pi-pencil"></i>
                    <span>Amend Tender: <span id="amendTenderTitle"></span></span>
                </h2>
                <button class="modal-close" onclick="closeAmendModal()">√ó</button>
            </div>

            <div class="modal-body">
                <!-- Progress Steps -->
                <div class="progress-steps">
                    <div class="progress-step">
                        <span class="step-number active" id="step1-number">1</span>
                        <span class="step-label active" id="step1-label">Category</span>
                    </div>
                    <div class="step-connector"></div>
                    <div class="progress-step">
                        <span class="step-number" id="step2-number">2</span>
                        <span class="step-label" id="step2-label">Details</span>
                    </div>
                    <div class="step-connector"></div>
                    <div class="progress-step">
                        <span class="step-number" id="step3-number">3</span>
                        <span class="step-label" id="step3-label">Review</span>
                    </div>
                </div>

                <!-- Step 1: Category Selection -->
                <div id="amendment-step-1" class="amendment-step" style="display: block;">
                    <div class="alert alert-info">
                        <i class="pi pi-info-circle" style="font-size: 20px;"></i>
                        <div>
                            <strong>Select Amendment Category</strong>
                            <p style="margin-top: 4px; font-size: 13px;">
                                Choose categories that describe your amendment. Multiple selections allowed - the highest tier determines the approval workflow.
                            </p>
                        </div>
                    </div>

                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 12px; color: #15803d;">
                        Tier 1 Amendments - Author Posts Directly
                    </h3>
                    <div class="category-grid">
                        <div class="category-option">
                            <input type="checkbox" id="cat-deadline-extension" class="category-checkbox" onchange="updateAmendmentWorkflow()">
                            <label for="cat-deadline-extension" class="category-label">
                                <span class="category-name">
                                    <span class="tier-badge tier-1">Tier 1</span>
                                    Deadline Extension
                                </span>
                                <span class="category-description">Extend submission deadline</span>
                            </label>
                        </div>

                        <div class="category-option">
                            <input type="checkbox" id="cat-clarification-extension" class="category-checkbox" onchange="updateAmendmentWorkflow()">
                            <label for="cat-clarification-extension" class="category-label">
                                <span class="category-name">
                                    <span class="tier-badge tier-1">Tier 1</span>
                                    Clarification Extension
                                </span>
                                <span class="category-description">Extend clarifications deadline</span>
                            </label>
                        </div>

                        <div class="category-option">
                            <input type="checkbox" id="cat-award-date" class="category-checkbox" onchange="updateAmendmentWorkflow()">
                            <label for="cat-award-date" class="category-label">
                                <span class="category-name">
                                    <span class="tier-badge tier-1">Tier 1</span>
                                    Expected Award Date
                                </span>
                                <span class="category-description">Update expected contract award date</span>
                            </label>
                        </div>
                    </div>

                    <h3 style="font-size: 16px; font-weight: 600; margin: 24px 0 12px 0; color: #92400e;">
                        Tier 2 Amendments - Requires TME & PR Review
                    </h3>
                    <div class="category-grid">
                        <div class="category-option">
                            <input type="checkbox" id="cat-deadline-shortened" class="category-checkbox" onchange="updateAmendmentWorkflow()">
                            <label for="cat-deadline-shortened" class="category-label">
                                <span class="category-name">
                                    <span class="tier-badge tier-2">Tier 2</span>
                                    Deadline Shortened
                                </span>
                                <span class="category-description">Shorten submission deadline</span>
                            </label>
                        </div>

                        <div class="category-option">
                            <input type="checkbox" id="cat-prebid-minutes" class="category-checkbox" onchange="updateAmendmentWorkflow()">
                            <label for="cat-prebid-minutes" class="category-label">
                                <span class="category-name">
                                    <span class="tier-badge tier-2">Tier 2</span>
                                    Pre-bid Minutes
                                </span>
                                <span class="category-description">Upload pre-bid meeting documentation</span>
                            </label>
                        </div>

                        <div class="category-option">
                            <input type="checkbox" id="cat-document-revision" class="category-checkbox" onchange="updateAmendmentWorkflow()">
                            <label for="cat-document-revision" class="category-label">
                                <span class="category-name">
                                    <span class="tier-badge tier-2">Tier 2</span>
                                    Document Revision
                                </span>
                                <span class="category-description">Add or revise tender documents</span>
                            </label>
                        </div>

                        <div class="category-option">
                            <input type="checkbox" id="cat-scope-change" class="category-checkbox" onchange="updateAmendmentWorkflow()">
                            <label for="cat-scope-change" class="category-label">
                                <span class="category-name">
                                    <span class="tier-badge tier-2">Tier 2</span>
                                    Scope/Quantity Change
                                </span>
                                <span class="category-description">Modify tender scope or quantities</span>
                            </label>
                        </div>

                        <div class="category-option">
                            <input type="checkbox" id="cat-terms-conditions" class="category-checkbox" onchange="updateAmendmentWorkflow()">
                            <label for="cat-terms-conditions" class="category-label">
                                <span class="category-name">
                                    <span class="tier-badge tier-2">Tier 2</span>
                                    Terms & Criteria
                                </span>
                                <span class="category-description">Update terms or evaluation criteria</span>
                            </label>
                        </div>

                        <div class="category-option">
                            <input type="checkbox" id="cat-price-adjustment" class="category-checkbox" onchange="updateAmendmentWorkflow()">
                            <label for="cat-price-adjustment" class="category-label">
                                <span class="category-name">
                                    <span class="tier-badge tier-2">Tier 2</span>
                                    Price Adjustment
                                </span>
                                <span class="category-description">Modify pricing or financial terms</span>
                            </label>
                        </div>

                        <div class="category-option">
                            <input type="checkbox" id="cat-error-correction" class="category-checkbox" onchange="updateAmendmentWorkflow()">
                            <label for="cat-error-correction" class="category-label">
                                <span class="category-name">
                                    <span class="tier-badge tier-2">Tier 2</span>
                                    Error Correction
                                </span>
                                <span class="category-description">Correct errors in documentation</span>
                            </label>
                        </div>

                        <div class="category-option">
                            <input type="checkbox" id="cat-other" class="category-checkbox" onchange="updateAmendmentWorkflow()">
                            <label for="cat-other" class="category-label">
                                <span class="category-name">
                                    <span class="tier-badge tier-2">Tier 2</span>
                                    Other
                                </span>
                                <span class="category-description">Other amendments requiring review</span>
                            </label>
                        </div>
                    </div>

                    <!-- Workflow Preview -->
                    <div class="workflow-preview" id="workflow-preview" style="display: none;">
                        <div class="workflow-title">
                            <i class="pi pi-sitemap"></i> Amendment Workflow
                        </div>
                        <div id="workflow-display"></div>
                    </div>
                </div>

                <!-- Step 2: Amendment Details -->
                <div id="amendment-step-2" class="amendment-step">
                    <div class="alert alert-warning">
                        <i class="pi pi-exclamation-triangle" style="font-size: 20px;"></i>
                        <div>
                            <strong>Review & Confirm Deadlines</strong>
                            <p style="margin-top: 4px; font-size: 13px;">
                                System requires deadline review for all amendments. Update dates if changes warrant an extension.
                            </p>
                        </div>
                    </div>

                    <!-- Deadline Review -->
                    <div class="deadline-review">
                        <div class="deadline-review-title">
                            <i class="pi pi-calendar"></i> Review Tender Deadlines
                        </div>
                        <div class="deadline-fields">
                            <div class="form-group" style="margin-bottom: 0;">
                                <label class="form-label">Submission Deadline</label>
                                <input type="datetime-local" class="form-input" value="2024-12-15T23:59" id="submission-deadline">
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label class="form-label">Clarifications Deadline</label>
                                <input type="datetime-local" class="form-input" value="2024-12-08T23:59" id="clarification-deadline">
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label class="form-label">Expected Award Date</label>
                                <input type="date" class="form-input" value="2025-01-15" id="award-date">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label required">Amendment Description</label>
                        <textarea class="form-textarea" id="amendment-description" placeholder="Provide a clear description of the changes being made..."></textarea>
                        <span class="help-text">This will be published to all suppliers</span>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Justification/Instructions to Bidders</label>
                        <textarea class="form-textarea" id="amendment-justification" placeholder="Explain the rationale for this amendment..."></textarea>
                        <span class="help-text">Provide context for suppliers about why this amendment is being made</span>
                    </div>

                    <div class="alert alert-danger">
                        <i class="pi pi-exclamation-triangle" style="font-size: 20px;"></i>
                        <div>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 0;">
                                <input type="checkbox" id="impacts-mandatory" onchange="toggleMandatoryImpact()">
                                <strong>This amendment impacts mandatory requirements</strong>
                            </label>
                            <p style="margin-top: 8px; font-size: 13px;">
                                All existing bid submissions will be invalidated and suppliers must resubmit
                            </p>
                        </div>
                    </div>

                    <div id="mandatory-impact-notice" style="display: none;">
                        <div class="alert alert-warning">
                            <i class="pi pi-info-circle" style="font-size: 20px;"></i>
                            <div>
                                <strong>Bid Invalidation Notice</strong>
                                <p style="margin-top: 4px; font-size: 13px;">
                                    All submitted bids will be invalidated. Suppliers will receive high-priority notification requiring bid review and resubmission.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Review & Submit -->
                <div id="amendment-step-3" class="amendment-step">
                    <div class="alert alert-success">
                        <i class="pi pi-check-circle" style="font-size: 20px;"></i>
                        <div>
                            <strong>Review Amendment Details</strong>
                            <p style="margin-top: 4px; font-size: 13px;">
                                Review all details before submitting. Amendment will follow the workflow displayed below.
                            </p>
                        </div>
                    </div>

                    <!-- Summary -->
                    <div style="background: var(--surface-50); border: 1px solid var(--surface-200); border-radius: var(--radius-md); padding: 20px; margin-bottom: 20px;">
                        <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 16px;">Amendment Summary</h3>
                        
                        <div style="display: grid; gap: 16px;">
                            <div>
                                <strong style="font-size: 13px; color: var(--text-muted);">Categories Selected:</strong>
                                <div id="review-categories" style="margin-top: 8px;"></div>
                            </div>
                            
                            <div>
                                <strong style="font-size: 13px; color: var(--text-muted);">Workflow Tier:</strong>
                                <div id="review-tier" style="margin-top: 8px;"></div>
                            </div>

                            <div>
                                <strong style="font-size: 13px; color: var(--text-muted);">Description:</strong>
                                <div id="review-description" style="margin-top: 8px; font-size: 14px;"></div>
                            </div>

                            <div>
                                <strong style="font-size: 13px; color: var(--text-muted);">Mandatory Requirements Impact:</strong>
                                <div id="review-mandatory" style="margin-top: 8px;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Final Workflow -->
                    <div class="workflow-preview">
                        <div class="workflow-title">
                            <i class="pi pi-sitemap"></i> Amendment Approval Workflow
                        </div>
                        <div id="final-workflow-display"></div>
                    </div>

                    <div class="alert alert-info">
                        <i class="pi pi-megaphone" style="font-size: 20px;"></i>
                        <div>
                            <strong>Upon Approval & Publication:</strong>
                            <ul style="margin: 8px 0 0 20px; font-size: 13px;">
                                <li>Amendment published to Agora and UNGM</li>
                                <li>All interested suppliers receive high-priority notifications</li>
                                <li>Summary of changes generated automatically</li>
                                <li>All changes logged in audit trail</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="closeAmendModal()">Cancel</button>
                <button class="btn btn-secondary" id="amendment-back-btn" onclick="previousAmendmentStep()" style="display: none;">
                    <i class="pi pi-arrow-left"></i> Back
                </button>
                <button class="btn btn-primary" id="amendment-next-btn" onclick="nextAmendmentStep()">
                    Next <i class="pi pi-arrow-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Cancel Modal -->
    <div class="modal-overlay" id="cancelModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="pi pi-times-circle"></i>
                    <span>Cancel Tender: <span id="cancelTenderTitle"></span></span>
                </h2>
                <button class="modal-close" onclick="closeCancelModal()">√ó</button>
            </div>

            <div class="modal-body">
                <div class="alert alert-danger">
                    <i class="pi pi-exclamation-triangle" style="font-size: 20px;"></i>
                    <div>
                        <strong>Warning: This action cannot be undone</strong>
                        <p style="margin-top: 4px; font-size: 13px;">
                            All participating suppliers will be notified and requisition lines will be released in ERP.
                        </p>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label required">Cancellation Reason (Internal)</label>
                    <select class="form-select" id="cancel-reason">
                        <option value="">Select a reason...</option>
                        <option value="lack-funds">Lack of Funds</option>
                        <option value="budget-reallocation">Budget Reallocation</option>
                        <option value="non-viable-pricing">Non-viable Pricing</option>
                        <option value="priority-change">Change in Organization Priority</option>
                        <option value="scope-modification">Project Scope Modification</option>
                        <option value="project-cancellation">Project Cancellation</option>
                        <option value="requirements-revision">Material Revision of Requirements</option>
                        <option value="restrictive-specs">Restrictive Specifications</option>
                        <option value="lack-compliant">Lack of Compliant Bids</option>
                        <option value="insufficient-competition">Insufficient Competition</option>
                        <option value="proscribed-practices">Suspicion/Evidence of Proscribed Practices</option>
                        <option value="poor-quality">Poor Quality of Bids</option>
                        <option value="procedural-issues">Procedural Irregularities</option>
                        <option value="conflict-interest">Conflict of Interest</option>
                        <option value="legal-changes">Legal or Regulatory Changes</option>
                    </select>
                    <span class="help-text">For internal analysis and audit purposes</span>
                </div>

                <div class="form-group">
                    <label class="form-label required">Internal Explanation</label>
                    <textarea class="form-textarea" id="cancel-internal-explanation" placeholder="Detailed explanation for internal records..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label required">Public Justification</label>
                    <textarea class="form-textarea" id="cancel-public-justification" placeholder="Justification to be shared with suppliers..."></textarea>
                    <span class="help-text">This will be published to all participating suppliers</span>
                </div>

                <div class="alert alert-info">
                    <i class="pi pi-info-circle" style="font-size: 20px;"></i>
                    <div>
                        <strong>After Cancellation:</strong>
                        <ul style="margin: 8px 0 0 20px; font-size: 13px;">
                            <li>All interested suppliers notified immediately</li>
                            <li>Submitted bids archived</li>
                            <li>Requisition lines released in ERP</li>
                            <li>Tender marked as "Cancelled" on Agora and UNGM</li>
                            <li>All details logged in audit trail</li>
                        </ul>
                    </div>
                </div>

                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin-top: 20px;">
                    <input type="checkbox" id="confirm-cancellation">
                    <strong>I confirm that I want to cancel this tender</strong>
                </label>
            </div>

            <div class="modal-footer">
                <button class="btn btn-ghost" onclick="closeCancelModal()">Close</button>
                <button class="btn btn-danger" id="confirm-cancel-btn" onclick="submitCancellation()" disabled>
                    <i class="pi pi-times-circle"></i> Confirm Cancellation
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentTenderId = null;
        let currentTenderTitle = null;
        let currentAmendmentStep = 1;
        let selectedCategories = [];
        let highestTier = 1;

        // View Management
        function showDashboard() {
            document.querySelectorAll('.view-section').forEach(section => section.classList.remove('active'));
            document.getElementById('view-dashboard').classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showTenderDetails() {
            document.querySelectorAll('.view-section').forEach(section => section.classList.remove('active'));
            document.getElementById('view-tender-details').classList.add('active');
            document.getElementById('details-tender-id').textContent = 'Reference: ' + currentTenderId;
            document.getElementById('details-tender-title').textContent = currentTenderTitle;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function filterTenders() {
            const filterValue = event.target.value;
            const cards = document.querySelectorAll('.tender-card');
            
            cards.forEach(card => {
                const status = card.getAttribute('data-status');
                if (filterValue === 'all' || filterValue === status) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Tender Preview
        function viewTenderPreview(tenderId, tenderTitle) {
            currentTenderId = tenderId;
            currentTenderTitle = tenderTitle;
            document.getElementById('preview-tender-id').textContent = tenderId;
            document.getElementById('preview-tender-title').textContent = tenderTitle;
            document.getElementById('tender-preview-sidebar').classList.add('open');
        }

        function closeTenderPreview() {
            document.getElementById('tender-preview-sidebar').classList.remove('open');
        }

        function toggleCollapseSidebar(header) {
            const content = header.nextElementSibling;
            const icon = header.querySelector('.collapsible-icon');
            
            if (content.style.display === 'none' || !content.style.display) {
                content.style.display = 'block';
                icon.classList.remove('rotated');
            } else {
                content.style.display = 'none';
                icon.classList.add('rotated');
            }
        }

        function openAmendModalFromPreview() {
            openAmendModal(currentTenderId, currentTenderTitle);
        }

        function openCancelModalFromPreview() {
            openCancelModal(currentTenderId, currentTenderTitle);
        }

        function openAmendModalFromDetails() {
            openAmendModal(currentTenderId, currentTenderTitle);
        }

        function openCancelModalFromDetails() {
            openCancelModal(currentTenderId, currentTenderTitle);
        }

        function toggleItemCard(header, event) {
            // Prevent any parent click handlers
            if (event) {
                event.stopPropagation();
            }

            const content = header.nextElementSibling;
            const arrow = header.querySelector('.collapsible-arrow');

            if (!content || !arrow) {
                console.error('Could not find content or arrow element', header);
                return;
            }

            // Toggle the expanded state
            const isExpanded = content.classList.contains('expanded');

            if (isExpanded) {
                content.classList.remove('expanded');
                arrow.classList.remove('rotated');
            } else {
                content.classList.add('expanded');
                arrow.classList.add('rotated');
            }
        }

        // Amendment Modal
        function openAmendModal(tenderId, tenderTitle) {
            currentTenderId = tenderId;
            currentTenderTitle = tenderTitle;
            document.getElementById('amendTenderTitle').textContent = tenderId;
            document.getElementById('amendModal').classList.add('active');
            currentAmendmentStep = 1;
            updateAmendmentStepDisplay();
        }

        function closeAmendModal() {
            document.getElementById('amendModal').classList.remove('active');
            resetAmendmentForm();
        }

        function resetAmendmentForm() {
            currentAmendmentStep = 1;
            selectedCategories = [];
            highestTier = 1;
            
            document.querySelectorAll('.category-checkbox').forEach(cb => cb.checked = false);
            document.getElementById('amendment-description').value = '';
            document.getElementById('amendment-justification').value = '';
            document.getElementById('impacts-mandatory').checked = false;
            document.getElementById('mandatory-impact-notice').style.display = 'none';
            
            updateAmendmentStepDisplay();
        }

        function updateAmendmentWorkflow() {
            selectedCategories = [];
            highestTier = 0;

            // Tier 1
            if (document.getElementById('cat-deadline-extension').checked) {
                selectedCategories.push({ name: 'Deadline Extension', tier: 1 });
                highestTier = Math.max(highestTier, 1);
            }
            if (document.getElementById('cat-clarification-extension').checked) {
                selectedCategories.push({ name: 'Clarification Extension', tier: 1 });
                highestTier = Math.max(highestTier, 1);
            }
            if (document.getElementById('cat-award-date').checked) {
                selectedCategories.push({ name: 'Expected Award Date', tier: 1 });
                highestTier = Math.max(highestTier, 1);
            }

            // Tier 2
            const tier2Cats = [
                { id: 'cat-deadline-shortened', name: 'Deadline Shortened' },
                { id: 'cat-prebid-minutes', name: 'Pre-bid Minutes' },
                { id: 'cat-document-revision', name: 'Document Revision' },
                { id: 'cat-scope-change', name: 'Scope/Quantity Change' },
                { id: 'cat-terms-conditions', name: 'Terms & Criteria' },
                { id: 'cat-price-adjustment', name: 'Price Adjustment' },
                { id: 'cat-error-correction', name: 'Error Correction' },
                { id: 'cat-other', name: 'Other' }
            ];

            tier2Cats.forEach(cat => {
                if (document.getElementById(cat.id).checked) {
                    selectedCategories.push({ name: cat.name, tier: 2 });
                    highestTier = Math.max(highestTier, 2);
                }
            });

            if (selectedCategories.length > 0) {
                document.getElementById('workflow-preview').style.display = 'block';
                displayWorkflow('workflow-display');
            } else {
                document.getElementById('workflow-preview').style.display = 'none';
            }
        }

        function displayWorkflow(containerId) {
            const container = document.getElementById(containerId);
            
            if (highestTier === 1) {
                container.innerHTML = `
                    <div class="workflow-steps">
                        <div class="workflow-step">
                            <div class="workflow-step-icon">‚úçÔ∏è</div>
                            <div class="workflow-step-label">Author Creates</div>
                        </div>
                        <div class="workflow-arrow">‚Üí</div>
                        <div class="workflow-step">
                            <div class="workflow-step-icon">üì¢</div>
                            <div class="workflow-step-label">Auto Posted</div>
                        </div>
                        <div class="workflow-arrow">‚Üí</div>
                        <div class="workflow-step">
                            <div class="workflow-step-icon">üìß</div>
                            <div class="workflow-step-label">Suppliers Notified</div>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div class="workflow-steps">
                        <div class="workflow-step">
                            <div class="workflow-step-icon">‚úçÔ∏è</div>
                            <div class="workflow-step-label">Author Creates</div>
                        </div>
                        <div class="workflow-arrow">‚Üí</div>
                        <div class="workflow-step">
                            <div class="workflow-step-icon">üë®‚Äçüî¨</div>
                            <div class="workflow-step-label">TME Review</div>
                        </div>
                        <div class="workflow-arrow">‚Üí</div>
                        <div class="workflow-step">
                            <div class="workflow-step-icon">‚úÖ</div>
                            <div class="workflow-step-label">PR Approval</div>
                        </div>
                        <div class="workflow-arrow">‚Üí</div>
                        <div class="workflow-step">
                            <div class="workflow-step-icon">üì¢</div>
                            <div class="workflow-step-label">Posted</div>
                        </div>
                        <div class="workflow-arrow">‚Üí</div>
                        <div class="workflow-step">
                            <div class="workflow-step-icon">üìß</div>
                            <div class="workflow-step-label">Notified</div>
                        </div>
                    </div>
                `;
            }
        }

        function nextAmendmentStep() {
            if (currentAmendmentStep === 1) {
                if (selectedCategories.length === 0) {
                    alert('Please select at least one amendment category');
                    return;
                }
            } else if (currentAmendmentStep === 2) {
                if (!document.getElementById('amendment-description').value.trim()) {
                    alert('Please provide an amendment description');
                    return;
                }
            }

            if (currentAmendmentStep < 3) {
                currentAmendmentStep++;
                
                if (currentAmendmentStep === 3) {
                    populateReviewStep();
                }
                
                updateAmendmentStepDisplay();
            } else {
                submitAmendment();
            }
        }

        function previousAmendmentStep() {
            if (currentAmendmentStep > 1) {
                currentAmendmentStep--;
                updateAmendmentStepDisplay();
            }
        }

        function updateAmendmentStepDisplay() {
            for (let i = 1; i <= 3; i++) {
                document.getElementById(`amendment-step-${i}`).style.display = 'none';
                document.getElementById(`step${i}-number`).classList.remove('active', 'completed');
                document.getElementById(`step${i}-label`).classList.remove('active');
            }

            document.getElementById(`amendment-step-${currentAmendmentStep}`).style.display = 'block';
            document.getElementById(`step${currentAmendmentStep}-number`).classList.add('active');
            document.getElementById(`step${currentAmendmentStep}-label`).classList.add('active');

            for (let i = 1; i < currentAmendmentStep; i++) {
                document.getElementById(`step${i}-number`).classList.add('completed');
            }

            document.getElementById('amendment-back-btn').style.display = currentAmendmentStep > 1 ? 'inline-flex' : 'none';
            const nextBtn = document.getElementById('amendment-next-btn');
            nextBtn.innerHTML = currentAmendmentStep === 3 
                ? '<i class="pi pi-check"></i> Submit Amendment' 
                : 'Next <i class="pi pi-arrow-right"></i>';
        }

        function populateReviewStep() {
            const categoriesHtml = selectedCategories.map(cat => 
                `<span class="tier-badge tier-${cat.tier}" style="margin-right: 8px;">${cat.name}</span>`
            ).join('');
            document.getElementById('review-categories').innerHTML = categoriesHtml;

            const tierHtml = highestTier === 1 
                ? '<span class="tier-badge tier-1">Tier 1 - Author posts directly</span>'
                : '<span class="tier-badge tier-2">Tier 2 - Requires TME & PR review</span>';
            document.getElementById('review-tier').innerHTML = tierHtml;

            document.getElementById('review-description').textContent = 
                document.getElementById('amendment-description').value;

            const impactsMandatory = document.getElementById('impacts-mandatory').checked;
            document.getElementById('review-mandatory').innerHTML = impactsMandatory
                ? '<span style="color: var(--danger-500); font-weight: 600;">‚ö†Ô∏è Yes - Will invalidate existing bids</span>'
                : '<span style="color: var(--success-500);">‚úì No - Existing bids remain valid</span>';

            displayWorkflow('final-workflow-display');
        }

        function submitAmendment() {
            alert(`Amendment submitted successfully for ${currentTenderId}!\n\n` +
                  `The amendment will follow the ${highestTier === 1 ? 'Tier 1 workflow (direct posting)' : 'Tier 2 workflow (TME & PR review)'}.`);
            closeAmendModal();
        }

        function toggleMandatoryImpact() {
            const checked = document.getElementById('impacts-mandatory').checked;
            document.getElementById('mandatory-impact-notice').style.display = checked ? 'block' : 'none';
        }

        // Cancel Modal
        function openCancelModal(tenderId, tenderTitle) {
            currentTenderId = tenderId;
            currentTenderTitle = tenderTitle;
            document.getElementById('cancelTenderTitle').textContent = tenderId;
            document.getElementById('cancelModal').classList.add('active');
        }

        function closeCancelModal() {
            document.getElementById('cancelModal').classList.remove('active');
            resetCancelForm();
        }

        function resetCancelForm() {
            document.getElementById('cancel-reason').value = '';
            document.getElementById('cancel-internal-explanation').value = '';
            document.getElementById('cancel-public-justification').value = '';
            document.getElementById('confirm-cancellation').checked = false;
            document.getElementById('confirm-cancel-btn').disabled = true;
        }

        function submitCancellation() {
            const reason = document.getElementById('cancel-reason').value;
            const internalExp = document.getElementById('cancel-internal-explanation').value;
            const publicJust = document.getElementById('cancel-public-justification').value;

            if (!reason || !internalExp || !publicJust) {
                alert('Please fill in all required fields');
                return;
            }

            alert(`Tender ${currentTenderId} has been cancelled.\n\n` +
                  `- All suppliers have been notified\n` +
                  `- Bids have been archived\n` +
                  `- Requisition lines released in ERP\n` +
                  `- Cancellation logged in audit trail`);
            
            closeCancelModal();
        }

        // Enable cancel button
        document.getElementById('confirm-cancellation').addEventListener('change', function() {
            const reason = document.getElementById('cancel-reason').value;
            const internalExp = document.getElementById('cancel-internal-explanation').value;
            const publicJust = document.getElementById('cancel-public-justification').value;
            
            document.getElementById('confirm-cancel-btn').disabled = 
                !(this.checked && reason && internalExp && publicJust);
        });

        // Close modals on overlay click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        // Close sidebar on overlay click
        document.getElementById('tender-preview-sidebar').addEventListener('click', function(e) {
            if (e.target === this) {
                closeTenderPreview();
            }
        });
    </script>
</body>
</html>
