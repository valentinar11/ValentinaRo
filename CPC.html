<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNOPS Procurement | Award & Review</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/primeicons@6.0.1/primeicons.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* UNOPS Preset Primary Colors */
            --primary-50: #e6f7ff;
            --primary-100: #bae7ff;
            --primary-200: #7dd3fc;
            --primary-300: #38bdf8;
            --primary-400: #0ea5e9;
            --primary-500: #0092D1;
            --primary-600: #0284c7;
            --primary-700: #0369a1;
            --surface-0: #ffffff;
            --surface-50: #f5f8fb;
            --surface-100: #ebf1f8;
            --surface-200: #dde8f2;
            --surface-300: #cfdfec;
            --surface-600: #95a7ba;
            --surface-800: #596170;
            --surface-900: #3b3e4a;
            --success-500: #4c9f38;
            --success-50: #d2e7cd;
            --success-100: #e8f5e9;
            --success-700: #388e3c;
            --info-400: #0092d1;
            --info-50: #bfe4f4;
            --info-100: #e3f2fd;
            --info-500: #2196f3;
            --info-700: #1976d2;
            --warning-500: #e85c0e;
            --warning-50: #f9d6c3;
            --warning-100: #fff3e0;
            --warning-700: #f57c00;
            --danger-500: #da291c;
            --danger-50: #f6cac6;
            --purple-50: #f3e8ff;
            --purple-100: #e9d5ff;
            --purple-500: #9333ea;
            --purple-700: #7c3aed;
            --text-primary: var(--surface-900);
            --text-secondary: var(--surface-800);
            --text-muted: var(--surface-600);
            --spacing-xs: 6px;
            --spacing-sm: 12px;
            --spacing-md: 20px;
            --spacing-lg: 28px;
            --spacing-xl: 36px;
            --spacing-2xl: 48px;
            --radius-sm: 4px;
            --radius-md: 6px;
            --radius-lg: 8px;
            --shadow-card: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.06);
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Lato', 'Noto Sans', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--surface-50);
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: var(--surface-0);
            border-bottom: 1px solid var(--surface-200);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-md) var(--spacing-xl);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .logo {
            font-weight: 700;
            font-size: 20px;
            letter-spacing: 0.12em;
            color: var(--primary-400);
        }

        .portal-badge {
            background: var(--primary-400);
            color: white;
            font-size: 12px;
            font-weight: 600;
            padding: 4px 12px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .user-info {
            text-align: right;
        }

        .user-company {
            font-size: 12px;
            color: var(--text-muted);
        }

        .user-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--primary-100);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--primary-600);
            cursor: pointer;
        }

        /* Header Actions */
        .header-actions {
            display: flex;
            align-items: center;
            gap: 4px;
            margin-left: auto;
            margin-right: var(--spacing-md);
        }

        .header-action-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 8px 10px;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-secondary);
            position: relative;
        }

        .header-action-btn:hover {
            background: var(--surface-100);
            color: var(--primary-500);
        }

        .header-action-btn i {
            font-size: 18px;
        }

        .notification-badge {
            position: absolute;
            top: 2px;
            right: 2px;
            background: var(--danger-500);
            color: white;
            font-size: 9px;
            font-weight: 700;
            min-width: 14px;
            height: 14px;
            border-radius: 7px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 3px;
        }

        .ai-icon-wrapper {
            background: linear-gradient(135deg, #9333ea, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .ai-assistant-btn:hover .ai-icon-wrapper {
            background: linear-gradient(135deg, #7c3aed, #db2777);
            -webkit-background-clip: text;
            background-clip: text;
        }

        /* Accessibility Panel Styles */
        .accessibility-panel {
            position: fixed;
            top: 70px;
            right: 20px;
            width: 320px;
            background: var(--surface-0);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            z-index: 10000;
            display: none;
            border: 1px solid var(--surface-200);
        }

        .accessibility-panel.open {
            display: block;
        }

        .accessibility-panel-header {
            padding: var(--spacing-lg);
            background: var(--surface-50);
            border-bottom: 1px solid var(--surface-200);
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .accessibility-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--surface-100);
        }

        .accessibility-option:last-child {
            border-bottom: none;
        }

        .accessibility-toggle {
            width: 44px;
            height: 24px;
            background: var(--surface-300);
            border-radius: 12px;
            cursor: pointer;
            position: relative;
            transition: background 0.2s;
        }

        .accessibility-toggle.active {
            background: var(--primary-500);
        }

        .accessibility-toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.2s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .accessibility-toggle.active::after {
            transform: translateX(20px);
        }

        /* Pending Tasks Table */
        .pending-tasks-table-section {
            background: var(--surface-0);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
            border: 1px solid var(--surface-200);
            box-shadow: var(--shadow-card);
        }

        .action-required-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md);
            border-radius: var(--radius-sm);
            margin-bottom: var(--spacing-sm);
            background: var(--surface-0);
            border: 1px solid var(--surface-200);
            transition: all 0.2s;
        }

        .action-required-item:hover {
            border-color: var(--surface-300);
            box-shadow: var(--shadow-sm);
        }

        .action-required-item:last-child {
            margin-bottom: 0;
        }

        .action-required-item.warning {
            border-left: 3px solid var(--warning-500);
        }

        .action-required-item.info {
            border-left: 3px solid var(--info-500);
        }

        .action-required-item.success {
            border-left: 3px solid var(--success-500);
        }

        .action-required-item.danger {
            border-left: 3px solid var(--danger-500);
        }

        .action-item-content {
            flex: 1;
        }

        .action-item-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .action-item-desc {
            font-size: 12px;
            color: var(--text-muted);
        }

        .action-item-meta {
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
        }

        .due-badge {
            padding: 4px 10px;
            border-radius: var(--radius-sm);
            font-size: 11px;
            font-weight: 500;
            background: var(--surface-100);
            color: var(--text-secondary);
        }

        .due-badge.urgent {
            color: var(--warning-700);
        }

        .due-badge.normal {
            color: var(--text-muted);
        }

        /* Compact Action Table */
        .action-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .action-table tr {
            border-bottom: 1px solid var(--surface-100);
        }

        .action-table tr:last-child {
            border-bottom: none;
        }

        .action-table tr:hover {
            background: var(--surface-50);
        }

        .action-table td {
            padding: 8px 10px;
            vertical-align: middle;
        }

        .action-table td:first-child {
            padding-left: 0;
        }

        .action-indicator {
            width: 4px;
            height: 28px;
            border-radius: 2px;
        }

        .action-indicator.warning {
            background: var(--warning-500);
        }

        .action-indicator.info {
            background: var(--info-500);
        }

        .action-indicator.success {
            background: var(--success-500);
        }

        .action-indicator.danger {
            background: var(--danger-500);
        }

        .action-desc {
            color: var(--text-muted);
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .due-text {
            font-size: 12px;
            color: var(--text-muted);
        }

        .due-text.urgent {
            color: var(--warning-600);
            font-weight: 500;
        }

        .btn-link {
            background: none;
            border: none;
            color: var(--primary-500);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            padding: 0;
        }

        .btn-link:hover {
            color: var(--primary-700);
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .header-actions {
                gap: 4px;
            }
            .header-action-label {
                display: none;
            }
            .header-action-btn {
                padding: 8px;
            }
        }

        /* Layout */
        .app-container {
            display: flex;
            flex-direction: row;
            min-height: calc(100vh - 65px);
            width: 100%;
        }

        /* Sidebar */
        .sidebar {
            width: 300px;
            min-width: 300px;
            max-width: 300px;
            background-color: #0192D1;
            color: white;
            display: flex;
            flex-direction: column;
            border-right: none;
            flex-shrink: 0;
            overflow-y: auto;
        }

        .sidebar-menu {
            flex: 1;
            padding: 16px 0;
        }

        .menu-section {
            margin-bottom: var(--spacing-sm);
        }

        .menu-section-title {
            padding: 8px 20px 12px 20px;
            font-size: 11px;
            font-weight: 700;
            color: rgba(255,255,255,0.5);
            font-family: 'Lato', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            font-size: 14px;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            border-left: 3px solid transparent;
        }

        .menu-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .menu-item.active {
            background: rgba(255,255,255,0.15);
            border-left-color: white;
            font-weight: 600;
        }

        .menu-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .menu-item.disabled:hover {
            background-color: transparent;
        }

        .menu-icon {
            font-size: 16px;
            opacity: 0.9;
            width: 20px;
            text-align: center;
        }

        .menu-badge {
            margin-left: auto;
            padding: 2px 8px;
            background: var(--danger-500);
            color: white;
            font-size: 11px;
            font-weight: 600;
            border-radius: 999px;
        }

        .menu-group {
            margin-bottom: var(--spacing-xs);
        }

        .menu-group-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 20px;
            font-size: 13px;
            font-weight: 600;
            color: rgba(255,255,255,0.7);
            cursor: pointer;
            transition: all 0.2s;
        }

        .menu-group-header:hover {
            color: white;
            background: rgba(255,255,255,0.05);
        }

        .menu-group-header i {
            font-size: 12px;
            transition: transform 0.2s;
        }

        .menu-group.collapsed .menu-group-header i.pi-chevron-down {
            transform: rotate(-90deg);
        }

        .menu-group.collapsed .menu-group-items {
            display: none;
        }

        .menu-group-items {
            padding-left: 12px;
        }

        .menu-group-items .menu-item {
            padding: 10px 20px 10px 28px;
            font-size: 13px;
            border-left: none;
        }

        .menu-group-items .menu-item.active {
            background: rgba(255,255,255,0.15);
            border-left: none;
            border-radius: 0 4px 4px 0;
            margin-right: 8px;
        }

        .menu-divider {
            height: 1px;
            background: rgba(255,255,255,0.15);
            margin: var(--spacing-md) 0;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: var(--spacing-xl);
            overflow-y: auto;
            min-width: 0;
            position: relative;
        }

        .view-section {
            display: none;
            width: 100%;
            max-width: 100%;
        }

        .view-section.active {
            display: block;
        }

        .page-header {
            margin-bottom: var(--spacing-xl);
        }

        .page-title {
            font-size: 28px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .page-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Pending Tasks Section */
        .pending-tasks-section {
            margin-bottom: var(--spacing-xl);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-md);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .section-title i {
            color: var(--primary-500);
        }

        .tasks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
        }

        .task-item {
            background: var(--surface-0);
            border: 1px solid var(--surface-200);
            border-radius: var(--radius-md);
            padding: var(--spacing-md) var(--spacing-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            cursor: pointer;
            transition: all 0.2s;
        }

        .task-item:hover {
            border-color: var(--primary-400);
            box-shadow: var(--shadow-sm);
            transform: translateY(-2px);
        }

        .task-badge {
            background: var(--primary-500);
            color: white;
            font-size: 16px;
            font-weight: 700;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .task-badge.warning {
            background: var(--warning-500);
        }

        .task-badge.info {
            background: var(--info-500);
        }

        .task-badge.success {
            background: var(--success-500);
        }

        .task-content {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            flex: 1;
            font-size: 14px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .task-icon-inline {
            font-size: 16px;
            color: var(--primary-500);
        }

        /* Filter Bar */
        .filter-bar {
            background: white;
            padding: 20px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--surface-200);
            margin-bottom: 24px;
            display: flex;
            gap: 16px;
            align-items: center;
            flex-wrap: wrap;
            box-shadow: var(--shadow-card);
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-label {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-muted);
        }

        .filter-select {
            padding: 8px 12px;
            border: 1px solid var(--surface-200);
            border-radius: var(--radius-sm);
            font-size: 13px;
            background: white;
            cursor: pointer;
            min-width: 150px;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary-400);
        }

        /* Case Cards */
        .case-grid {
            display: grid;
            gap: 20px;
        }

        .case-card {
            background: white;
            border-radius: var(--radius-lg);
            border: 1px solid var(--surface-200);
            padding: 24px;
            transition: all 0.2s;
            cursor: pointer;
            box-shadow: var(--shadow-card);
        }

        .case-card:hover {
            box-shadow: var(--shadow-md);
            border-color: var(--primary-400);
        }

        .case-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 16px;
        }

        .case-title-section {
            flex: 1;
        }

        .case-id {
            font-size: 12px;
            color: var(--text-muted);
            font-weight: 500;
            margin-bottom: 4px;
        }

        .case-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.pending {
            background: var(--warning-50);
            color: var(--warning-500);
        }

        .status-badge.review {
            background: var(--info-50);
            color: var(--info-400);
        }

        .status-badge.approved {
            background: var(--success-50);
            color: var(--success-500);
        }

        .status-badge.deliberation {
            background: var(--purple-50);
            color: var(--purple-500);
        }

        .status-badge.returned {
            background: var(--danger-50);
            color: var(--danger-500);
        }

        .case-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--surface-200);
        }

        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .meta-label {
            font-size: 12px;
            color: var(--text-muted);
        }

        .meta-value {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .case-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 10px 16px;
            border-radius: var(--radius-sm);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary-500);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-600);
        }

        .btn-secondary {
            background: var(--surface-100);
            color: var(--text-primary);
            border: 1px solid var(--surface-200);
        }

        .btn-secondary:hover {
            background: var(--surface-200);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 13px;
        }

        /* Action Required List */
        .action-required-section {
            background: var(--surface-0);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            margin-bottom: var(--spacing-xl);
            border: 1px solid var(--surface-200);
        }

        .action-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md);
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            margin-bottom: var(--spacing-md);
        }

        .action-item:last-child {
            margin-bottom: 0;
        }

        .action-item.warning {
            background: var(--warning-50);
            border-left: 4px solid var(--warning-500);
        }

        .action-item.info {
            background: var(--info-50);
            border-left: 4px solid var(--info-500);
        }

        .action-item.success {
            background: var(--success-50);
            border-left: 4px solid var(--success-500);
        }

        .action-item.purple {
            background: var(--purple-50);
            border-left: 4px solid var(--purple-500);
        }

        .action-content {
            flex: 1;
        }

        .action-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .action-subtitle {
            font-size: 12px;
            color: var(--text-muted);
        }

        .action-buttons {
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
        }

        .action-tag {
            padding: 4px 10px;
            border-radius: var(--radius-sm);
            font-size: 11px;
            font-weight: 600;
        }

        .action-tag.warning {
            background: var(--warning-100);
            color: var(--warning-700);
        }

        .action-tag.info {
            background: var(--info-100);
            color: var(--info-700);
        }

        .action-tag.success {
            background: var(--success-100);
            color: var(--success-700);
        }

        .action-tag.purple {
            background: var(--purple-100);
            color: var(--purple-700);
        }

        /* Data Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: var(--spacing-sm) var(--spacing-md);
            text-align: left;
            border-bottom: 1px solid var(--surface-200);
        }

        .data-table th {
            background: var(--surface-50);
            font-weight: 600;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .data-table tr:hover td {
            background: var(--surface-50);
        }

        /* Cases Table - Compact Typography */
        #allCasesTable th,
        #allCasesTable td {
            padding: 8px 12px;
            font-size: 12px;
        }

        #allCasesTable th {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        #allCasesTable td strong {
            font-size: 12px;
        }

        /* Meeting Card */
        .meeting-card {
            background: white;
            border-radius: var(--radius-lg);
            border: 1px solid var(--surface-200);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
            box-shadow: var(--shadow-card);
        }

        .meeting-date {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            color: var(--primary-500);
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
        }

        .meeting-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
        }

        .meeting-meta {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-md);
        }

        .meeting-cases {
            background: var(--surface-50);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
        }

        .meeting-cases-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-sm);
        }

        /* Pool Member */
        .pool-member {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--surface-200);
        }

        .pool-member:last-child {
            border-bottom: none;
        }

        .member-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--primary-100);
            color: var(--primary-700);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 18px;
        }

        /* Pool Management - Quarter Buttons */
        .quarter-btn {
            padding: 6px 14px;
            background: var(--surface-0);
            border: 1px solid var(--surface-300);
            border-radius: var(--radius-sm);
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .quarter-btn:hover {
            border-color: var(--primary-400);
            color: var(--primary-500);
        }

        .quarter-btn.active {
            background: var(--primary-500);
            border-color: var(--primary-500);
            color: white;
        }

        /* Region Card */
        .region-card {
            background: var(--surface-0);
            border: 1px solid var(--surface-200);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }

        .region-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md);
            background: var(--surface-50);
            border-bottom: 1px solid var(--surface-200);
        }

        .region-members {
            padding: var(--spacing-sm);
        }

        .assigned-member {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            border-radius: var(--radius-sm);
            transition: background 0.2s;
        }

        .assigned-member:hover {
            background: var(--surface-50);
        }

        .assigned-member.warning-highlight {
            background: var(--warning-50);
            border: 1px dashed var(--warning-300);
        }

        /* Pool Tab Content */
        .pool-tab-content {
            margin-top: var(--spacing-lg);
        }

        /* Member Modal Tab */
        .member-modal-tab {
            min-height: 200px;
        }

        .member-info {
            flex: 1;
        }

        .member-name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .member-role {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .member-stats {
            text-align: right;
        }

        .member-stat {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* Q&A Thread */
        .qa-thread {
            background: white;
            border-radius: var(--radius-lg);
            border: 1px solid var(--surface-200);
            margin-bottom: var(--spacing-md);
            overflow: hidden;
            box-shadow: var(--shadow-card);
        }

        .qa-thread-header {
            padding: var(--spacing-md) var(--spacing-lg);
            background: var(--surface-50);
            border-bottom: 1px solid var(--surface-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .qa-case-ref {
            font-weight: 600;
            color: var(--primary-700);
        }

        .qa-message {
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 1px solid var(--surface-100);
        }

        .qa-message:last-of-type {
            border-bottom: none;
        }

        .qa-message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: var(--spacing-sm);
        }

        .qa-author {
            font-weight: 600;
            color: var(--text-primary);
        }

        .qa-author.cpc {
            color: var(--primary-700);
        }

        .qa-date {
            font-size: 12px;
            color: var(--text-muted);
        }

        .qa-content {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .qa-reply-box {
            padding: var(--spacing-md) var(--spacing-lg);
            background: var(--surface-50);
        }

        .qa-reply-box textarea {
            width: 100%;
            padding: var(--spacing-md);
            border: 1px solid var(--surface-300);
            border-radius: var(--radius-md);
            resize: vertical;
            min-height: 80px;
            margin-bottom: var(--spacing-sm);
            font-family: inherit;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: var(--spacing-xs);
            border-bottom: 2px solid var(--surface-200);
            margin-bottom: var(--spacing-lg);
        }

        .tab {
            padding: var(--spacing-sm) var(--spacing-lg);
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
            transition: all 0.2s;
        }

        .tab:hover {
            color: var(--primary-500);
        }

        .tab.active {
            color: var(--primary-500);
            border-bottom-color: var(--primary-500);
        }

        /* Card component */
        .card {
            background: white;
            border-radius: var(--radius-lg);
            border: 1px solid var(--surface-200);
            box-shadow: var(--shadow-card);
        }

        .card-header {
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 1px solid var(--surface-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .card-body {
            padding: var(--spacing-lg);
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--surface-800);
            color: white;
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .toast.success {
            background: var(--success-500);
        }

        .toast.warning {
            background: var(--warning-500);
        }

        .toast.error {
            background: var(--danger-500);
        }

        /* Role Badge */
        .role-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .role-badge.chair {
            background: var(--purple-100);
            color: var(--purple-700);
        }

        .role-badge.member {
            background: var(--info-100);
            color: var(--info-700);
        }

        .role-badge.associate {
            background: var(--success-100);
            color: var(--success-700);
        }

        .role-badge.expert {
            background: var(--warning-100);
            color: var(--warning-700);
        }

        /* My Cases Cards */
        .my-cases-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: var(--spacing-md);
        }

        .my-case-card {
            background: white;
            border-radius: var(--radius-lg);
            border: 1px solid var(--surface-200);
            padding: var(--spacing-lg);
            transition: all 0.2s;
            cursor: pointer;
            box-shadow: var(--shadow-card);
        }

        .my-case-card:hover {
            box-shadow: var(--shadow-md);
            border-color: var(--primary-400);
        }

        .my-case-card .case-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--spacing-sm);
        }

        /* Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: var(--radius-lg);
            max-width: 900px;
            width: 95%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
        }

        .modal-header {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--surface-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-muted);
        }

        .modal-close:hover {
            color: var(--text-primary);
        }

        .modal-body {
            padding: var(--spacing-lg);
        }

        .modal-footer {
            padding: var(--spacing-lg);
            border-top: 1px solid var(--surface-200);
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-sm);
        }

        /* Team Badge */
        .team-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            background: var(--primary-50);
            border: 1px solid var(--primary-200);
            border-radius: 20px;
            font-size: 12px;
            color: var(--primary-700);
        }

        .team-badge button {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--danger-500);
            padding: 0;
            margin-left: 4px;
        }

        /* Deliberation Thread */
        .deliberation-thread {
            background: var(--surface-50);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-left: 3px solid var(--primary-500);
        }

        .deliberation-author {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-sm);
        }

        .deliberation-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--primary-100);
            color: var(--primary-700);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 12px;
        }

        .deliberation-content {
            padding-left: 44px;
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Collapsible Section */
        .collapsible-section {
            background: white;
            border: 1px solid var(--surface-200);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-md);
            overflow: hidden;
        }

        .collapsible-header {
            padding: var(--spacing-md) var(--spacing-lg);
            background: var(--surface-50);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--surface-200);
        }

        .collapsible-header:hover {
            background: var(--surface-100);
        }

        .collapsible-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .collapsible-content {
            padding: var(--spacing-lg);
        }

        .collapsible-content.collapsed {
            display: none;
        }

        /* Evaluation Table */
        .eval-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .eval-table th,
        .eval-table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid var(--surface-200);
        }

        .eval-table th {
            background: var(--surface-50);
            font-weight: 600;
            color: var(--text-secondary);
        }

        /* Progress Indicator */
        .case-progress {
            display: flex;
            justify-content: space-between;
            position: relative;
            margin-bottom: var(--spacing-xl);
        }

        .case-progress::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--surface-200);
            z-index: 0;
        }

        .progress-step {
            text-align: center;
            z-index: 1;
        }

        .progress-step-circle {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            margin: 0 auto;
        }

        .progress-step-circle.completed {
            background: var(--success-500);
            color: white;
        }

        .progress-step-circle.active {
            background: var(--warning-500);
            color: white;
        }

        .progress-step-circle.pending {
            background: var(--surface-300);
            color: var(--text-muted);
        }

        .progress-step-label {
            font-size: 11px;
            margin-top: var(--spacing-xs);
            color: var(--text-muted);
        }

        .progress-step-label.completed {
            color: var(--success-600);
            font-weight: 500;
        }

        .progress-step-label.active {
            color: var(--warning-600);
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- Skip Link for Accessibility -->
    <a href="#main-content" class="skip-link" style="position: absolute; left: -10000px; top: auto; width: 1px; height: 1px; overflow: hidden;">Skip to main content</a>
    
    <!-- Header -->
    <header class="header" role="banner">
        <div class="header-top">
            <div class="logo-container">
                <div class="logo">UNOPS</div>
                <span class="portal-badge">Procurement</span>
                <span style="color: var(--surface-400); margin: 0 8px; font-size: 18px;">|</span>
                <span style="color: var(--primary-500); font-weight: 600; font-size: 14px;">eTendering</span>
            </div>
            
            <!-- Header Actions: Notifications, Help, AI, Accessibility -->
            <div class="header-actions">
                <!-- Accessibility Button -->
                <div class="header-action-btn" onclick="openAccessibilityPanel()" title="Accessibility Options" aria-label="Accessibility Options">
                    <i class="pi pi-eye" aria-hidden="true"></i>
                </div>
                
                <!-- Language Selector -->
                <div class="header-action-btn language-selector" onclick="openLanguageSelector()" title="Change Language" aria-label="Change Language">
                    <span class="lang-flag">üåê</span>
                    <i class="pi pi-chevron-down" style="font-size: 10px; margin-left: 2px;" aria-hidden="true"></i>
                </div>

                <!-- AI Assistant -->
                <div class="header-action-btn ai-assistant-btn" onclick="openAIAssistant()" title="AI Assistant" aria-label="AI Procurement Assistant">
                    <div class="ai-icon-wrapper">
                        <i class="pi pi-bolt" aria-hidden="true"></i>
                    </div>
                </div>

                <!-- Help/Questions -->
                <div class="header-action-btn" onclick="openHelpCenter()" title="Help Center" aria-label="Help Center and Documentation">
                    <i class="pi pi-question-circle" aria-hidden="true"></i>
                </div>

                <!-- Notifications -->
                <div class="header-action-btn notification-btn" onclick="openNotificationsPanel()" title="Notifications" aria-label="View Notifications">
                    <i class="pi pi-bell" aria-hidden="true"></i>
                    <span class="notification-badge" id="notificationCount">7</span>
                </div>
            </div>

            <div class="user-menu">
                <div class="user-info">
                    <div class="user-company">UNOPS CPC</div>
                    <div class="user-name">Maria Garcia</div>
                </div>
                <div class="user-avatar" aria-label="User menu">MG</div>
            </div>
        </div>
    </header>

    <!-- App Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <nav class="sidebar-menu">
                <!-- Administrative Applications -->
                <div class="menu-section">
                    <div class="menu-section-title">Administrative Applications</div>
                    
                    <!-- System Settings -->
                    <div class="menu-group collapsed">
                        <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                            <span><i class="pi pi-cog"></i> System Settings</span>
                            <i class="pi pi-chevron-down"></i>
                        </div>
                        <div class="menu-group-items">
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-users"></i></span><span>User Role Management</span></a>
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-id-card"></i></span><span>Role Management</span></a>
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-sliders-h"></i></span><span>Attribute Management</span></a>
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-database"></i></span><span>Data Management</span></a>
                        </div>
                    </div>
                    
                    <!-- Components -->
                    <div class="menu-group collapsed">
                        <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                            <span><i class="pi pi-box"></i> Components</span>
                            <i class="pi pi-chevron-down"></i>
                        </div>
                        <div class="menu-group-items">
                            <a class="menu-item" href="https://valentinar11.github.io/ValentinaRo/components-library.html"><span class="menu-icon"><i class="pi pi-list"></i></span><span>Evaluation Criteria Library</span></a>
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-cog"></i></span><span>Specifications Library</span></a>
                        </div>
                    </div>
                    
                    <!-- Forms -->
                    <div class="menu-group collapsed">
                        <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                            <span><i class="pi pi-file-edit"></i> Forms</span>
                            <i class="pi pi-chevron-down"></i>
                        </div>
                        <div class="menu-group-items">
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-folder"></i></span><span>Forms Library</span></a>
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-pencil"></i></span><span>Form Builder</span></a>
                        </div>
                    </div>
                    
                    <!-- Processes -->
                    <div class="menu-group collapsed">
                        <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                            <span><i class="pi pi-sitemap"></i> Processes</span>
                            <i class="pi pi-chevron-down"></i>
                        </div>
                        <div class="menu-group-items">
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-list"></i></span><span>Process Library</span></a>
                        </div>
                    </div>
                    
                    <!-- Templates -->
                    <div class="menu-group collapsed">
                        <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                            <span><i class="pi pi-copy"></i> Templates</span>
                            <i class="pi pi-chevron-down"></i>
                        </div>
                        <div class="menu-group-items">
                            <a class="menu-item" href="template-library.html"><span class="menu-icon"><i class="pi pi-folder"></i></span><span>Templates Library</span></a>
                            <a class="menu-item" href="template-builder-workspace.html"><span class="menu-icon"><i class="pi pi-pencil"></i></span><span>Template Builder</span></a>
                        </div>
                    </div>
                </div>
                
                <div class="menu-divider"></div>
                
                <!-- Business Applications -->
                <div class="menu-section">
                    <div class="menu-section-title">Business Applications</div>
                    
                    <!-- eTendering -->
                    <div class="menu-group collapsed">
                        <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                            <span><i class="pi pi-briefcase"></i> eTendering</span>
                            <i class="pi pi-chevron-down"></i>
                        </div>
                        <div class="menu-group-items">
                            <a class="menu-item" href="tender-dashboard-complete.html"><span class="menu-icon"><i class="pi pi-chart-bar"></i></span><span>Overview</span></a>
                            <a class="menu-item" href="tender-dashboard-complete.html"><span class="menu-icon"><i class="pi pi-folder-open"></i></span><span>Tenders</span></a>
                            <a class="menu-item" href="tender-authoring.html"><span class="menu-icon"><i class="pi pi-plus"></i></span><span>Create Tender</span></a>
                        </div>
                    </div>
                    
                    <!-- Award & Review -->
                    <div class="menu-group">
                        <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                            <span><i class="pi pi-check-square"></i> Award & Review</span>
                            <i class="pi pi-chevron-down"></i>
                        </div>
                        <div class="menu-group-items">
                            <a class="menu-item active" id="menu-overview" onclick="showView('overview', this)"><span class="menu-icon"><i class="pi pi-chart-bar"></i></span><span>Overview</span><span class="menu-badge" style="background: #f59e0b;">3</span></a>
                            <a class="menu-item" id="menu-cases" onclick="showView('cases', this)"><span class="menu-icon"><i class="pi pi-folder"></i></span><span>Cases</span></a>
                            <a class="menu-item" id="menu-meetings" onclick="showView('meetings', this)"><span class="menu-icon"><i class="pi pi-calendar"></i></span><span>Meetings</span><span class="menu-badge" style="background: var(--primary-500);">3</span></a>
                            <a class="menu-item" id="menu-pool" onclick="showView('pool', this)"><span class="menu-icon"><i class="pi pi-users"></i></span><span>Pool Management</span></a>
                            <a class="menu-item" id="menu-qa" onclick="showView('qa', this)"><span class="menu-icon"><i class="pi pi-comments"></i></span><span>Q&A</span><span class="menu-badge" style="background: #ef4444;">5</span></a>
                        </div>
                    </div>
                    
                    <!-- DRiVE -->
                    <div class="menu-group collapsed">
                        <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                            <span><i class="pi pi-shield"></i> DRiVE</span>
                            <i class="pi pi-chevron-down"></i>
                        </div>
                        <div class="menu-group-items">
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-chart-bar"></i></span><span>Overview</span></a>
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-inbox"></i></span><span>Response Library</span></a>
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-check-circle"></i></span><span>Verification</span></a>
                            <a class="menu-item" href="capa-interactive-mockup.html"><span class="menu-icon"><i class="pi pi-exclamation-triangle"></i></span><span>CAPA</span></a>
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-question-circle"></i></span><span>Questionnaire Management</span></a>
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-chart-line"></i></span><span>Risk Management</span></a>
                        </div>
                    </div>
                    
                    <!-- Contracts -->
                    <div class="menu-group collapsed">
                        <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                            <span><i class="pi pi-file"></i> Contracts</span>
                            <i class="pi pi-chevron-down"></i>
                        </div>
                        <div class="menu-group-items">
                            <a class="menu-item disabled"><span class="menu-icon"><i class="pi pi-list"></i></span><span>Contract Management</span></a>
                        </div>
                    </div>
                    
                    <!-- Supplier Management -->
                    <div class="menu-group collapsed">
                        <div class="menu-group-header" onclick="toggleMenuGroup(this)">
                            <span><i class="pi pi-truck"></i> Supplier Management</span>
                            <i class="pi pi-chevron-down"></i>
                        </div>
                        <div class="menu-group-items">
                            <a class="menu-item" href="supplier-management-procurement.html"><span class="menu-icon"><i class="pi pi-building"></i></span><span>Suppliers</span></a>
                        </div>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- ===== OVERVIEW VIEW ===== -->
            <div class="view-section active" id="view-overview">
                <div class="page-header">
                    <h1 class="page-title">Award & Review Overview</h1>
                    <p class="page-subtitle">CPC cases, meetings and approvals</p>
                </div>

                <!-- My Pending Tasks -->
                <div class="pending-tasks-section">
                    <h2 class="section-title">
                        <i class="pi pi-clock" style="color: var(--primary-500);"></i> My Pending Tasks
                    </h2>
                    <div class="tasks-grid">
                        <div class="task-item" onclick="showView('cases', document.getElementById('menu-cases'))">
                            <div class="task-badge">3</div>
                            <div class="task-content">
                                <i class="pi pi-eye task-icon-inline"></i>
                                <span>Pending Review</span>
                            </div>
                        </div>
                        <div class="task-item" onclick="showView('qa', document.getElementById('menu-qa'))">
                            <div class="task-badge warning">2</div>
                            <div class="task-content">
                                <i class="pi pi-comment task-icon-inline"></i>
                                <span>Q&A Pending</span>
                            </div>
                        </div>
                        <div class="task-item">
                            <div class="task-badge info">1</div>
                            <div class="task-content">
                                <i class="pi pi-users task-icon-inline"></i>
                                <span>Under Deliberation</span>
                            </div>
                        </div>
                        <div class="task-item">
                            <div class="task-badge">2</div>
                            <div class="task-content">
                                <i class="pi pi-check-square task-icon-inline"></i>
                                <span>Awaiting Vote</span>
                            </div>
                        </div>
                        <div class="task-item">
                            <div class="task-badge warning">1</div>
                            <div class="task-content">
                                <i class="pi pi-verified task-icon-inline"></i>
                                <span>PA Approval</span>
                            </div>
                        </div>
                        <div class="task-item" onclick="showView('meetings', document.getElementById('menu-meetings'))">
                            <div class="task-badge success">2</div>
                            <div class="task-content">
                                <i class="pi pi-calendar task-icon-inline"></i>
                                <span>Upcoming Meetings</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Required List - Same level as My Cases -->
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2 class="section-title" style="margin-bottom: var(--spacing-md);">
                        <i class="pi pi-bell"></i> Action Required
                    </h2>
                    <table class="action-table" style="background: var(--surface-0); border-radius: var(--radius-md); overflow: hidden;">
                        <tbody>
                            <tr onclick="openCase('CPC/2024/047')" style="cursor: pointer;">
                                <td style="width: 6px; padding: 0;"><div class="action-indicator warning"></div></td>
                                <td><strong>CPC/2024/047</strong></td>
                                <td>Pending Review</td>
                                <td class="action-desc">Water Supply Infrastructure</td>
                                <td><span class="due-text urgent">Due: Today</span></td>
                                <td style="text-align: right;"><button class="btn-link" onclick="event.stopPropagation(); openCase('CPC/2024/047')">Review ‚Üí</button></td>
                            </tr>
                            <tr onclick="openCase('CPC/2024/044')" style="cursor: pointer;">
                                <td style="width: 6px; padding: 0;"><div class="action-indicator info"></div></td>
                                <td><strong>CPC/2024/044</strong></td>
                                <td>2 New Questions</td>
                                <td class="action-desc">IT Equipment Procurement</td>
                                <td><span class="due-text">Q&A</span></td>
                                <td style="text-align: right;"><button class="btn-link" onclick="event.stopPropagation(); openCase('CPC/2024/044')">Respond ‚Üí</button></td>
                            </tr>
                            <tr onclick="openCase('CPC/2024/041')" style="cursor: pointer;">
                                <td style="width: 6px; padding: 0;"><div class="action-indicator danger"></div></td>
                                <td><strong>CPC/2024/041</strong></td>
                                <td>Deliberation Required</td>
                                <td class="action-desc">Solar Panel Installation</td>
                                <td><span class="due-text urgent">Overdue</span></td>
                                <td style="text-align: right;"><button class="btn-link" onclick="event.stopPropagation(); openCase('CPC/2024/041')">Add Input ‚Üí</button></td>
                            </tr>
                            <tr onclick="openCase('CPC/2024/039')" style="cursor: pointer;">
                                <td style="width: 6px; padding: 0;"><div class="action-indicator success"></div></td>
                                <td><strong>CPC/2024/039</strong></td>
                                <td>Vote Required</td>
                                <td class="action-desc">Healthcare Equipment</td>
                                <td><span class="due-text">Meeting: 16 Dec</span></td>
                                <td style="text-align: right;"><button class="btn-link" onclick="event.stopPropagation(); openCase('CPC/2024/039')">View ‚Üí</button></td>
                            </tr>
                            <tr onclick="openCase('CPC/2024/045')" style="cursor: pointer;">
                                <td style="width: 6px; padding: 0;"><div class="action-indicator warning"></div></td>
                                <td><strong>CPC/2024/045</strong></td>
                                <td>Expert Input Needed</td>
                                <td class="action-desc">Construction Services</td>
                                <td><span class="due-text urgent">Due: Tomorrow</span></td>
                                <td style="text-align: right;"><button class="btn-link" onclick="event.stopPropagation(); openCase('CPC/2024/045')">Provide ‚Üí</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- My Cases Section -->
                <div style="margin-bottom: var(--spacing-xl);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
                        <h2 class="section-title" style="margin-bottom: 0;">
                            <i class="pi pi-folder-open"></i> My Cases
                        </h2>
                        <div style="display: flex; gap: var(--spacing-sm);">
                            <select class="filter-select" id="myCasesRoleFilter" onchange="filterMyCases()">
                                <option value="all">All My Roles</option>
                                <option value="chair">CPC Chair</option>
                                <option value="member">CPC Member</option>
                                <option value="associate">CPC Associate</option>
                                <option value="expert">Expert</option>
                            </select>
                            <select class="filter-select" id="myCasesStatusFilter" onchange="filterMyCases()">
                            <option value="all">All Statuses</option>
                            <option value="pending">Pending Review</option>
                                <option value="deliberation">Deliberation</option>
                                <option value="voting">Awaiting Vote</option>
                            <option value="approved">Approved</option>
                        </select>
                    </div>
                </div>

                    <div class="my-cases-grid" id="myCasesGrid">
                        <!-- Case Card 1 - CPC Chair Role -->
                        <div class="my-case-card" data-role="chair" data-status="pending" onclick="openCase('CPC-2025-0042')">
                        <div class="case-header">
                                <div>
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: 4px;">
                                        <span class="case-id" style="margin-bottom: 0;">CPC-2025-0042</span>
                                        <span class="role-badge chair">üëë CPC Chair</span>
                                    </div>
                                    <div class="case-title" style="font-size: 16px;">Medical Supplies - Emergency Response</div>
                            </div>
                            <span class="status-badge pending">Pending Review</span>
                        </div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--spacing-sm); margin-bottom: var(--spacing-md); padding-bottom: var(--spacing-md); border-bottom: 1px solid var(--surface-200);">
                            <div class="meta-item">
                                <span class="meta-label">Tender Ref</span>
                                <span class="meta-value">ITB/2024/023</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Value</span>
                                <span class="meta-value">$2,400,000</span>
                            </div>
                            <div class="meta-item">
                                    <span class="meta-label">Due</span>
                                <span class="meta-value" style="color: var(--warning-500);">Dec 14, 2025</span>
                            </div>
                        </div>
                            <div style="display: flex; gap: var(--spacing-sm);">
                            <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); openCase('CPC-2025-0042')">
                                    <i class="pi pi-eye"></i> View Case
                            </button>
                        </div>
                    </div>

                        <!-- Case Card 2 - CPC Member Role -->
                        <div class="my-case-card" data-role="member" data-status="deliberation" onclick="openCase('CPC-2025-0041')">
                        <div class="case-header">
                                <div>
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: 4px;">
                                        <span class="case-id" style="margin-bottom: 0;">CPC-2025-0041</span>
                                        <span class="role-badge member">üë§ CPC Member</span>
                            </div>
                                    <div class="case-title" style="font-size: 16px;">IT Infrastructure Upgrade</div>
                        </div>
                                <span class="status-badge deliberation">Deliberation</span>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--spacing-sm); margin-bottom: var(--spacing-md); padding-bottom: var(--spacing-md); border-bottom: 1px solid var(--surface-200);">
                            <div class="meta-item">
                                <span class="meta-label">Tender Ref</span>
                                <span class="meta-value">RFP/2024/089</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Value</span>
                                <span class="meta-value">$1,800,000</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Meeting</span>
                                <span class="meta-value">Dec 13, 2025</span>
                            </div>
                        </div>
                            <div style="display: flex; gap: var(--spacing-sm);">
                            <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); openCase('CPC-2025-0041')">
                                <i class="pi pi-eye"></i> View Case
                            </button>
                        </div>
                    </div>

                        <!-- Case Card 3 - CPC Associate Role -->
                        <div class="my-case-card" data-role="associate" data-status="pending" onclick="openCase('CPC-2025-0038')">
                        <div class="case-header">
                                <div>
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: 4px;">
                                        <span class="case-id" style="margin-bottom: 0;">CPC-2025-0038</span>
                                        <span class="role-badge associate">üìã CPC Associate</span>
                            </div>
                                    <div class="case-title" style="font-size: 16px;">Construction Materials</div>
                        </div>
                                <span class="status-badge pending">Preliminary Review</span>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--spacing-sm); margin-bottom: var(--spacing-md); padding-bottom: var(--spacing-md); border-bottom: 1px solid var(--surface-200);">
                            <div class="meta-item">
                                <span class="meta-label">Tender Ref</span>
                                    <span class="meta-value">ITB/2024/019</span>
                            </div>
                            <div class="meta-item">
                                    <span class="meta-label">Value</span>
                                    <span class="meta-value">$5,100,000</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-label">Due</span>
                                    <span class="meta-value" style="color: var(--warning-500);">Dec 16, 2025</span>
                                </div>
                            </div>
                            <div style="display: flex; gap: var(--spacing-sm);">
                                <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); openCase('CPC-2025-0038')">
                                    <i class="pi pi-eye"></i> View Case
                                </button>
                            </div>
                        </div>

                        <!-- Case Card 4 - Expert Role -->
                        <div class="my-case-card" data-role="expert" data-status="pending" onclick="openCase('CPC-2025-0039')">
                            <div class="case-header">
                                <div>
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: 4px;">
                                        <span class="case-id" style="margin-bottom: 0;">CPC-2025-0039</span>
                                        <span class="role-badge expert">üéì Expert</span>
                                    </div>
                                    <div class="case-title" style="font-size: 16px;">Office Equipment Supply</div>
                                </div>
                                <span class="status-badge review">Expert Input Needed</span>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--spacing-sm); margin-bottom: var(--spacing-md); padding-bottom: var(--spacing-md); border-bottom: 1px solid var(--surface-200);">
                                <div class="meta-item">
                                    <span class="meta-label">Tender Ref</span>
                                    <span class="meta-value">RFQ/2024/156</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-label">Value</span>
                                    <span class="meta-value">$450,000</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-label">Expertise</span>
                                    <span class="meta-value">IT Hardware</span>
                                </div>
                            </div>
                            <div style="display: flex; gap: var(--spacing-sm);">
                                <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); openCase('CPC-2025-0039')">
                                    <i class="pi pi-eye"></i> View Case
                                </button>
                            </div>
                        </div>

                        <!-- Case Card 5 - CPC Chair Role (Voting) -->
                        <div class="my-case-card" data-role="chair" data-status="voting" onclick="openCase('CPC-2025-0037')">
                            <div class="case-header">
                                <div>
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: 4px;">
                                        <span class="case-id" style="margin-bottom: 0;">CPC-2025-0037</span>
                                        <span class="role-badge chair">üëë CPC Chair</span>
                                    </div>
                                    <div class="case-title" style="font-size: 16px;">Security Services Contract</div>
                                </div>
                                <span class="status-badge deliberation">Awaiting Vote</span>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--spacing-sm); margin-bottom: var(--spacing-md); padding-bottom: var(--spacing-md); border-bottom: 1px solid var(--surface-200);">
                                <div class="meta-item">
                                    <span class="meta-label">Tender Ref</span>
                                    <span class="meta-value">RFP/2024/078</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-label">Value</span>
                                    <span class="meta-value">$890,000</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-label">Votes</span>
                                    <span class="meta-value">2/4 Members</span>
                                </div>
                            </div>
                            <div style="display: flex; gap: var(--spacing-sm);">
                                <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); openCase('CPC-2025-0037')">
                                    <i class="pi pi-eye"></i> View Case
                                </button>
                            </div>
                        </div>

                        <!-- Case Card 6 - CPC Member Role (Approved) -->
                        <div class="my-case-card" data-role="member" data-status="approved" onclick="openCase('CPC-2025-0040')">
                            <div class="case-header">
                                <div>
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: 4px;">
                                        <span class="case-id" style="margin-bottom: 0;">CPC-2025-0040</span>
                                        <span class="role-badge member">üë§ CPC Member</span>
                                    </div>
                                    <div class="case-title" style="font-size: 16px;">Vehicle Fleet Procurement</div>
                                </div>
                                <span class="status-badge approved">PA Approved</span>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--spacing-sm); margin-bottom: var(--spacing-md); padding-bottom: var(--spacing-md); border-bottom: 1px solid var(--surface-200);">
                                <div class="meta-item">
                                    <span class="meta-label">Tender Ref</span>
                                    <span class="meta-value">ITB/2024/021</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Value</span>
                                <span class="meta-value">$3,200,000</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Approved</span>
                                <span class="meta-value" style="color: var(--success-500);">Dec 10, 2025</span>
                            </div>
                        </div>
                            <div style="display: flex; gap: var(--spacing-sm);">
                            <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); openCase('CPC-2025-0040')">
                                <i class="pi pi-eye"></i> View Case
                            </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ===== CASES VIEW ===== -->
            <div class="view-section" id="view-cases">
                <div class="page-header">
                    <h1 class="page-title">All CPC Cases</h1>
                    <p class="page-subtitle">Complete list of all cases submitted for CPC review</p>
                </div>

                <div class="tabs" id="casesViewTabs">
                    <div class="tab active" data-filter="all">All Cases (32)</div>
                    <div class="tab" data-filter="pending">Pending Review (8)</div>
                    <div class="tab" data-filter="qa">Q&A (4)</div>
                    <div class="tab" data-filter="deliberation">Deliberation (5)</div>
                    <div class="tab" data-filter="voting">Voting (3)</div>
                    <div class="tab" data-filter="approved">Approved (10)</div>
                    <div class="tab" data-filter="returned">Returned (2)</div>
                </div>

                <div class="filter-bar">
                    <div class="filter-group">
                        <span class="filter-label">Region:</span>
                        <select class="filter-select" id="casesRegionFilter">
                            <option value="all">All Regions</option>
                            <option value="europe">Europe & CIS</option>
                            <option value="africa">Africa</option>
                            <option value="asia">Asia Pacific</option>
                            <option value="americas">Americas</option>
                            <option value="hq">HQ</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <span class="filter-label">Type:</span>
                        <select class="filter-select" id="casesTypeFilter">
                            <option value="all">All Types</option>
                            <option value="formal">Formal</option>
                            <option value="exception">Exception</option>
                            <option value="lta">LTA</option>
                            <option value="preselection">Pre-selection</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <span class="filter-label">Value:</span>
                        <select class="filter-select" id="casesValueFilter">
                            <option value="all">All Values</option>
                            <option value="under250k">< $250,000</option>
                            <option value="250k-1m">$250,000 - $1M</option>
                            <option value="1m-5m">$1M - $5M</option>
                            <option value="over5m">> $5M</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <span class="filter-label">Sort:</span>
                        <select class="filter-select" id="casesSortFilter">
                            <option value="newest">Newest First</option>
                            <option value="oldest">Oldest First</option>
                            <option value="due">Due Date</option>
                            <option value="value-high">Value (High-Low)</option>
                            <option value="value-low">Value (Low-High)</option>
                        </select>
                    </div>
                    <div style="flex: 1;"></div>
                    <input type="text" placeholder="Search by case ID, tender ref, or title..." class="filter-select" style="width: 300px;" id="casesSearchInput">
                </div>

                <div class="card">
                    <table class="data-table" id="allCasesTable">
                        <thead>
                            <tr>
                                <th>Case ID</th>
                                <th>Tender Reference</th>
                                <th>Title</th>
                                <th>Region</th>
                                <th>Submitting Officer</th>
                                <th>Value</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Due/Submitted</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- NEW: Fresh case just arrived - no team, no deliberations, no meetings, no Q&A -->
                            <tr onclick="openCase('CPC-2025-0043')" style="cursor: pointer;" data-status="new">
                                <td><strong>CPC-2025-0043</strong> <span style="background: var(--primary-500); color: white; padding: 1px 6px; border-radius: 10px; font-size: 9px; font-weight: 600; margin-left: 4px;">NEW</span></td>
                                <td>ITB/2024/025</td>
                                <td>Agricultural Equipment Supply</td>
                                <td>Africa</td>
                                <td>Grace Okonkwo</td>
                                <td>$1,650,000</td>
                                <td>Formal</td>
                                <td><span class="status-badge" style="background: var(--info-100); color: var(--info-700);">Just Received</span></td>
                                <td style="color: var(--text-muted);">Today</td>
                                <td><button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); openCase('CPC-2025-0043')"><i class="pi pi-eye"></i> View</button></td>
                            </tr>
                            <tr onclick="openCase('CPC-2025-0042')" style="cursor: pointer;" data-status="pending">
                                <td><strong>CPC-2025-0042</strong></td>
                                <td>ITB/2024/023</td>
                                <td>Medical Supplies - Emergency Response</td>
                                <td>Europe & CIS</td>
                                <td>John Smith</td>
                                <td>$2,400,000</td>
                                <td>Formal</td>
                                <td><span class="status-badge pending">Pending Review</span></td>
                                <td style="color: var(--warning-500);">Dec 14, 2025</td>
                                <td><button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); openCase('CPC-2025-0042')"><i class="pi pi-eye"></i> View</button></td>
                            </tr>
                            <tr onclick="openCase('CPC-2025-0041')" style="cursor: pointer;" data-status="deliberation">
                                <td><strong>CPC-2025-0041</strong></td>
                                <td>RFP/2024/089</td>
                                <td>IT Infrastructure Upgrade</td>
                                <td>HQ</td>
                                <td>Sarah Chen</td>
                                <td>$1,800,000</td>
                                <td>Formal</td>
                                <td><span class="status-badge deliberation">Under Deliberation</span></td>
                                <td>Dec 13, 2025</td>
                                <td><button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); openCase('CPC-2025-0041')"><i class="pi pi-eye"></i> View</button></td>
                            </tr>
                            <tr onclick="openCase('CPC-2025-0040')" style="cursor: pointer;" data-status="approved">
                                <td><strong>CPC-2025-0040</strong></td>
                                <td>ITB/2024/021</td>
                                <td>Vehicle Fleet Procurement</td>
                                <td>Africa</td>
                                <td>Ahmed Hassan</td>
                                <td>$3,200,000</td>
                                <td>Formal</td>
                                <td><span class="status-badge approved">Approved</span></td>
                                <td style="color: var(--success-500);">Dec 10, 2025</td>
                                <td><button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); openCase('CPC-2025-0040')"><i class="pi pi-eye"></i> View</button></td>
                            </tr>
                            <tr onclick="openCase('CPC-2025-0039')" style="cursor: pointer;" data-status="qa">
                                <td><strong>CPC-2025-0039</strong></td>
                                <td>RFQ/2024/156</td>
                                <td>Office Equipment Supply</td>
                                <td>Asia Pacific</td>
                                <td>Li Wei</td>
                                <td>$450,000</td>
                                <td>Formal</td>
                                <td><span class="status-badge review">Q&A Pending</span></td>
                                <td>Dec 15, 2025</td>
                                <td><button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); openCase('CPC-2025-0039')"><i class="pi pi-eye"></i> View</button></td>
                            </tr>
                            <tr onclick="openCase('CPC-2025-0038')" style="cursor: pointer;" data-status="pending">
                                <td><strong>CPC-2025-0038</strong></td>
                                <td>ITB/2024/019</td>
                                <td>Construction Materials</td>
                                <td>Americas</td>
                                <td>Maria Lopez</td>
                                <td>$5,100,000</td>
                                <td>Formal</td>
                                <td><span class="status-badge pending">Pending Review</span></td>
                                <td style="color: var(--warning-500);">Dec 16, 2025</td>
                                <td><button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); openCase('CPC-2025-0038')"><i class="pi pi-eye"></i> View</button></td>
                            </tr>
                            <tr onclick="openCase('CPC-2025-0037')" style="cursor: pointer;" data-status="voting">
                                <td><strong>CPC-2025-0037</strong></td>
                                <td>RFP/2024/078</td>
                                <td>Security Services Contract</td>
                                <td>Europe & CIS</td>
                                <td>Peter Mueller</td>
                                <td>$890,000</td>
                                <td>LTA</td>
                                <td><span class="status-badge deliberation">Awaiting Vote</span></td>
                                <td>Dec 12, 2025</td>
                                <td><button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); openCase('CPC-2025-0037')"><i class="pi pi-eye"></i> View</button></td>
                            </tr>
                            <tr onclick="openCase('CPC-2025-0036')" style="cursor: pointer;" data-status="pending">
                                <td><strong>CPC-2025-0036</strong></td>
                                <td>ITB/2024/067</td>
                                <td>Consulting Services Framework</td>
                                <td>HQ</td>
                                <td>Anna Kowalski</td>
                                <td>$2,800,000</td>
                                <td>LTA</td>
                                <td><span class="status-badge pending">Pending Review</span></td>
                                <td style="color: var(--warning-500);">Dec 18, 2025</td>
                                <td><button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); openCase('CPC-2025-0036')"><i class="pi pi-eye"></i> View</button></td>
                            </tr>
                            <tr onclick="openCase('CPC-2025-0035')" style="cursor: pointer;" data-status="pending">
                                <td><strong>CPC-2025-0035</strong> <span style="background: var(--info-100); color: var(--info-700); padding: 1px 6px; border-radius: 10px; font-size: 9px; font-weight: 500;">Direct</span></td>
                                <td>RFQ/2024/201</td>
                                <td>Office Supplies Replenishment</td>
                                <td>Americas</td>
                                <td>Carlos Mendez</td>
                                <td>$125,000</td>
                                <td>Shopping</td>
                                <td><span class="status-badge pending">Pending Review</span></td>
                                <td>Dec 11, 2025</td>
                                <td><button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); openCase('CPC-2025-0035')"><i class="pi pi-eye"></i> View</button></td>
                            </tr>
                            <tr onclick="openCase('CPC-2025-0034')" style="cursor: pointer;" data-status="approved">
                                <td><strong>CPC-2025-0034</strong></td>
                                <td>ITB/2024/015</td>
                                <td>Water Treatment Plant</td>
                                <td>Asia Pacific</td>
                                <td>Yuki Tanaka</td>
                                <td>$4,500,000</td>
                                <td>Formal</td>
                                <td><span class="status-badge approved">PA Approved</span></td>
                                <td style="color: var(--success-500);">Dec 5, 2025</td>
                                <td><button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); openCase('CPC-2025-0034')">View</button></td>
                            </tr>
                            <tr onclick="openCase('CPC-2025-0033')" style="cursor: pointer;" data-status="approved">
                                <td><strong>CPC-2025-0033</strong></td>
                                <td>RFP/2024/056</td>
                                <td>Education Program Support</td>
                                <td>Americas</td>
                                <td>Carlos Mendez</td>
                                <td>$1,200,000</td>
                                <td>Formal</td>
                                <td><span class="status-badge approved">Approved</span></td>
                                <td style="color: var(--success-500);">Dec 3, 2025</td>
                                <td><button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); openCase('CPC-2025-0033')">View</button></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Pagination -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: var(--spacing-lg);">
                    <div style="font-size: 13px; color: var(--text-muted);">Showing 1-10 of 32 cases</div>
                    <div style="display: flex; gap: var(--spacing-xs);">
                        <button class="btn btn-secondary btn-sm" disabled><i class="pi pi-chevron-left"></i></button>
                        <button class="btn btn-primary btn-sm">1</button>
                        <button class="btn btn-secondary btn-sm">2</button>
                        <button class="btn btn-secondary btn-sm">3</button>
                        <button class="btn btn-secondary btn-sm">4</button>
                        <button class="btn btn-secondary btn-sm"><i class="pi pi-chevron-right"></i></button>
                    </div>
                </div>
            </div>

            <!-- ===== POOL MANAGEMENT VIEW ===== -->
            <div class="view-section" id="view-pool">
                <div class="page-header">
                    <h1 class="page-title">Pool Management</h1>
                    <p class="page-subtitle">Quarterly region assignments for CPC members</p>
                </div>

                <!-- Tabs for different views -->
                <div class="tabs" id="poolManagementTabs">
                    <div class="tab active" onclick="switchPoolTab('assignments')">Region Assignments</div>
                    <div class="tab" onclick="switchPoolTab('availability')">Member Availability</div>
                    <div class="tab" onclick="switchPoolTab('members')">All Members (18)</div>
                    <div class="tab" onclick="switchPoolTab('invitations')">Invitations</div>
                </div>

                <!-- TAB: Region Assignments -->
                <div id="pool-tab-assignments" class="pool-tab-content">
                    <!-- Quarter/Year Selector -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg); padding: var(--spacing-md); background: var(--surface-0); border: 1px solid var(--surface-200); border-radius: var(--radius-lg);">
                        <div style="display: flex; align-items: center; gap: var(--spacing-lg);">
                            <div>
                                <label style="font-size: 11px; color: var(--text-muted); text-transform: uppercase; display: block; margin-bottom: 4px;">Year</label>
                                <select class="filter-select" id="poolYear" onchange="updatePoolAssignments()">
                                    <option value="2025" selected>2025</option>
                                    <option value="2026">2026</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: var(--text-muted); text-transform: uppercase; display: block; margin-bottom: 4px;">Quarter</label>
                                <div style="display: flex; gap: 4px;">
                                    <button class="quarter-btn active" onclick="selectQuarter(1)">Q1</button>
                                    <button class="quarter-btn" onclick="selectQuarter(2)">Q2</button>
                                    <button class="quarter-btn" onclick="selectQuarter(3)">Q3</button>
                                    <button class="quarter-btn" onclick="selectQuarter(4)">Q4</button>
                                </div>
                            </div>
                            <div style="padding-left: var(--spacing-lg); border-left: 1px solid var(--surface-200);">
                                <div style="font-size: 11px; color: var(--text-muted); margin-bottom: 2px;">Status</div>
                                <span class="status-badge" style="background: var(--warning-100); color: var(--warning-700);">Draft - Pending Review</span>
                            </div>
                        </div>
                        <div style="display: flex; gap: var(--spacing-sm);">
                            <button class="btn btn-secondary" onclick="autoAssignRegions()"><i class="pi pi-sync"></i> Auto-Assign</button>
                            <button class="btn btn-primary" onclick="publishAssignments()"><i class="pi pi-send"></i> Publish & Send Invitations</button>
                        </div>
                    </div>

                    <!-- Assignment Rules Info -->
                    <div style="display: flex; gap: var(--spacing-sm); margin-bottom: var(--spacing-lg); flex-wrap: wrap;">
                        <div style="padding: 6px 12px; background: var(--info-50); border-radius: var(--radius-sm); font-size: 11px; color: var(--info-700);">
                            <i class="pi pi-info-circle"></i> No same region in consecutive quarters
                        </div>
                        <div style="padding: 6px 12px; background: var(--info-50); border-radius: var(--radius-sm); font-size: 11px; color: var(--info-700);">
                            <i class="pi pi-chart-bar"></i> Balanced by attendance %
                        </div>
                        <div style="padding: 6px 12px; background: var(--info-50); border-radius: var(--radius-sm); font-size: 11px; color: var(--info-700);">
                            <i class="pi pi-users"></i> Balanced by practice area
                        </div>
                        <div style="padding: 6px 12px; background: var(--info-50); border-radius: var(--radius-sm); font-size: 11px; color: var(--info-700);">
                            <i class="pi pi-map"></i> Member can cover multiple regions
                        </div>
                    </div>

                    <!-- Regions Grid -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: var(--spacing-md);">
                        <!-- Europe & CIS -->
                        <div class="region-card">
                            <div class="region-header">
                                <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                    <span style="font-size: 20px;">üá™üá∫</span>
                                    <div>
                                        <div style="font-weight: 600;">Europe & CIS</div>
                                        <div style="font-size: 11px; color: var(--text-muted);">4 members assigned</div>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-secondary" onclick="openRegionAssignmentModal('europe')"><i class="pi pi-plus"></i></button>
                            </div>
                            <div class="region-members">
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">MG</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Maria Garcia</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Chair ‚Ä¢ Procurement ‚Ä¢ 95% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--success-100); color: var(--success-700); font-size: 9px;">Confirmed</span>
                                </div>
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">JS</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">John Smith</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Member ‚Ä¢ ICA ‚Ä¢ 88% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--success-100); color: var(--success-700); font-size: 9px;">Confirmed</span>
                                </div>
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">AK</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Anna Kowalski</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Member ‚Ä¢ Finance ‚Ä¢ 92% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--warning-100); color: var(--warning-700); font-size: 9px;">Pending</span>
                                </div>
                                <div class="assigned-member" style="opacity: 0.6;">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px; background: var(--surface-200);">PM</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Peter Mueller</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Associate ‚Ä¢ Procurement</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--surface-100); color: var(--text-muted); font-size: 9px;">Invited</span>
                                </div>
                            </div>
                        </div>

                        <!-- Asia Pacific -->
                        <div class="region-card">
                            <div class="region-header">
                                <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                    <span style="font-size: 20px;">üåè</span>
                                    <div>
                                        <div style="font-weight: 600;">Asia Pacific</div>
                                        <div style="font-size: 11px; color: var(--text-muted);">3 members assigned</div>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-secondary" onclick="openRegionAssignmentModal('asia')"><i class="pi pi-plus"></i></button>
                            </div>
                            <div class="region-members">
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">DC</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">David Chen</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Chair ‚Ä¢ Procurement ‚Ä¢ 97% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--success-100); color: var(--success-700); font-size: 9px;">Confirmed</span>
                                </div>
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">LC</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Luis Chen</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Member ‚Ä¢ ICA ‚Ä¢ 85% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--success-100); color: var(--success-700); font-size: 9px;">Confirmed</span>
                                </div>
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">YT</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Yuki Tanaka</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Member ‚Ä¢ Finance ‚Ä¢ 90% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--warning-100); color: var(--warning-700); font-size: 9px;">Pending</span>
                                </div>
                            </div>
                        </div>

                        <!-- Africa -->
                        <div class="region-card">
                            <div class="region-header">
                                <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                    <span style="font-size: 20px;">üåç</span>
                                    <div>
                                        <div style="font-weight: 600;">Africa</div>
                                        <div style="font-size: 11px; color: var(--text-muted);">4 members assigned</div>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-secondary" onclick="openRegionAssignmentModal('africa')"><i class="pi pi-plus"></i></button>
                            </div>
                            <div class="region-members">
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">AH</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Ahmed Hassan</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Chair ‚Ä¢ Procurement ‚Ä¢ 93% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--success-100); color: var(--success-700); font-size: 9px;">Confirmed</span>
                                </div>
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">FK</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Fatima Khalil</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Member ‚Ä¢ ICA ‚Ä¢ 91% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--success-100); color: var(--success-700); font-size: 9px;">Confirmed</span>
                                </div>
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">KO</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Kofi Osei</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Member ‚Ä¢ Finance ‚Ä¢ 87% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--danger-100); color: var(--danger-700); font-size: 9px;">Declined</span>
                                </div>
                                <div class="assigned-member warning-highlight">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px; background: var(--warning-100); color: var(--warning-700);">!</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500; color: var(--warning-700);">Slot needs reassignment</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Member ‚Ä¢ Finance preferred</div>
                                    </div>
                                    <button class="btn btn-sm" style="background: var(--warning-100); border: 1px solid var(--warning-300); color: var(--warning-700);" onclick="openRegionAssignmentModal('africa')">Assign</button>
                                </div>
                            </div>
                        </div>

                        <!-- Americas -->
                        <div class="region-card">
                            <div class="region-header">
                                <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                    <span style="font-size: 20px;">üåé</span>
                                    <div>
                                        <div style="font-weight: 600;">Americas</div>
                                        <div style="font-size: 11px; color: var(--text-muted);">3 members assigned</div>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-secondary" onclick="openRegionAssignmentModal('americas')"><i class="pi pi-plus"></i></button>
                            </div>
                            <div class="region-members">
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">SJ</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Sarah Johnson</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Chair ‚Ä¢ Procurement ‚Ä¢ 94% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--success-100); color: var(--success-700); font-size: 9px;">Confirmed</span>
                                </div>
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">MR</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Miguel Rodriguez</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Member ‚Ä¢ ICA ‚Ä¢ 89% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--warning-100); color: var(--warning-700); font-size: 9px;">Pending</span>
                                </div>
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">CP</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Carlos Perez</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Member ‚Ä¢ Finance ‚Ä¢ 86% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--success-100); color: var(--success-700); font-size: 9px;">Confirmed</span>
                                </div>
                            </div>
                        </div>

                        <!-- Middle East -->
                        <div class="region-card">
                            <div class="region-header">
                                <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                    <span style="font-size: 20px;">üèúÔ∏è</span>
                                    <div>
                                        <div style="font-weight: 600;">Middle East</div>
                                        <div style="font-size: 11px; color: var(--text-muted);">3 members assigned</div>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-secondary" onclick="openRegionAssignmentModal('middleeast')"><i class="pi pi-plus"></i></button>
                            </div>
                            <div class="region-members">
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">NA</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Nadia Al-Rashid</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Chair ‚Ä¢ Procurement ‚Ä¢ 96% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--success-100); color: var(--success-700); font-size: 9px;">Confirmed</span>
                                </div>
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">OB</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Omar Bakri</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Member ‚Ä¢ ICA ‚Ä¢ 84% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--success-100); color: var(--success-700); font-size: 9px;">Confirmed</span>
                                </div>
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">LS</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Layla Said</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Member ‚Ä¢ Finance ‚Ä¢ 91% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--warning-100); color: var(--warning-700); font-size: 9px;">Pending</span>
                                </div>
                            </div>
                        </div>

                        <!-- HQ -->
                        <div class="region-card">
                            <div class="region-header">
                                <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                    <span style="font-size: 20px;">üè¢</span>
                                    <div>
                                        <div style="font-weight: 600;">HQ / Global</div>
                                        <div style="font-size: 11px; color: var(--text-muted);">2 members assigned</div>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-secondary" onclick="openRegionAssignmentModal('hq')"><i class="pi pi-plus"></i></button>
                            </div>
                            <div class="region-members">
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">EW</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Emma Wilson</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Chair ‚Ä¢ Procurement ‚Ä¢ 98% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--success-100); color: var(--success-700); font-size: 9px;">Confirmed</span>
                                </div>
                                <div class="assigned-member">
                                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">RK</div>
                                    <div style="flex: 1;">
                                        <div style="font-size: 12px; font-weight: 500;">Robert Kim</div>
                                        <div style="font-size: 10px; color: var(--text-muted);">Member ‚Ä¢ ICA ‚Ä¢ 92% att.</div>
                                    </div>
                                    <span class="status-badge" style="background: var(--success-100); color: var(--success-700); font-size: 9px;">Confirmed</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB: Member Availability -->
                <div id="pool-tab-availability" class="pool-tab-content" style="display: none;">
                    <div style="margin-bottom: var(--spacing-lg); padding: var(--spacing-md); background: var(--surface-0); border: 1px solid var(--surface-200); border-radius: var(--radius-lg);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Member Availability for 2025</div>
                                <div style="font-size: 12px; color: var(--text-muted);">Members indicate their availability for each quarter. Last updated: Dec 10, 2025</div>
                            </div>
                            <button class="btn btn-secondary" onclick="requestAvailabilityUpdate()"><i class="pi pi-envelope"></i> Request Updates</button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">Quarterly Availability Matrix</span>
                            <input type="text" placeholder="Search members..." class="filter-select" style="min-width: 200px;">
                        </div>
                        <div class="card-body" style="padding: 0; overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                                <thead>
                                    <tr style="background: var(--surface-50);">
                                        <th style="padding: 12px 16px; text-align: left; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Member</th>
                                        <th style="padding: 12px 16px; text-align: center; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Practice</th>
                                        <th style="padding: 12px 16px; text-align: center; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Attendance</th>
                                        <th style="padding: 12px 16px; text-align: center; font-weight: 600; border-bottom: 1px solid var(--surface-200); background: var(--primary-50);">Q1 2025</th>
                                        <th style="padding: 12px 16px; text-align: center; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Q2 2025</th>
                                        <th style="padding: 12px 16px; text-align: center; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Q3 2025</th>
                                        <th style="padding: 12px 16px; text-align: center; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Q4 2025</th>
                                        <th style="padding: 12px 16px; text-align: center; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="padding: 12px 16px; border-bottom: 1px solid var(--surface-100);">
                                            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                                <div class="member-avatar" style="width: 32px; height: 32px; font-size: 11px;">MG</div>
                                                <div>
                                                    <div style="font-weight: 500;">Maria Garcia</div>
                                                    <div style="font-size: 11px; color: var(--text-muted);">Chair</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="padding: 2px 8px; background: var(--primary-50); color: var(--primary-700); border-radius: var(--radius-sm); font-size: 11px;">Procurement</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);">95%</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100); background: var(--primary-50);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="color: var(--warning-600);">‚ö† Partial</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><button class="btn btn-sm btn-secondary">Edit</button></td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 16px; border-bottom: 1px solid var(--surface-100);">
                                            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                                <div class="member-avatar" style="width: 32px; height: 32px; font-size: 11px;">JS</div>
                                                <div>
                                                    <div style="font-weight: 500;">John Smith</div>
                                                    <div style="font-size: 11px; color: var(--text-muted);">Member</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="padding: 2px 8px; background: var(--info-50); color: var(--info-700); border-radius: var(--radius-sm); font-size: 11px;">ICA</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);">88%</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100); background: var(--primary-50);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="color: var(--danger-600);">‚úó Leave</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><button class="btn btn-sm btn-secondary">Edit</button></td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 16px; border-bottom: 1px solid var(--surface-100);">
                                            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                                <div class="member-avatar" style="width: 32px; height: 32px; font-size: 11px;">DC</div>
                                                <div>
                                                    <div style="font-weight: 500;">David Chen</div>
                                                    <div style="font-size: 11px; color: var(--text-muted);">Chair</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="padding: 2px 8px; background: var(--primary-50); color: var(--primary-700); border-radius: var(--radius-sm); font-size: 11px;">Procurement</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);">97%</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100); background: var(--primary-50);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><button class="btn btn-sm btn-secondary">Edit</button></td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 16px; border-bottom: 1px solid var(--surface-100);">
                                            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                                <div class="member-avatar" style="width: 32px; height: 32px; font-size: 11px;">AH</div>
                                                <div>
                                                    <div style="font-weight: 500;">Ahmed Hassan</div>
                                                    <div style="font-size: 11px; color: var(--text-muted);">Chair</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="padding: 2px 8px; background: var(--primary-50); color: var(--primary-700); border-radius: var(--radius-sm); font-size: 11px;">Procurement</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);">93%</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100); background: var(--primary-50);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="color: var(--success-600);">‚úì Available</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span style="color: var(--text-muted);">‚Äî Pending</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><button class="btn btn-sm btn-secondary">Edit</button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- TAB: All Members -->
                <div id="pool-tab-members" class="pool-tab-content" style="display: none;">
                <div style="display: flex; gap: var(--spacing-sm); margin-bottom: var(--spacing-lg);">
                    <button class="btn btn-primary"><i class="pi pi-plus"></i> Add Member</button>
                        <button class="btn btn-secondary"><i class="pi pi-upload"></i> Import</button>
                </div>

                <div class="card">
                    <div class="card-header">
                        <span class="card-title">CPC Panel Members</span>
                            <div style="display: flex; gap: var(--spacing-sm);">
                                <select class="filter-select">
                                    <option>All Roles</option>
                                    <option>Chairs</option>
                                    <option>Members</option>
                                    <option>Associates</option>
                                </select>
                                <select class="filter-select">
                                    <option>All Status</option>
                                    <option>Active</option>
                                    <option>On Leave</option>
                                    <option>Inactive</option>
                                </select>
                                <input type="text" placeholder="Search..." class="filter-select" style="min-width: 150px;">
                            </div>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <div class="pool-member">
                            <div class="member-avatar">MG</div>
                            <div class="member-info">
                                <div class="member-name">Maria Garcia</div>
                                    <div class="member-role">CPC Chair | Europe & CIS | Procurement</div>
                            </div>
                            <div class="member-stats">
                                    <div class="member-stat"><strong>95%</strong> Attendance</div>
                                <div class="member-stat">23 Reviews (YTD)</div>
                            </div>
                                <span class="status-badge success" style="margin-right: var(--spacing-sm);">Active</span>
                                <button class="btn btn-sm btn-secondary" onclick="openMemberModal('MG')">Manage</button>
                        </div>
                        <div class="pool-member">
                            <div class="member-avatar">JS</div>
                            <div class="member-info">
                                <div class="member-name">John Smith</div>
                                    <div class="member-role">CPC Member | Europe & CIS | ICA</div>
                            </div>
                            <div class="member-stats">
                                    <div class="member-stat"><strong>88%</strong> Attendance</div>
                                <div class="member-stat">18 Reviews (YTD)</div>
                            </div>
                                <span class="status-badge success" style="margin-right: var(--spacing-sm);">Active</span>
                                <button class="btn btn-sm btn-secondary" onclick="openMemberModal('JS')">Manage</button>
                        </div>
                        <div class="pool-member">
                            <div class="member-avatar">DC</div>
                            <div class="member-info">
                                <div class="member-name">David Chen</div>
                                    <div class="member-role">CPC Chair | Asia Pacific | Procurement</div>
                            </div>
                            <div class="member-stats">
                                    <div class="member-stat"><strong>97%</strong> Attendance</div>
                                <div class="member-stat">31 Reviews (YTD)</div>
                            </div>
                                <span class="status-badge success" style="margin-right: var(--spacing-sm);">Active</span>
                                <button class="btn btn-sm btn-secondary" onclick="openMemberModal('DC')">Manage</button>
                        </div>
                        <div class="pool-member">
                            <div class="member-avatar">SJ</div>
                            <div class="member-info">
                                <div class="member-name">Sarah Johnson</div>
                                    <div class="member-role">CPC Chair | Americas | Procurement</div>
                            </div>
                            <div class="member-stats">
                                    <div class="member-stat"><strong>94%</strong> Attendance</div>
                                <div class="member-stat">15 Reviews (YTD)</div>
                            </div>
                                <span class="status-badge success" style="margin-right: var(--spacing-sm);">Active</span>
                                <button class="btn btn-sm btn-secondary" onclick="openMemberModal('SJ')">Manage</button>
                        </div>
                        <div class="pool-member">
                            <div class="member-avatar">AH</div>
                            <div class="member-info">
                                <div class="member-name">Ahmed Hassan</div>
                                    <div class="member-role">CPC Chair | Africa | Procurement</div>
                            </div>
                            <div class="member-stats">
                                    <div class="member-stat"><strong>93%</strong> Attendance</div>
                                <div class="member-stat">27 Reviews (YTD)</div>
                            </div>
                                <span class="status-badge success" style="margin-right: var(--spacing-sm);">Active</span>
                                <button class="btn btn-sm btn-secondary" onclick="openMemberModal('AH')">Manage</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB: Invitations -->
                <div id="pool-tab-invitations" class="pool-tab-content" style="display: none;">
                    <div style="margin-bottom: var(--spacing-lg); padding: var(--spacing-md); background: var(--surface-0); border: 1px solid var(--surface-200); border-radius: var(--radius-lg);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; margin-bottom: 4px;">Q1 2025 - Region Assignment Invitations</div>
                                <div style="font-size: 12px; color: var(--text-muted);">Sent: Dec 10, 2025 ‚Ä¢ Response deadline: Dec 17, 2025</div>
                            </div>
                            <button class="btn btn-secondary" onclick="sendReminders()"><i class="pi pi-bell"></i> Send Reminders</button>
                        </div>
                    </div>

                    <!-- Summary Stats -->
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--spacing-md); margin-bottom: var(--spacing-lg);">
                        <div style="padding: var(--spacing-md); background: var(--surface-0); border: 1px solid var(--surface-200); border-radius: var(--radius-md); text-align: center;">
                            <div style="font-size: 28px; font-weight: 700; color: var(--primary-500);">18</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Total Invitations</div>
                        </div>
                        <div style="padding: var(--spacing-md); background: var(--surface-0); border: 1px solid var(--surface-200); border-radius: var(--radius-md); text-align: center;">
                            <div style="font-size: 28px; font-weight: 700; color: var(--success-500);">12</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Confirmed</div>
                        </div>
                        <div style="padding: var(--spacing-md); background: var(--surface-0); border: 1px solid var(--surface-200); border-radius: var(--radius-md); text-align: center;">
                            <div style="font-size: 28px; font-weight: 700; color: var(--warning-500);">5</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Pending Response</div>
                        </div>
                        <div style="padding: var(--spacing-md); background: var(--surface-0); border: 1px solid var(--surface-200); border-radius: var(--radius-md); text-align: center;">
                            <div style="font-size: 28px; font-weight: 700; color: var(--danger-500);">1</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Declined</div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">Invitation Status</span>
                            <select class="filter-select">
                                <option>All Status</option>
                                <option>Confirmed</option>
                                <option>Pending</option>
                                <option>Declined</option>
                            </select>
                        </div>
                        <div class="card-body" style="padding: 0;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                                <thead>
                                    <tr style="background: var(--surface-50);">
                                        <th style="padding: 12px 16px; text-align: left; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Member</th>
                                        <th style="padding: 12px 16px; text-align: left; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Assigned Region(s)</th>
                                        <th style="padding: 12px 16px; text-align: center; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Sent</th>
                                        <th style="padding: 12px 16px; text-align: center; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Status</th>
                                        <th style="padding: 12px 16px; text-align: center; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Response Date</th>
                                        <th style="padding: 12px 16px; text-align: center; font-weight: 600; border-bottom: 1px solid var(--surface-200);">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="padding: 12px 16px; border-bottom: 1px solid var(--surface-100);">
                                            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                                <div class="member-avatar" style="width: 32px; height: 32px; font-size: 11px;">MG</div>
                                                <div>
                                                    <div style="font-weight: 500;">Maria Garcia</div>
                                                    <div style="font-size: 11px; color: var(--text-muted);">Chair</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td style="padding: 12px 16px; border-bottom: 1px solid var(--surface-100);">Europe & CIS</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);">Dec 10</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span class="status-badge success">Confirmed</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);">Dec 10</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);">‚Äî</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 12px 16px; border-bottom: 1px solid var(--surface-100);">
                                            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                                <div class="member-avatar" style="width: 32px; height: 32px; font-size: 11px;">AK</div>
                                                <div>
                                                    <div style="font-weight: 500;">Anna Kowalski</div>
                                                    <div style="font-size: 11px; color: var(--text-muted);">Member</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td style="padding: 12px 16px; border-bottom: 1px solid var(--surface-100);">Europe & CIS</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);">Dec 10</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span class="status-badge review">Pending</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);">‚Äî</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><button class="btn btn-sm btn-secondary">Remind</button></td>
                                    </tr>
                                    <tr style="background: var(--danger-50);">
                                        <td style="padding: 12px 16px; border-bottom: 1px solid var(--surface-100);">
                                            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                                <div class="member-avatar" style="width: 32px; height: 32px; font-size: 11px;">KO</div>
                                                <div>
                                                    <div style="font-weight: 500;">Kofi Osei</div>
                                                    <div style="font-size: 11px; color: var(--text-muted);">Member</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td style="padding: 12px 16px; border-bottom: 1px solid var(--surface-100);">Africa</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);">Dec 10</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><span class="status-badge" style="background: var(--danger-100); color: var(--danger-700);">Declined</span></td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);">Dec 12</td>
                                        <td style="padding: 12px 16px; text-align: center; border-bottom: 1px solid var(--surface-100);"><button class="btn btn-sm btn-primary" onclick="openRegionAssignmentModal('africa')">Reassign</button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ===== MEETINGS VIEW ===== -->
            <div class="view-section" id="view-meetings">
                <div class="page-header">
                    <h1 class="page-title">CPC Meetings</h1>
                    <p class="page-subtitle">Schedule, manage and track CPC review meetings</p>
                </div>

                <!-- Actions Bar -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
                    <div style="display: flex; gap: var(--spacing-sm);">
                        <button class="btn btn-primary" onclick="openCreateMeetingModal()">
                            <i class="pi pi-plus"></i> New Meeting
                        </button>
                        <button class="btn btn-secondary" onclick="showToast('Calendar view coming soon', 'info')">
                            <i class="pi pi-calendar"></i> Calendar View
                        </button>
                    </div>
                    <div style="display: flex; gap: var(--spacing-sm);">
                        <select class="filter-select" id="meetingRegionFilter">
                            <option value="all">All Regions</option>
                            <option value="europe">Europe & CIS</option>
                            <option value="asia">Asia Pacific</option>
                            <option value="africa">Africa</option>
                            <option value="americas">Americas</option>
                            <option value="middleeast">Middle East</option>
                        </select>
                        <select class="filter-select" id="meetingPracticeFilter">
                            <option value="all">All Practices</option>
                            <option value="procurement">Procurement</option>
                            <option value="ica">ICA</option>
                            <option value="finance">Finance</option>
                        </select>
                    </div>
                </div>

                <!-- Meeting Tabs -->
                <div class="tabs" style="margin-bottom: var(--spacing-lg);">
                    <div class="tab active" onclick="switchMeetingTab('upcoming')">Upcoming (3)</div>
                    <div class="tab" onclick="switchMeetingTab('past')">Past Meetings (12)</div>
                    <div class="tab" onclick="switchMeetingTab('draft')">Drafts (1)</div>
                </div>

                <!-- Upcoming Meetings Tab -->
                <div id="meetings-tab-upcoming" class="meetings-tab-content">
                    <div class="card">
                        <div class="card-body" style="padding: 0;">
                            <!-- Meeting 1 -->
                            <div class="meeting-item" onclick="openMeetingDetail('MTG-2025-001')" style="display: flex; gap: var(--spacing-lg); padding: var(--spacing-lg); border-bottom: 1px solid var(--surface-100); cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='var(--surface-50)'" onmouseout="this.style.background='transparent'">
                                <div style="min-width: 70px; text-align: center; padding: var(--spacing-sm); background: var(--primary-50); border-radius: var(--radius-md);">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--primary-600);">16</div>
                                    <div style="font-size: 11px; color: var(--primary-500); text-transform: uppercase; font-weight: 600;">Dec</div>
                                    <div style="font-size: 10px; color: var(--text-muted);">10:00</div>
                                </div>
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                                        <span style="font-weight: 600; font-size: 15px;">Europe & CIS Regional Review</span>
                                        <span class="status-badge success" style="font-size: 10px;">Confirmed</span>
                                    </div>
                                    <div style="display: flex; gap: var(--spacing-lg); font-size: 12px; color: var(--text-muted); margin-bottom: var(--spacing-sm);">
                                        <span>üåç Europe & CIS</span>
                                        <span>üìã Procurement</span>
                                        <span>üìç MS Teams</span>
                                    </div>
                                    <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap; margin-bottom: var(--spacing-sm);">
                                        <span style="padding: 2px 8px; background: var(--primary-50); color: var(--primary-700); border-radius: var(--radius-sm); font-size: 11px;">CPC-2025-0042</span>
                                        <span style="padding: 2px 8px; background: var(--primary-50); color: var(--primary-700); border-radius: var(--radius-sm); font-size: 11px;">CPC-2025-0041</span>
                                        <span style="padding: 2px 8px; background: var(--surface-100); color: var(--text-muted); border-radius: var(--radius-sm); font-size: 11px;">+1 more</span>
                                    </div>
                                    <div style="display: flex; gap: var(--spacing-xs); align-items: center;">
                                        <div class="member-avatar" style="width: 22px; height: 22px; font-size: 8px;">MG</div>
                                        <div class="member-avatar" style="width: 22px; height: 22px; font-size: 8px;">JS</div>
                                        <div class="member-avatar" style="width: 22px; height: 22px; font-size: 8px;">AK</div>
                                        <span style="font-size: 11px; color: var(--text-muted); margin-left: 4px;">4 attendees (3 confirmed)</span>
                                    </div>
                                </div>
                                <div style="display: flex; flex-direction: column; gap: var(--spacing-xs);">
                                    <button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); editMeeting('MTG-2025-001')" title="Edit"><i class="pi pi-pencil"></i></button>
                                    <button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); sendMeetingReminder('MTG-2025-001')" title="Send Reminder"><i class="pi pi-bell"></i></button>
                                </div>
                            </div>

                            <!-- Meeting 2 -->
                            <div class="meeting-item" onclick="openMeetingDetail('MTG-2025-002')" style="display: flex; gap: var(--spacing-lg); padding: var(--spacing-lg); border-bottom: 1px solid var(--surface-100); cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='var(--surface-50)'" onmouseout="this.style.background='transparent'">
                                <div style="min-width: 70px; text-align: center; padding: var(--spacing-sm); background: var(--warning-50); border-radius: var(--radius-md);">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--warning-600);">18</div>
                                    <div style="font-size: 11px; color: var(--warning-500); text-transform: uppercase; font-weight: 600;">Dec</div>
                                    <div style="font-size: 10px; color: var(--text-muted);">14:00</div>
                                </div>
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                                        <span style="font-weight: 600; font-size: 15px;">Asia Pacific Regional Review</span>
                                        <span class="status-badge warning" style="font-size: 10px;">2 Pending RSVPs</span>
                                    </div>
                                    <div style="display: flex; gap: var(--spacing-lg); font-size: 12px; color: var(--text-muted); margin-bottom: var(--spacing-sm);">
                                        <span>üåè Asia Pacific</span>
                                        <span>üìã ICA</span>
                                        <span>üìç Zoom</span>
                                    </div>
                                    <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap; margin-bottom: var(--spacing-sm);">
                                        <span style="padding: 2px 8px; background: var(--primary-50); color: var(--primary-700); border-radius: var(--radius-sm); font-size: 11px;">CPC-2025-0039</span>
                                        <span style="padding: 2px 8px; background: var(--primary-50); color: var(--primary-700); border-radius: var(--radius-sm); font-size: 11px;">CPC-2025-0038</span>
                                    </div>
                                    <div style="display: flex; gap: var(--spacing-xs); align-items: center;">
                                        <div class="member-avatar" style="width: 22px; height: 22px; font-size: 8px;">DC</div>
                                        <div class="member-avatar" style="width: 22px; height: 22px; font-size: 8px;">LC</div>
                                        <div class="member-avatar" style="width: 22px; height: 22px; font-size: 8px;">YT</div>
                                        <span style="font-size: 11px; color: var(--text-muted); margin-left: 4px;">3 attendees (1 confirmed)</span>
                                    </div>
                                </div>
                                <div style="display: flex; flex-direction: column; gap: var(--spacing-xs);">
                                    <button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); editMeeting('MTG-2025-002')" title="Edit"><i class="pi pi-pencil"></i></button>
                                    <button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); sendMeetingReminder('MTG-2025-002')" title="Send Reminder"><i class="pi pi-bell"></i></button>
                                </div>
                            </div>

                            <!-- Meeting 3 -->
                            <div class="meeting-item" onclick="openMeetingDetail('MTG-2025-003')" style="display: flex; gap: var(--spacing-lg); padding: var(--spacing-lg); cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='var(--surface-50)'" onmouseout="this.style.background='transparent'">
                                <div style="min-width: 70px; text-align: center; padding: var(--spacing-sm); background: var(--surface-100); border-radius: var(--radius-md);">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--text-secondary);">20</div>
                                    <div style="font-size: 11px; color: var(--text-muted); text-transform: uppercase; font-weight: 600;">Dec</div>
                                    <div style="font-size: 10px; color: var(--text-muted);">09:00</div>
                                </div>
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                                        <span style="font-weight: 600; font-size: 15px;">Africa Regional Review</span>
                                        <span class="status-badge" style="font-size: 10px; background: var(--surface-200);">Invitations Sent</span>
                                    </div>
                                    <div style="display: flex; gap: var(--spacing-lg); font-size: 12px; color: var(--text-muted); margin-bottom: var(--spacing-sm);">
                                        <span>üåç Africa</span>
                                        <span>üìã Finance</span>
                                        <span>üìç Hybrid</span>
                                    </div>
                                    <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap; margin-bottom: var(--spacing-sm);">
                                        <span style="padding: 2px 8px; background: var(--primary-50); color: var(--primary-700); border-radius: var(--radius-sm); font-size: 11px;">CPC-2025-0040</span>
                                    </div>
                                    <div style="display: flex; gap: var(--spacing-xs); align-items: center;">
                                        <div class="member-avatar" style="width: 22px; height: 22px; font-size: 8px;">AH</div>
                                        <div class="member-avatar" style="width: 22px; height: 22px; font-size: 8px;">FK</div>
                                        <span style="font-size: 11px; color: var(--text-muted); margin-left: 4px;">3 attendees (0 confirmed)</span>
                                    </div>
                                </div>
                                <div style="display: flex; flex-direction: column; gap: var(--spacing-xs);">
                                    <button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); editMeeting('MTG-2025-003')" title="Edit"><i class="pi pi-pencil"></i></button>
                                    <button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); sendMeetingReminder('MTG-2025-003')" title="Send Reminder"><i class="pi pi-bell"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Past Meetings Tab -->
                <div id="meetings-tab-past" class="meetings-tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-body" style="padding: 0;">
                            <div class="meeting-item" onclick="openMeetingDetail('MTG-2024-098')" style="display: flex; gap: var(--spacing-lg); padding: var(--spacing-lg); border-bottom: 1px solid var(--surface-100); cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='var(--surface-50)'" onmouseout="this.style.background='transparent'">
                                <div style="min-width: 70px; text-align: center; padding: var(--spacing-sm); background: var(--surface-100); border-radius: var(--radius-md);">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--text-muted);">10</div>
                                    <div style="font-size: 11px; color: var(--text-muted); text-transform: uppercase; font-weight: 600;">Dec</div>
                                </div>
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                                        <span style="font-weight: 600; font-size: 15px;">Europe & CIS Regional Review</span>
                                        <span class="status-badge" style="font-size: 10px; background: var(--surface-200);">Completed</span>
                                        <span style="padding: 2px 8px; background: var(--success-50); color: var(--success-700); border-radius: var(--radius-sm); font-size: 10px;">‚úì Minutes</span>
                                    </div>
                                    <div style="display: flex; gap: var(--spacing-lg); font-size: 12px; color: var(--text-muted);">
                                        <span>üåç Europe & CIS</span>
                                        <span>üìã Procurement</span>
                                        <span>üë• 4/4 attended</span>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); viewMeetingMinutes('MTG-2024-098')"><i class="pi pi-file"></i> Minutes</button>
                            </div>
                            <div class="meeting-item" onclick="openMeetingDetail('MTG-2024-097')" style="display: flex; gap: var(--spacing-lg); padding: var(--spacing-lg); cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='var(--surface-50)'" onmouseout="this.style.background='transparent'">
                                <div style="min-width: 70px; text-align: center; padding: var(--spacing-sm); background: var(--surface-100); border-radius: var(--radius-md);">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--text-muted);">05</div>
                                    <div style="font-size: 11px; color: var(--text-muted); text-transform: uppercase; font-weight: 600;">Dec</div>
                                </div>
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                                        <span style="font-weight: 600; font-size: 15px;">Americas Regional Review</span>
                                        <span class="status-badge" style="font-size: 10px; background: var(--surface-200);">Completed</span>
                                        <span style="padding: 2px 8px; background: var(--success-50); color: var(--success-700); border-radius: var(--radius-sm); font-size: 10px;">‚úì Minutes</span>
                                    </div>
                                    <div style="display: flex; gap: var(--spacing-lg); font-size: 12px; color: var(--text-muted);">
                                        <span>üåé Americas</span>
                                        <span>üìã ICA</span>
                                        <span>üë• 3/3 attended</span>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); viewMeetingMinutes('MTG-2024-097')"><i class="pi pi-file"></i> Minutes</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Draft Meetings Tab -->
                <div id="meetings-tab-draft" class="meetings-tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-body" style="padding: 0;">
                            <div class="meeting-item" onclick="editMeeting('MTG-DRAFT-001')" style="display: flex; gap: var(--spacing-lg); padding: var(--spacing-lg); cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='var(--surface-50)'" onmouseout="this.style.background='transparent'">
                                <div style="min-width: 70px; text-align: center; padding: var(--spacing-sm); background: var(--warning-50); border-radius: var(--radius-md);">
                                    <div style="font-size: 20px; font-weight: 700; color: var(--warning-600);">TBD</div>
                                    <div style="font-size: 10px; color: var(--text-muted);">Not set</div>
                                </div>
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                                        <span style="font-weight: 600; font-size: 15px;">Middle East Regional Review</span>
                                        <span class="status-badge warning" style="font-size: 10px;">Draft</span>
                                    </div>
                                    <div style="font-size: 12px; color: var(--warning-600);">
                                        <i class="pi pi-info-circle"></i> Missing: Date, time, attendees
                                    </div>
                                </div>
                                <div style="display: flex; gap: var(--spacing-xs);">
                                    <button class="btn btn-sm btn-primary" onclick="event.stopPropagation(); editMeeting('MTG-DRAFT-001')"><i class="pi pi-pencil"></i> Complete</button>
                                    <button class="btn btn-sm btn-secondary" onclick="event.stopPropagation(); deleteDraftMeeting('MTG-DRAFT-001')"><i class="pi pi-trash"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ===== Q&A VIEW ===== -->
            <div class="view-section" id="view-qa">
                <div class="page-header">
                    <h1 class="page-title">Q&A / Clarifications</h1>
                    <p class="page-subtitle">Questions and clarifications between CPC and submitting offices</p>
                </div>

                <div class="tabs">
                    <div class="tab active">Pending Response (2)</div>
                    <div class="tab">Awaiting CPC (3)</div>
                    <div class="tab">Resolved (28)</div>
                </div>

                <div class="qa-thread">
                    <div class="qa-thread-header">
                        <div>
                            <span class="qa-case-ref">CPC-2025-0042</span> - Medical Supplies - Emergency Response
                        </div>
                        <span class="status-badge pending">Awaiting Response</span>
                    </div>
                    <div class="qa-message">
                        <div class="qa-message-header">
                            <span class="qa-author cpc">Maria Garcia (CPC)</span>
                            <span class="qa-date">Dec 11, 2025 - 2:30 PM</span>
                        </div>
                        <div class="qa-content">
                            Please provide additional justification for the single-source selection of Supplier B for Lot 2. 
                            The evaluation report mentions "technical superiority" but doesn't provide specific comparison metrics 
                            against other bidders. Also, please clarify the delivery timeline assumptions used in the cost analysis.
                        </div>
                    </div>
                    <div class="qa-reply-box">
                        <textarea placeholder="Type your response..."></textarea>
                        <div style="display: flex; gap: var(--spacing-sm);">
                            <button class="btn btn-primary"><i class="pi pi-send"></i> Send Response</button>
                            <button class="btn btn-secondary"><i class="pi pi-paperclip"></i> Attach File</button>
                        </div>
                    </div>
                </div>

                <div class="qa-thread">
                    <div class="qa-thread-header">
                        <div>
                            <span class="qa-case-ref">CPC-2025-0039</span> - Office Equipment Supply
                        </div>
                        <span class="status-badge pending">Awaiting Response</span>
                    </div>
                    <div class="qa-message">
                        <div class="qa-message-header">
                            <span class="qa-author cpc">John Smith (CPC)</span>
                            <span class="qa-date">Dec 10, 2025 - 11:15 AM</span>
                        </div>
                        <div class="qa-content">
                            The price comparison shows a 15% variance from the market rate estimate. Please provide:
                            <ol style="margin: var(--spacing-sm) 0 0 var(--spacing-lg);">
                                <li>Updated market research to support the recommended pricing</li>
                                <li>Explanation of any bulk discount negotiations conducted</li>
                            </ol>
                        </div>
                    </div>
                    <div class="qa-message">
                        <div class="qa-message-header">
                            <span class="qa-author">Procurement Office (Submitter)</span>
                            <span class="qa-date">Dec 10, 2025 - 3:45 PM</span>
                        </div>
                        <div class="qa-content">
                            Thank you for your query. We are gathering the updated market research data and will respond 
                            within 24 hours with the requested documentation.
                        </div>
                    </div>
                    <div class="qa-reply-box">
                        <textarea placeholder="Type your response..."></textarea>
                        <div style="display: flex; gap: var(--spacing-sm);">
                            <button class="btn btn-primary"><i class="pi pi-send"></i> Send Response</button>
                            <button class="btn btn-secondary"><i class="pi pi-paperclip"></i> Attach File</button>
                        </div>
                    </div>
                </div>

                <div class="qa-thread" style="opacity: 0.7;">
                    <div class="qa-thread-header">
                        <div>
                            <span class="qa-case-ref">CPC-2025-0040</span> - Vehicle Fleet Procurement
                        </div>
                        <span class="status-badge approved">Resolved</span>
                    </div>
                    <div class="qa-message">
                        <div class="qa-message-header">
                            <span class="qa-author cpc">David Chen (CPC)</span>
                            <span class="qa-date">Dec 8, 2025 - 9:00 AM</span>
                        </div>
                        <div class="qa-content">
                            Please confirm the warranty terms negotiated with the selected supplier.
                        </div>
                    </div>
                    <div class="qa-message">
                        <div class="qa-message-header">
                            <span class="qa-author">Procurement Office (Submitter)</span>
                            <span class="qa-date">Dec 8, 2025 - 2:30 PM</span>
                        </div>
                        <div class="qa-content">
                            Confirmed. The warranty terms are: 3-year comprehensive warranty with 24/7 roadside assistance. 
                            Documentation attached.
                        </div>
                    </div>
                    <div class="qa-message">
                        <div class="qa-message-header">
                            <span class="qa-author cpc">David Chen (CPC)</span>
                            <span class="qa-date">Dec 8, 2025 - 4:00 PM</span>
                        </div>
                        <div class="qa-content">
                            Thank you for the clarification. Query resolved. ‚úì
                        </div>
                    </div>
                </div>
            </div>

            <!-- ===== CASE DETAIL VIEW ===== -->
            <div class="view-section" id="view-case-detail">
                <div style="margin-bottom: var(--spacing-lg);">
                    <button class="btn btn-secondary" onclick="showView('cases', document.getElementById('menu-cases'))">
                        <i class="pi pi-arrow-left"></i> Back to Cases
                    </button>
                </div>

                <!-- Case Header Banner -->
                <div style="background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%); border-radius: var(--radius-md); padding: var(--spacing-md) var(--spacing-lg); margin-bottom: var(--spacing-lg); color: white;">
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: var(--spacing-sm);">
                        <div>
                            <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: 4px;">
                                <h1 style="font-size: 20px; font-weight: 700; margin: 0;" id="case-detail-id">CPC-2025-0042</h1>
                                <span id="case-detail-status" style="padding: 4px 10px; background: rgba(251,191,36,0.3); border-radius: 12px; font-size: 11px; font-weight: 600;">Pending Review</span>
                                <span id="case-review-modality" style="padding: 3px 8px; background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.3); border-radius: 10px; font-size: 10px; font-weight: 500;">üë• Panel Review</span>
                            </div>
                            <p style="opacity: 0.9; font-size: 13px; margin: 0;" id="case-detail-title">Medical Supplies - Emergency Response</p>
                            <p style="font-size: 11px; opacity: 0.7; margin-top: 2px;" id="case-detail-meta">ITB/2024/023 | Europe & CIS | Submitted: Dec 10, 2025</p>
                        </div>
                        <div style="display: flex; gap: var(--spacing-xs);">
                            <button class="btn btn-secondary btn-sm"><i class="pi pi-file-pdf"></i> Download</button>
                            <button class="btn btn-sm" style="background: var(--success-500); color: white;"><i class="pi pi-check"></i> Submit</button>
                        </div>
                    </div>
                    <!-- Case Summary Bar -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: var(--spacing-lg); margin-top: var(--spacing-lg); padding-top: var(--spacing-lg); border-top: 1px solid rgba(255,255,255,0.2);">
                        <div>
                            <div style="font-size: 11px; opacity: 0.7;">Award Value</div>
                            <div style="font-weight: 600;">$362,400 USD</div>
                        </div>
                        <div>
                            <div style="font-size: 11px; opacity: 0.7;">Lots</div>
                            <div style="font-weight: 600;">2</div>
                        </div>
                        <div>
                            <div style="font-size: 11px; opacity: 0.7;">Submitting Office</div>
                            <div style="font-weight: 600;">Europe & CIS</div>
                        </div>
                        <div>
                            <div style="font-size: 11px; opacity: 0.7;">Submitting Officer</div>
                            <div style="font-weight: 600;">John Smith</div>
                        </div>
                        <div>
                            <div style="font-size: 11px; opacity: 0.7;">Review Due</div>
                            <div style="font-weight: 600; color: #fcd34d;">Dec 14, 2025</div>
                        </div>
                    </div>
                </div>

                <!-- Case Progress -->
                <div class="card" style="margin-bottom: var(--spacing-xl);">
                    <div class="card-body">
                        <h3 style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--spacing-lg);">Case Progress</h3>
                        <div class="case-progress">
                            <div class="progress-step">
                                <div class="progress-step-circle completed">‚úì</div>
                                <div class="progress-step-label completed">Submitted</div>
                            </div>
                            <div class="progress-step">
                                <div class="progress-step-circle completed">‚úì</div>
                                <div class="progress-step-label completed">Cleared</div>
                            </div>
                            <div class="progress-step">
                                <div class="progress-step-circle active">3</div>
                                <div class="progress-step-label active">CPC Review</div>
                            </div>
                            <div class="progress-step">
                                <div class="progress-step-circle pending">4</div>
                                <div class="progress-step-label">Voting</div>
                            </div>
                            <div class="progress-step">
                                <div class="progress-step-circle pending">5</div>
                                <div class="progress-step-label">PA Approval</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs" id="caseDetailTabs">
                    <div class="tab active" onclick="switchCaseTab('evaluation-report')">Evaluation Report</div>
                    <div class="tab" onclick="switchCaseTab('assessment')">Assessment & Voting</div>
                    <div class="tab" onclick="switchCaseTab('review-team')">Review Team</div>
                    <div class="tab" onclick="switchCaseTab('meeting')">Meeting</div>
                    <div class="tab" onclick="switchCaseTab('deliberations')">Deliberations (3)</div>
                    <div class="tab" onclick="switchCaseTab('qa')">Q&A (2)</div>
                    <div class="tab" onclick="switchCaseTab('history')">History</div>
                    <div class="tab" onclick="switchCaseTab('documents')">Documents (8)</div>
                </div>

                <!-- TAB: Evaluation Report -->
                <div id="tab-evaluation-report" class="tab-content">
                    <!-- Collapse/Expand All Button - Top -->
                    <div style="display: flex; justify-content: flex-end; margin-bottom: var(--spacing-md);">
                        <button class="btn btn-secondary btn-sm" onclick="toggleAllEvaluationSections()" id="evalToggleAllBtn">
                            <i class="pi pi-chevron-down" id="evalToggleIcon"></i>
                            <span id="evalToggleText">Expand All</span>
                        </button>
                    </div>

                    <!-- Section 1: Tender and Project Summary -->
                    <div class="collapsible-section">
                        <div class="collapsible-header" onclick="toggleSection('tender-summary')">
                            <span class="collapsible-title">1. Tender and Project Summary</span>
                            <i class="pi pi-chevron-down" id="icon-tender-summary"></i>
                        </div>
                        <div class="collapsible-content" id="content-tender-summary">
                            <h4 style="font-size: 14px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--spacing-md); padding-bottom: var(--spacing-sm); border-bottom: 2px solid var(--primary-100);">1.1 Project Summary</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--spacing-lg); margin-bottom: var(--spacing-xl);">
                                <div>
                                    <label style="font-size: 12px; color: var(--text-muted); display: block; margin-bottom: 4px;">Project Number(s)</label>
                                    <div style="font-weight: 600; color: var(--primary-500);">GEO-PRO-2024</div>
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: var(--text-muted); display: block; margin-bottom: 4px;">Project Name(s)</label>
                                    <div style="font-weight: 600;">Emergency Medical Response Initiative</div>
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: var(--text-muted); display: block; margin-bottom: 4px;">Project End Date</label>
                                    <div style="font-weight: 600;">30/06/2026</div>
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: var(--text-muted); display: block; margin-bottom: 4px;">Funding Source(s)</label>
                                    <div style="font-weight: 600;">European Union (EU), SIDA (20%)</div>
                                </div>
                            </div>

                            <!-- Funds Check -->
                            <div style="background: var(--success-50); border: 1px solid var(--success-200); border-radius: var(--radius-md); padding: var(--spacing-md); margin-bottom: var(--spacing-xl);">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                        <span style="color: var(--success-500); font-size: 18px;">‚úì</span>
                                        <span style="font-weight: 500; color: var(--text-primary);">Funds Check Status:</span>
                                    </div>
                                    <span style="font-weight: 700; color: var(--success-600);">$386,627.20 USD</span>
                                </div>
                                <p style="font-size: 11px; color: var(--text-muted); margin: 4px 0 0 28px;">Recommended Total Value (incl. 7% contingency)</p>
                            </div>

                            <h4 style="font-size: 14px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--spacing-md); padding-bottom: var(--spacing-sm); border-bottom: 2px solid var(--primary-100);">1.2 Tender Summary</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-lg);">
                            <div>
                                    <label style="font-size: 12px; color: var(--text-muted); display: block; margin-bottom: 4px;">Tender Reference</label>
                                    <div style="font-weight: 600; color: var(--primary-500);">ITB/2024/023</div>
                            </div>
                            <div>
                                    <label style="font-size: 12px; color: var(--text-muted); display: block; margin-bottom: 4px;">Business Unit</label>
                                    <div style="font-weight: 600;">Europe & CIS</div>
                            </div>
                            <div>
                                    <label style="font-size: 12px; color: var(--text-muted); display: block; margin-bottom: 4px;">Type of Requirement</label>
                                    <div style="font-weight: 600;">Goods</div>
                            </div>
                            <div>
                                    <label style="font-size: 12px; color: var(--text-muted); display: block; margin-bottom: 4px;">Incoterms</label>
                                    <div style="font-weight: 600;">FCA</div>
                            </div>
                            <div>
                                    <label style="font-size: 12px; color: var(--text-muted); display: block; margin-bottom: 4px;">Contract Vehicle</label>
                                    <div style="font-weight: 600;">PO/Contract</div>
                            </div>
                            <div>
                                    <label style="font-size: 12px; color: var(--text-muted); display: block; margin-bottom: 4px;">Expected Award Date</label>
                                    <div style="font-weight: 600;">15/05/2025</div>
                            </div>
                        </div>
                    </div>
                </div>

                    <!-- Section 2: Award Recommendation -->
                    <div class="collapsible-section">
                        <div class="collapsible-header" onclick="toggleSection('award-rec')">
                            <span class="collapsible-title">2. Award Recommendation</span>
                            <i class="pi pi-chevron-down" id="icon-award-rec"></i>
                    </div>
                        <div class="collapsible-content" id="content-award-rec">
                            <table class="eval-table" style="margin-bottom: var(--spacing-lg);">
                            <thead>
                                    <tr style="background: var(--primary-50);">
                                        <th>Vendor Information</th>
                                        <th>Lot Details & Timeline</th>
                                        <th style="text-align: right;">Summary Financials</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr style="border-bottom: 1px solid var(--surface-200);">
                                        <td style="vertical-align: top;">
                                            <div style="font-weight: 700; font-size: 14px;">MedSupply Ltd.</div>
                                            <div style="font-size: 11px; color: var(--text-muted);">UNGM: 309663</div>
                                            <div style="font-size: 11px; color: var(--text-muted);">üá©üá™ Germany</div>
                                        </td>
                                        <td style="vertical-align: top; background: var(--surface-50);">
                                            <div style="font-weight: 600; color: var(--primary-600); margin-bottom: 4px;">Lot 1: Personal Protective Equipment</div>
                                            <div style="font-size: 11px; display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--spacing-sm);">
                                                <div><span style="color: var(--text-muted);">Start:</span> 01/04/2025</div>
                                                <div><span style="color: var(--text-muted);">End:</span> 01/10/2026</div>
                                                <div><span style="color: var(--text-muted);">Duration:</span> 548 days</div>
                                            </div>
                                        </td>
                                        <td style="text-align: right; vertical-align: top;">
                                            <div style="font-weight: 700; font-size: 16px;">$118,500.00</div>
                                            <div style="font-size: 11px; color: var(--text-muted);">Contingency: $5,000.00</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="vertical-align: top;">
                                            <div style="font-weight: 700; font-size: 14px;">HealthCare Corp.</div>
                                            <div style="font-size: 11px; color: var(--text-muted);">UNGM: 301245</div>
                                            <div style="font-size: 11px; color: var(--text-muted);">üá∫üá∏ USA</div>
                                        </td>
                                        <td style="vertical-align: top; background: var(--surface-50);">
                                            <div style="font-weight: 600; color: var(--primary-600); margin-bottom: 4px;">Lot 2: Medical Diagnostic Equipment</div>
                                            <div style="font-size: 11px; display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--spacing-sm);">
                                                <div><span style="color: var(--text-muted);">Start:</span> 01/05/2025</div>
                                                <div><span style="color: var(--text-muted);">End:</span> 01/05/2026</div>
                                                <div><span style="color: var(--text-muted);">Duration:</span> 365 days</div>
                                            </div>
                                        </td>
                                        <td style="text-align: right; vertical-align: top;">
                                            <div style="font-weight: 700; font-size: 16px;">$228,900.00</div>
                                            <div style="font-size: 11px; color: var(--text-muted);">Contingency: $10,000.00</div>
                                        </td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr style="background: var(--primary-100);">
                                        <td colspan="2" style="text-align: right; font-weight: 700;">GRAND TOTAL (USD):</td>
                                        <td style="text-align: right; font-weight: 700; font-size: 18px; color: var(--success-600);">$362,400.00</td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>

                    <!-- Section 3: Competition Analysis -->
                    <div class="collapsible-section">
                        <div class="collapsible-header" onclick="toggleSection('competition')">
                            <span class="collapsible-title">3. Competition Analysis</span>
                            <i class="pi pi-chevron-down" id="icon-competition"></i>
                        </div>
                        <div class="collapsible-content" id="content-competition">
                            <div style="display: flex; align-items: center; gap: var(--spacing-md); margin-bottom: var(--spacing-lg);">
                                <span style="padding: 6px 14px; background: var(--success-100); color: var(--success-700); border-radius: 20px; font-size: 12px; font-weight: 600;">Open Competition</span>
                                <span style="font-size: 12px; color: var(--text-primary);">Solicitation Period: <strong>21 Days</strong></span>
                            </div>

                            <h4 style="font-size: 14px; font-weight: 600; margin-bottom: var(--spacing-md);">Invited Bidders (5)</h4>
                            <table class="eval-table" style="margin-bottom: var(--spacing-lg);">
                                <thead>
                                    <tr style="background: var(--surface-50);">
                                        <th>Company Name</th>
                                        <th>UNGM / Email</th>
                                        <th style="text-align: center;">Participated?</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>MedSupply Ltd.</td><td>309663</td><td style="text-align: center; color: var(--success-500);">‚úî</td></tr>
                                    <tr><td>HealthCare Corp.</td><td>301245</td><td style="text-align: center; color: var(--success-500);">‚úî</td></tr>
                                    <tr><td>MedTech Inc.</td><td>315789</td><td style="text-align: center; color: var(--success-500);">‚úî</td></tr>
                                    <tr><td>Global Medical Supplies</td><td>998877</td><td style="text-align: center; color: var(--text-muted);">-</td></tr>
                                    <tr><td>PharmaCare Solutions</td><td>info@pharmacare.com</td><td style="text-align: center; color: var(--text-muted);">-</td></tr>
                                </tbody>
                            </table>

                            <h4 style="font-size: 14px; font-weight: 600; margin-bottom: var(--spacing-md);">Lot Bids Summary</h4>
                            <table class="eval-table">
                                <thead>
                                    <tr style="background: var(--purple-50);">
                                        <th>Lot # & Name</th>
                                        <th style="text-align: center;">Bids Received</th>
                                        <th style="text-align: center;">Tech. Compliant Bids</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                        <td style="font-weight: 600;">1 - Personal Protective Equipment</td>
                                        <td style="text-align: center;">6</td>
                                        <td style="text-align: center;">4</td>
                                </tr>
                                <tr>
                                        <td style="font-weight: 600;">2 - Medical Diagnostic Equipment</td>
                                        <td style="text-align: center;">5</td>
                                        <td style="text-align: center;">3</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Section 4: Detailed Evaluation Results -->
                    <div class="collapsible-section">
                        <div class="collapsible-header" onclick="toggleSection('evaluation')">
                            <span class="collapsible-title">4. Detailed Evaluation Results</span>
                            <i class="pi pi-chevron-down" id="icon-evaluation"></i>
                        </div>
                        <div class="collapsible-content" id="content-evaluation">
                            <!-- Lot 1 -->
                            <div style="border: 2px solid var(--surface-200); border-radius: var(--radius-md); margin-bottom: var(--spacing-md); overflow: hidden;">
                                <div style="background: var(--primary-50); padding: var(--spacing-sm) var(--spacing-md); display: flex; justify-content: space-between; align-items: center;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                        <span style="font-weight: 700;">üì¶ Lot 1: Personal Protective Equipment</span>
                                        <span style="padding: 2px 8px; background: var(--info-100); color: var(--info-700); border-radius: 4px; font-size: 10px; font-weight: 600;">LOWEST PRICED</span>
                                    </div>
                                    <span style="font-size: 11px; color: var(--text-muted);">3 Bidders</span>
                                </div>
                                <div style="padding: var(--spacing-sm); overflow-x: auto;">
                                    <table class="eval-table" style="font-size: 11px; margin: 0;">
                                        <thead>
                                            <tr style="background: var(--surface-100);">
                                                <th>Vendor</th>
                                                <th>Country</th>
                                                <th style="text-align: center;">Rank</th>
                                                <th style="text-align: right;">Bid Amount</th>
                                                <th style="text-align: center;">Prelim</th>
                                                <th style="text-align: center;">Technical</th>
                                                <th style="text-align: center;">Selected</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr style="background: var(--success-50); border-left: 3px solid var(--success-500);">
                                                <td style="font-weight: 700;">MedSupply Ltd.</td>
                                                <td>üá©üá™ Germany</td>
                                                <td style="text-align: center;"><span style="background: var(--success-100); color: var(--success-700); padding: 2px 8px; border-radius: 10px; font-weight: 700;">1</span></td>
                                                <td style="text-align: right; font-weight: 700;">$118,500</td>
                                                <td style="text-align: center;"><span style="background: var(--success-100); color: var(--success-700); padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 600;">PASS</span></td>
                                                <td style="text-align: center;"><span style="background: var(--success-100); color: var(--success-700); padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 600;">PASS</span></td>
                                                <td style="text-align: center;"><span style="background: var(--success-500); color: white; padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: 700;">‚úì AWARDED</span></td>
                                </tr>
                                <tr>
                                                <td>HealthCare Corp.</td>
                                                <td>üá∫üá∏ USA</td>
                                                <td style="text-align: center;"><span style="background: var(--surface-200); padding: 2px 8px; border-radius: 10px;">2</span></td>
                                                <td style="text-align: right;">$125,200</td>
                                                <td style="text-align: center;"><span style="background: var(--success-100); color: var(--success-700); padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 600;">PASS</span></td>
                                                <td style="text-align: center;"><span style="background: var(--success-100); color: var(--success-700); padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 600;">PASS</span></td>
                                                <td style="text-align: center; color: var(--text-muted);">-</td>
                                            </tr>
                                            <tr style="background: var(--danger-50);">
                                                <td>MedTech Inc.</td>
                                                <td>üáØüáµ Japan</td>
                                                <td style="text-align: center;"><span style="background: var(--surface-200); padding: 2px 8px; border-radius: 10px;">3</span></td>
                                                <td style="text-align: right;">$132,800</td>
                                                <td style="text-align: center;"><span style="background: var(--success-100); color: var(--success-700); padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 600;">PASS</span></td>
                                                <td style="text-align: center;"><span style="background: var(--danger-100); color: var(--danger-700); padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 600;">FAIL</span></td>
                                                <td style="text-align: center; color: var(--text-muted);">-</td>
                                </tr>
                            </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Lot 2 -->
                            <div style="border: 2px solid var(--surface-200); border-radius: var(--radius-md); overflow: hidden;">
                                <div style="background: var(--purple-50); padding: var(--spacing-sm) var(--spacing-md); display: flex; justify-content: space-between; align-items: center;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                        <span style="font-weight: 700;">üì¶ Lot 2: Medical Diagnostic Equipment</span>
                                        <span style="padding: 2px 8px; background: var(--purple-100); color: var(--purple-700); border-radius: 4px; font-size: 10px; font-weight: 600;">WEIGHTED CRITERIA</span>
                                    </div>
                                    <span style="font-size: 11px; color: var(--text-muted);">Tech 70% / Price 30%</span>
                                </div>
                                <div style="padding: var(--spacing-sm); overflow-x: auto;">
                                    <table class="eval-table" style="font-size: 11px; margin: 0;">
                                        <thead>
                                            <tr style="background: var(--surface-100);">
                                                <th>Vendor</th>
                                                <th>Country</th>
                                                <th style="text-align: center;">Tech Score</th>
                                                <th style="text-align: center;">Price Score</th>
                                                <th style="text-align: center; background: var(--warning-100);">Combined</th>
                                                <th style="text-align: center;">Rank</th>
                                                <th style="text-align: right;">Final Price</th>
                                                <th style="text-align: center;">Selected</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr style="background: var(--success-50); border-left: 3px solid var(--success-500);">
                                                <td style="font-weight: 700;">HealthCare Corp.</td>
                                                <td>üá∫üá∏ USA</td>
                                                <td style="text-align: center;"><span style="background: var(--success-100); color: var(--success-700); padding: 2px 6px; border-radius: 4px; font-weight: 600;">92/100</span></td>
                                                <td style="text-align: center;"><span style="background: var(--info-100); color: var(--info-700); padding: 2px 6px; border-radius: 4px; font-weight: 600;">88/100</span></td>
                                                <td style="text-align: center; background: var(--warning-50);"><span style="background: var(--success-500); color: white; padding: 2px 8px; border-radius: 4px; font-weight: 700;">90.8</span></td>
                                                <td style="text-align: center;"><span style="background: var(--success-100); color: var(--success-700); padding: 2px 8px; border-radius: 10px; font-weight: 700;">1</span></td>
                                                <td style="text-align: right; font-weight: 700;">$228,900</td>
                                                <td style="text-align: center;"><span style="background: var(--success-500); color: white; padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: 700;">‚úì AWARDED</span></td>
                                            </tr>
                                            <tr>
                                                <td>MedSupply Ltd.</td>
                                                <td>üá©üá™ Germany</td>
                                                <td style="text-align: center;"><span style="background: var(--info-100); color: var(--info-700); padding: 2px 6px; border-radius: 4px; font-weight: 600;">85/100</span></td>
                                                <td style="text-align: center;"><span style="background: var(--success-100); color: var(--success-700); padding: 2px 6px; border-radius: 4px; font-weight: 600;">95/100</span></td>
                                                <td style="text-align: center; background: var(--warning-50);"><span style="background: var(--surface-300); padding: 2px 8px; border-radius: 4px; font-weight: 700;">88.0</span></td>
                                                <td style="text-align: center;"><span style="background: var(--surface-200); padding: 2px 8px; border-radius: 10px;">2</span></td>
                                                <td style="text-align: right;">$215,400</td>
                                                <td style="text-align: center; color: var(--text-muted);">-</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section 5: Value for Money -->
                    <div class="collapsible-section">
                        <div class="collapsible-header" onclick="toggleSection('vfm')">
                            <span class="collapsible-title">5. Value for Money (VFM) Analysis</span>
                            <i class="pi pi-chevron-down" id="icon-vfm"></i>
                        </div>
                        <div class="collapsible-content" id="content-vfm">
                            <table class="eval-table">
                                <thead>
                                    <tr style="background: var(--warning-50);">
                                        <th>Lot#</th>
                                        <th>Company</th>
                                        <th style="text-align: center;">Lowest Price?</th>
                                        <th style="text-align: center;">Negotiation?</th>
                                        <th style="text-align: right;">Final Price (USD)</th>
                                        <th style="text-align: center;">Comparator Price</th>
                                        <th style="text-align: center;">Variance %</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>MedSupply Ltd.</td>
                                        <td style="text-align: center; color: var(--success-600); font-weight: 600;">Yes</td>
                                        <td style="text-align: center;">No</td>
                                        <td style="text-align: right;">$118,500.00</td>
                                        <td style="text-align: center;">HealthCare ($125,200)</td>
                                        <td style="text-align: center; color: var(--success-600);">-5.4%</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>HealthCare Corp.</td>
                                        <td style="text-align: center; color: var(--success-600); font-weight: 600;">Yes</td>
                                        <td style="text-align: center; color: var(--warning-600);">Yes</td>
                                        <td style="text-align: right;">$228,900.00</td>
                                        <td style="text-align: center;">Market ($245,000)</td>
                                        <td style="text-align: center; color: var(--success-600);">-6.6%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Section 6: Capacity & QA -->
                    <div class="collapsible-section">
                        <div class="collapsible-header" onclick="toggleSection('capacity')">
                            <span class="collapsible-title">6. Capacity & Quality Assurance</span>
                            <i class="pi pi-chevron-down" id="icon-capacity"></i>
                        </div>
                        <div class="collapsible-content" id="content-capacity">
                            <h4 style="font-size: 14px; font-weight: 600; margin-bottom: var(--spacing-md);">Background Checks Summary</h4>
                            <table class="eval-table" style="font-size: 11px;">
                                <thead>
                                <tr style="background: var(--surface-50);">
                                        <th>Vendor</th>
                                        <th>Awarded Lots</th>
                                        <th>Award Value</th>
                                        <th style="text-align: center;">UNGM Elig.</th>
                                        <th style="text-align: center;">Exists</th>
                                        <th style="text-align: center;">Claims Log</th>
                                        <th style="text-align: center;">DRIVE Risk</th>
                                </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="font-weight: 600;">MedSupply Ltd.</td>
                                        <td>Lot 1</td>
                                        <td>$118,500</td>
                                        <td style="text-align: center; color: var(--success-600); font-weight: 600;">‚úî ELIGIBLE</td>
                                        <td style="text-align: center; color: var(--success-500);">‚úî</td>
                                        <td style="text-align: center; color: var(--success-500);">‚úî</td>
                                        <td style="text-align: center; color: var(--success-500);">‚úî Low</td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 600;">HealthCare Corp.</td>
                                        <td>Lot 2</td>
                                        <td>$228,900</td>
                                        <td style="text-align: center; color: var(--success-600); font-weight: 600;">‚úî ELIGIBLE</td>
                                        <td style="text-align: center; color: var(--success-500);">‚úî</td>
                                        <td style="text-align: center; color: var(--success-500);">‚úî</td>
                                        <td style="text-align: center; color: var(--warning-600);">‚ö† Medium</td>
                                    </tr>
                                </tbody>
                        </table>
                    </div>
                </div>

                    <!-- Section 7: Evaluation Panel Sign-Off -->
                    <div class="collapsible-section">
                        <div class="collapsible-header" onclick="toggleSection('signoff')">
                            <span class="collapsible-title">7. Evaluation Panel Sign-Off</span>
                            <i class="pi pi-chevron-down" id="icon-signoff"></i>
                    </div>
                        <div class="collapsible-content" id="content-signoff">
                            <div style="background: var(--success-50); border: 1px solid var(--success-200); border-radius: var(--radius-md); padding: var(--spacing-md); margin-bottom: var(--spacing-lg);">
                                <p style="font-size: 12px; color: var(--success-700); margin: 0;"><i class="pi pi-check-circle"></i> <strong>All panel members have signed the Evaluation Report.</strong></p>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-lg);">
                                <div style="padding: var(--spacing-lg); border: 1px solid var(--success-200); border-radius: var(--radius-md); background: var(--success-50);">
                                    <p style="font-weight: 600; font-size: 14px; margin: 0 0 2px 0;">Procurement Official</p>
                                    <p style="font-size: 12px; color: var(--text-muted); margin: 0 0 var(--spacing-sm) 0;">John Smith</p>
                                    <p style="font-size: 10px; color: var(--success-600);">‚úî Signed: 05/03/2025 09:05</p>
                                </div>
                                <div style="padding: var(--spacing-lg); border: 1px solid var(--success-200); border-radius: var(--radius-md); background: var(--success-50);">
                                    <p style="font-weight: 600; font-size: 14px; margin: 0 0 2px 0;">Chair</p>
                                    <p style="font-size: 12px; color: var(--text-muted); margin: 0 0 var(--spacing-sm) 0;">Alice Johnson</p>
                                    <p style="font-size: 10px; color: var(--success-600);">‚úî Signed: 05/03/2025 10:30</p>
                                </div>
                                <div style="padding: var(--spacing-lg); border: 1px solid var(--success-200); border-radius: var(--radius-md); background: var(--success-50);">
                                    <p style="font-weight: 600; font-size: 14px; margin: 0 0 2px 0;">Evaluator</p>
                                    <p style="font-size: 12px; color: var(--text-muted); margin: 0 0 var(--spacing-sm) 0;">Jane Doe</p>
                                    <p style="font-size: 10px; color: var(--success-600);">‚úî Signed: 05/03/2025 11:15</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    </div>

                <!-- TAB: Assessment & Voting -->
                <div id="tab-assessment" class="tab-content" style="display: none;">
                    <!-- Collapse/Expand All Button - Top -->
                    <div style="display: flex; justify-content: flex-end; margin-bottom: var(--spacing-md);">
                        <button class="btn btn-secondary btn-sm" onclick="toggleAllAssessmentSections()" id="assessToggleAllBtn">
                            <i class="pi pi-chevron-down" id="assessToggleIcon"></i>
                            <span id="assessToggleText">Expand All</span>
                        </button>
                    </div>

                    <!-- Workflow Progress - Improved alignment -->
                    <div style="margin-bottom: var(--spacing-xl); padding: var(--spacing-lg); background: var(--surface-0); border: 1px solid var(--surface-200); border-radius: var(--radius-lg);">
                        <div style="display: flex; align-items: flex-start;">
                            <!-- Step 1 -->
                            <div style="flex: 1; text-align: center;">
                                <div id="progress-step-1" style="width: 36px; height: 36px; border-radius: 50%; background: var(--success-500); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; margin: 0 auto;">‚úì</div>
                                <div style="font-size: 12px; font-weight: 500; margin-top: 8px; color: var(--text-primary);">Associate</div>
                                <div style="font-size: 11px; color: var(--text-muted);">Recommendation</div>
                            </div>
                            <!-- Line 1 -->
                            <div style="flex: 0.5; padding-top: 18px;"><div id="progress-line-1" style="height: 3px; background: var(--success-500);"></div></div>
                            <!-- Step 2 -->
                            <div style="flex: 1; text-align: center;">
                                <div id="progress-step-2" style="width: 36px; height: 36px; border-radius: 50%; background: var(--primary-500); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; margin: 0 auto;">2</div>
                                <div style="font-size: 12px; font-weight: 500; margin-top: 8px; color: var(--text-primary);">Members</div>
                                <div style="font-size: 11px; color: var(--text-muted);">Voting</div>
                            </div>
                            <!-- Line 2 -->
                            <div style="flex: 0.5; padding-top: 18px;"><div id="progress-line-2" style="height: 3px; background: var(--surface-300);"></div></div>
                            <!-- Step 3 -->
                            <div style="flex: 1; text-align: center;">
                                <div id="progress-step-3" style="width: 36px; height: 36px; border-radius: 50%; background: var(--surface-300); color: var(--text-muted); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; margin: 0 auto;">3</div>
                                <div style="font-size: 12px; font-weight: 500; margin-top: 8px; color: var(--text-muted);">Chair</div>
                                <div style="font-size: 11px; color: var(--text-muted);">Quality Rating</div>
                            </div>
                        </div>
                    </div>

                    <!-- Section 1: CPC Associate Recommendation (UC-009) - Collapsible -->
                    <div class="card" style="margin-bottom: var(--spacing-md);" id="assessment-section-1">
                        <div class="card-header" style="cursor: pointer;" onclick="toggleAssessmentSection(1)">
                            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                <i class="pi pi-chevron-down" id="assessment-chevron-1" style="transition: transform 0.2s;"></i>
                                <span class="card-title">üìã CPC Associate Recommendation</span>
                            </div>
                            <span class="status-badge" id="associate-status-badge" style="background: var(--success-100); color: var(--success-700);">Completed</span>
                        </div>
                        <div class="card-body" id="assessment-content-1">
                            <div style="display: flex; align-items: center; gap: var(--spacing-md); margin-bottom: var(--spacing-lg); padding-bottom: var(--spacing-md); border-bottom: 1px solid var(--surface-200);">
                                <div class="member-avatar" style="width: 40px; height: 40px; font-size: 13px;">PM</div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; font-size: 14px;">Peter Mueller</div>
                                    <div style="font-size: 12px; color: var(--text-muted);">CPC Associate ‚Ä¢ Submitted: Dec 12, 2025</div>
                                </div>
                            </div>
                            
                            <!-- Four Principles Assessment - Read only view -->
                            <div id="associate-principles-view">
                                <h4 style="font-size: 13px; font-weight: 600; margin-bottom: var(--spacing-md); color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px;">Four Principles Assessment</h4>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--spacing-sm); margin-bottom: var(--spacing-lg);">
                                    <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); border-left: 3px solid var(--surface-300);">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-xs);">
                                            <div style="font-weight: 600; font-size: 13px; color: var(--text-primary);">Competition</div>
                                            <span style="background: var(--surface-200); color: var(--success-700); padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px; font-weight: 600;">Satisfactory</span>
                                        </div>
                                        <p style="font-size: 12px; color: var(--text-secondary); margin: 0; line-height: 1.5;">Open competition with 6 qualified bidders. 45-day advertising period ensured broad reach.</p>
                                    </div>
                                    <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); border-left: 3px solid var(--surface-300);">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-xs);">
                                            <div style="font-weight: 600; font-size: 13px; color: var(--text-primary);">Evaluation</div>
                                            <span style="background: var(--surface-200); color: var(--success-700); padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px; font-weight: 600;">Satisfactory</span>
                                        </div>
                                        <p style="font-size: 12px; color: var(--text-secondary); margin: 0; line-height: 1.5;">Fair evaluation process. All panel members signed off. Scoring aligned with ToR.</p>
                                    </div>
                                    <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); border-left: 3px solid var(--surface-300);">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-xs);">
                                            <div style="font-weight: 600; font-size: 13px; color: var(--text-primary);">Value for Money</div>
                                            <span style="background: var(--surface-200); color: var(--success-700); padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px; font-weight: 600;">Satisfactory</span>
                                        </div>
                                        <p style="font-size: 12px; color: var(--text-secondary); margin: 0; line-height: 1.5;">Price 12% below market comparator. Best value demonstrated.</p>
                                    </div>
                                    <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); border-left: 3px solid var(--warning-400);">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-xs);">
                                            <div style="font-weight: 600; font-size: 13px; color: var(--text-primary);">Capacity</div>
                                            <span style="background: var(--surface-200); color: var(--warning-700); padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px; font-weight: 600;">Minor Concerns</span>
                                        </div>
                                        <p style="font-size: 12px; color: var(--text-secondary); margin: 0; line-height: 1.5;">Technical capacity demonstrated. Delivery timeline concern - recommend monitoring.</p>
                                    </div>
                                </div>
                                
                                <!-- Recommendation Summary -->
                                <div style="background: var(--surface-50); border: 1px solid var(--surface-200); border-radius: var(--radius-md); padding: var(--spacing-md);">
                                    <div style="display: flex; align-items: center; justify-content: space-between;">
                                        <div>
                                            <div style="font-size: 11px; color: var(--text-muted); text-transform: uppercase; margin-bottom: 4px;">Recommendation</div>
                                            <div style="font-weight: 600; font-size: 15px; color: var(--text-primary);">Accepted with Conditions</div>
                                        </div>
                                        <span style="background: var(--success-100); color: var(--success-700); padding: 4px 12px; border-radius: var(--radius-sm); font-size: 11px; font-weight: 600;">‚úì Submitted</span>
                                    </div>
                                    <div style="margin-top: var(--spacing-sm); padding-top: var(--spacing-sm); border-top: 1px solid var(--surface-200); font-size: 12px; color: var(--text-secondary);">
                                        <strong>Conditions:</strong> Close monitoring of delivery milestones. Monthly progress reports required.
                                    </div>
                                </div>
                            </div>

                            <!-- Four Principles Assessment - Edit form (hidden by default, shown for editable cases) -->
                            <div id="associate-principles-form" style="display: none;">
                                <h4 style="font-size: 13px; font-weight: 600; margin-bottom: var(--spacing-md); color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px;">Four Principles Assessment</h4>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--spacing-sm); margin-bottom: var(--spacing-lg);">
                                    <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md);">
                                        <div style="font-weight: 600; font-size: 13px; color: var(--text-primary); margin-bottom: var(--spacing-sm);">Competition</div>
                                        <select class="filter-select" style="width: 100%; margin-bottom: var(--spacing-sm);">
                                            <option value="">-- Select --</option>
                                            <option value="satisfactory">Satisfactory</option>
                                            <option value="minor">Minor Concerns</option>
                                            <option value="unsatisfactory">Unsatisfactory</option>
                                        </select>
                                        <textarea style="width: 100%; padding: 8px; border: 1px solid var(--surface-300); border-radius: var(--radius-sm); font-size: 12px; font-family: inherit;" rows="2" placeholder="Justification..."></textarea>
                                    </div>
                                    <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md);">
                                        <div style="font-weight: 600; font-size: 13px; color: var(--text-primary); margin-bottom: var(--spacing-sm);">Evaluation</div>
                                        <select class="filter-select" style="width: 100%; margin-bottom: var(--spacing-sm);">
                                            <option value="">-- Select --</option>
                                            <option value="satisfactory">Satisfactory</option>
                                            <option value="minor">Minor Concerns</option>
                                            <option value="unsatisfactory">Unsatisfactory</option>
                                        </select>
                                        <textarea style="width: 100%; padding: 8px; border: 1px solid var(--surface-300); border-radius: var(--radius-sm); font-size: 12px; font-family: inherit;" rows="2" placeholder="Justification..."></textarea>
                                    </div>
                                    <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md);">
                                        <div style="font-weight: 600; font-size: 13px; color: var(--text-primary); margin-bottom: var(--spacing-sm);">Value for Money</div>
                                        <select class="filter-select" style="width: 100%; margin-bottom: var(--spacing-sm);">
                                            <option value="">-- Select --</option>
                                            <option value="satisfactory">Satisfactory</option>
                                            <option value="minor">Minor Concerns</option>
                                            <option value="unsatisfactory">Unsatisfactory</option>
                                        </select>
                                        <textarea style="width: 100%; padding: 8px; border: 1px solid var(--surface-300); border-radius: var(--radius-sm); font-size: 12px; font-family: inherit;" rows="2" placeholder="Justification..."></textarea>
                                    </div>
                                    <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md);">
                                        <div style="font-weight: 600; font-size: 13px; color: var(--text-primary); margin-bottom: var(--spacing-sm);">Capacity</div>
                                        <select class="filter-select" style="width: 100%; margin-bottom: var(--spacing-sm);">
                                            <option value="">-- Select --</option>
                                            <option value="satisfactory">Satisfactory</option>
                                            <option value="minor">Minor Concerns</option>
                                            <option value="unsatisfactory">Unsatisfactory</option>
                                        </select>
                                        <textarea style="width: 100%; padding: 8px; border: 1px solid var(--surface-300); border-radius: var(--radius-sm); font-size: 12px; font-family: inherit;" rows="2" placeholder="Justification..."></textarea>
                                    </div>
                                </div>
                                <div style="margin-bottom: var(--spacing-md);">
                                    <label style="display: block; font-weight: 600; font-size: 13px; margin-bottom: var(--spacing-sm);">Recommendation</label>
                            <select class="filter-select" style="width: 100%;">
                                        <option value="">-- Select --</option>
                                        <option value="accepted">Accepted</option>
                                        <option value="accepted-conditions">Accepted with Conditions</option>
                                        <option value="rejected">Rejected</option>
                            </select>
                        </div>
                                <div style="margin-bottom: var(--spacing-md);">
                                    <label style="display: block; font-weight: 600; font-size: 13px; margin-bottom: var(--spacing-sm);">Conditions (if applicable)</label>
                                    <textarea style="width: 100%; padding: var(--spacing-sm); border: 1px solid var(--surface-300); border-radius: var(--radius-md); font-family: inherit; font-size: 13px;" rows="2" placeholder="Enter conditions..."></textarea>
                        </div>
                        <div style="display: flex; gap: var(--spacing-sm);">
                                    <button class="btn btn-primary" onclick="submitAssociateRecommendation()"><i class="pi pi-check"></i> Submit for Voting</button>
                            <button class="btn btn-secondary"><i class="pi pi-save"></i> Save Draft</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section 2: CPC Members Voting (UC-010) - Collapsible -->
                    <div class="card" style="margin-bottom: var(--spacing-md);" id="assessment-section-2">
                        <div class="card-header" style="cursor: pointer;" onclick="toggleAssessmentSection(2)">
                            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                <i class="pi pi-chevron-down" id="assessment-chevron-2" style="transition: transform 0.2s;"></i>
                                <span class="card-title">üó≥Ô∏è CPC Members Voting</span>
                            </div>
                            <span class="status-badge" id="voting-status-badge" style="background: var(--primary-100); color: var(--primary-700);">In Progress</span>
                        </div>
                        <div class="card-body" id="assessment-content-2">
                            <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: var(--spacing-md);">
                                CPC Members review the Associate's recommendation and vote Agree/Disagree.
                            </div>
                            
                            <!-- Voting Progress -->
                            <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: var(--spacing-lg); padding: var(--spacing-sm); background: var(--surface-50); border-radius: var(--radius-sm);">
                                <div style="flex: 1; height: 6px; background: var(--surface-200); border-radius: 3px; overflow: hidden;">
                                    <div id="voting-progress-bar" style="width: 50%; height: 100%; background: var(--primary-500);"></div>
                                </div>
                                <span style="font-size: 12px; font-weight: 600; color: var(--text-secondary);" id="voting-progress-text">2/4 Votes</span>
                            </div>
                            
                            <!-- Members Grid -->
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--spacing-sm); margin-bottom: var(--spacing-lg);" id="members-voting-grid">
                                <!-- Member cards populated by JS based on case -->
                                <div style="padding: var(--spacing-sm) var(--spacing-md); background: var(--surface-0); border: 1px solid var(--surface-200); border-radius: var(--radius-sm); display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                        <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">JS</div>
                                        <span style="font-size: 13px; font-weight: 500;">John Smith</span>
                                    </div>
                                    <span style="background: var(--success-100); color: var(--success-700); padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px; font-weight: 600;">Agree</span>
                                </div>
                                <div style="padding: var(--spacing-sm) var(--spacing-md); background: var(--surface-0); border: 1px solid var(--surface-200); border-radius: var(--radius-sm); display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                        <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">AK</div>
                                        <span style="font-size: 13px; font-weight: 500;">Anna Kowalski</span>
                                    </div>
                                    <span style="background: var(--success-100); color: var(--success-700); padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px; font-weight: 600;">Agree</span>
                                </div>
                                <div style="padding: var(--spacing-sm) var(--spacing-md); background: var(--surface-0); border: 1px dashed var(--surface-300); border-radius: var(--radius-sm); display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                        <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">LC</div>
                                        <span style="font-size: 13px; font-weight: 500;">Luis Chen</span>
                                    </div>
                                    <span style="background: var(--surface-100); color: var(--text-muted); padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px; font-weight: 600;">Pending</span>
                                </div>
                                <div style="padding: var(--spacing-sm) var(--spacing-md); background: var(--surface-0); border: 1px dashed var(--surface-300); border-radius: var(--radius-sm); display: flex; align-items: center; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                        <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">FK</div>
                                        <span style="font-size: 13px; font-weight: 500;">Fatima Khalil</span>
                                    </div>
                                    <span style="background: var(--surface-100); color: var(--text-muted); padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px; font-weight: 600;">Pending</span>
                                </div>
                            </div>
                            
                            <!-- Vote Form -->
                            <div style="background: var(--surface-50); border: 1px solid var(--surface-200); border-radius: var(--radius-md); padding: var(--spacing-md);" id="member-vote-form">
                                <div style="font-weight: 600; font-size: 13px; margin-bottom: var(--spacing-sm);">Your Vote</div>
                                <div style="display: flex; gap: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                                    <button class="btn btn-sm" style="background: var(--surface-0); border: 1px solid var(--success-400); color: var(--success-700);" onclick="submitMemberVote('agree')">
                                        <i class="pi pi-thumbs-up"></i> Agree
                                    </button>
                                    <button class="btn btn-sm" style="background: var(--surface-0); border: 1px solid var(--danger-400); color: var(--danger-700);" onclick="submitMemberVote('disagree')">
                                        <i class="pi pi-thumbs-down"></i> Disagree
                                    </button>
                                </div>
                                <textarea style="width: 100%; padding: var(--spacing-sm); border: 1px solid var(--surface-300); border-radius: var(--radius-sm); font-family: inherit; font-size: 12px;" rows="2" placeholder="Optional comments..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Section 3: CPC Chair Quality Rating (UC-011) - Collapsible -->
                    <div class="card" style="margin-bottom: var(--spacing-md);" id="assessment-section-3">
                        <div class="card-header" style="cursor: pointer;" onclick="toggleAssessmentSection(3)">
                            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                <i class="pi pi-chevron-down" id="assessment-chevron-3" style="transition: transform 0.2s;"></i>
                                <span class="card-title">‚≠ê CPC Chair Quality Rating</span>
                            </div>
                            <span class="status-badge" id="chair-status-badge" style="background: var(--surface-100); color: var(--text-muted);">Pending</span>
                        </div>
                        <div class="card-body" id="assessment-content-3">
                            <div style="display: flex; align-items: center; gap: var(--spacing-md); margin-bottom: var(--spacing-lg); padding-bottom: var(--spacing-md); border-bottom: 1px solid var(--surface-200);">
                                <div class="member-avatar" style="width: 40px; height: 40px; font-size: 13px; background: var(--purple-100); color: var(--purple-700);">MG</div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; font-size: 14px;">Maria Garcia</div>
                                    <div style="font-size: 12px; color: var(--text-muted);">CPC Chair</div>
                                </div>
                            </div>
                            
                            <!-- Locked state (default) -->
                            <div id="chair-locked-state">
                                <div style="text-align: center; padding: var(--spacing-xl); color: var(--text-muted);">
                                    <i class="pi pi-lock" style="font-size: 32px; margin-bottom: var(--spacing-sm);"></i>
                                    <p style="font-size: 13px; margin: 0;">Quality rating available after all members vote</p>
                                </div>
                            </div>
                            
                            <!-- Active state (shown when voting complete or for Chair Rating case) -->
                            <div id="chair-active-state" style="display: none;">
                                <h4 style="font-size: 13px; font-weight: 600; margin-bottom: var(--spacing-md); color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px;">Quality Rating per Principle</h4>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--spacing-sm); margin-bottom: var(--spacing-lg);">
                                    <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md);">
                                        <div style="font-weight: 600; font-size: 13px; color: var(--text-primary); margin-bottom: var(--spacing-sm);">Competition</div>
                                        <select class="filter-select" style="width: 100%;">
                                            <option value="">-- Rating --</option>
                                            <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excellent</option>
                                            <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Good</option>
                                            <option value="3">‚≠ê‚≠ê‚≠ê Satisfactory</option>
                                            <option value="2">‚≠ê‚≠ê Needs Improvement</option>
                                            <option value="1">‚≠ê Unsatisfactory</option>
                                        </select>
                                    </div>
                                    <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md);">
                                        <div style="font-weight: 600; font-size: 13px; color: var(--text-primary); margin-bottom: var(--spacing-sm);">Evaluation</div>
                                        <select class="filter-select" style="width: 100%;">
                                            <option value="">-- Rating --</option>
                                            <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excellent</option>
                                            <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Good</option>
                                            <option value="3">‚≠ê‚≠ê‚≠ê Satisfactory</option>
                                            <option value="2">‚≠ê‚≠ê Needs Improvement</option>
                                            <option value="1">‚≠ê Unsatisfactory</option>
                                        </select>
                                    </div>
                                    <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md);">
                                        <div style="font-weight: 600; font-size: 13px; color: var(--text-primary); margin-bottom: var(--spacing-sm);">Value for Money</div>
                                        <select class="filter-select" style="width: 100%;">
                                            <option value="">-- Rating --</option>
                                            <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excellent</option>
                                            <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Good</option>
                                            <option value="3">‚≠ê‚≠ê‚≠ê Satisfactory</option>
                                            <option value="2">‚≠ê‚≠ê Needs Improvement</option>
                                            <option value="1">‚≠ê Unsatisfactory</option>
                                        </select>
                                    </div>
                                    <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md);">
                                        <div style="font-weight: 600; font-size: 13px; color: var(--text-primary); margin-bottom: var(--spacing-sm);">Capacity</div>
                                        <select class="filter-select" style="width: 100%;">
                                            <option value="">-- Rating --</option>
                                            <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excellent</option>
                                            <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Good</option>
                                            <option value="3">‚≠ê‚≠ê‚≠ê Satisfactory</option>
                                            <option value="2">‚≠ê‚≠ê Needs Improvement</option>
                                            <option value="1">‚≠ê Unsatisfactory</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Chair Vote -->
                                <div style="background: var(--surface-50); border: 1px solid var(--surface-200); border-radius: var(--radius-md); padding: var(--spacing-md);">
                                    <div style="font-weight: 600; font-size: 13px; margin-bottom: var(--spacing-sm);">Chair's Final Vote</div>
                                    <div style="display: flex; gap: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                                        <button class="btn btn-sm" style="background: var(--surface-0); border: 1px solid var(--success-400); color: var(--success-700);" onclick="submitChairVote('agree')">
                                            <i class="pi pi-thumbs-up"></i> Agree
                                        </button>
                                        <button class="btn btn-sm" style="background: var(--surface-0); border: 1px solid var(--danger-400); color: var(--danger-700);" onclick="submitChairVote('disagree')">
                                            <i class="pi pi-thumbs-down"></i> Disagree
                                        </button>
                                    </div>
                                    <textarea style="width: 100%; padding: var(--spacing-sm); border: 1px solid var(--surface-300); border-radius: var(--radius-sm); font-family: inherit; font-size: 12px;" rows="2" placeholder="Chair comments..."></textarea>
                                    <div style="margin-top: var(--spacing-sm);">
                                        <button class="btn btn-primary btn-sm" onclick="submitChairRating()"><i class="pi pi-check"></i> Submit Rating & Vote</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- TAB: Review Team -->
                <div id="tab-review-team" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header" style="border-bottom: 1px solid var(--surface-200);">
                            <span class="card-title" style="font-size: 14px;">üë• Review Team</span>
                            <button class="btn btn-secondary btn-sm" onclick="openReviewTeamModal()"><i class="pi pi-pencil"></i> Manage</button>
                        </div>
                        <div class="card-body">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: var(--spacing-md);">
                                <!-- CPC Chair Card -->
                                <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); border: 1px solid var(--surface-200);">
                                    <div style="font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; margin-bottom: var(--spacing-sm);">CPC Chair</div>
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                        <div class="member-avatar" style="width: 36px; height: 36px; font-size: 12px;">MG</div>
                                        <div>
                                            <div style="font-weight: 600; font-size: 13px;">Maria Garcia</div>
                                            <div style="font-size: 11px; color: var(--text-muted);">Europe & CIS</div>
                                        </div>
                                    </div>
                                </div>
                                <!-- CPC Members Card -->
                                <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); border: 1px solid var(--surface-200);">
                                    <div style="font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; margin-bottom: var(--spacing-sm);">CPC Members</div>
                                    <div style="display: flex; flex-direction: column; gap: var(--spacing-sm);">
                                        <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                            <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">JS</div>
                                            <span style="font-size: 13px;">John Smith</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                            <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">AK</div>
                                            <span style="font-size: 13px;">Anna Kowalski</span>
                                        </div>
                                    </div>
                                </div>
                                <!-- CPC Associate Card -->
                                <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); border: 1px solid var(--surface-200);">
                                    <div style="font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; margin-bottom: var(--spacing-sm);">CPC Associate</div>
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                        <div class="member-avatar" style="width: 36px; height: 36px; font-size: 12px;">PM</div>
                                        <div>
                                            <div style="font-weight: 600; font-size: 13px;">Peter Mueller</div>
                                            <div style="font-size: 11px; color: var(--text-muted);">Global</div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Expert Card -->
                                <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); border: 1px solid var(--surface-200);">
                                    <div style="font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; margin-bottom: var(--spacing-sm);">Expert <span style="font-weight: 400; text-transform: none;">(Optional)</span></div>
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                        <div class="member-avatar" style="width: 36px; height: 36px; font-size: 12px;">DR</div>
                                        <div>
                                            <div style="font-weight: 600; font-size: 13px;">Dr. Robert Lee</div>
                                            <div style="font-size: 11px; color: var(--text-muted);">Medical Equipment</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB: Meeting -->
                <div id="tab-meeting" class="tab-content" style="display: none;">
                    <!-- Header with Link Another Meeting button -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
                        <div>
                            <h3 style="margin: 0; font-size: 16px; font-weight: 600;">Linked Meetings</h3>
                            <p style="margin: 4px 0 0 0; font-size: 13px; color: var(--text-muted);">This case is linked to 2 meetings</p>
                        </div>
                        <button class="btn btn-primary" onclick="openLinkMeetingModal()"><i class="pi pi-plus"></i> Link Another Meeting</button>
                    </div>

                    <!-- Meeting Card 1 - Upcoming -->
                    <div class="card" style="margin-bottom: var(--spacing-lg); border-left: 4px solid var(--primary-500);">
                        <div class="card-body" style="padding: var(--spacing-lg);">
                            <!-- Meeting Header -->
                            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--spacing-md);">
                                <div>
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: 4px;">
                                        <span style="font-weight: 700; font-size: 15px;">Europe & CIS Regional Review</span>
                                        <span class="status-badge success" style="font-size: 10px;">Upcoming</span>
                                    </div>
                                    <div style="font-size: 12px; color: var(--text-muted);">MTG-2025-001</div>
                                </div>
                                <div style="display: flex; gap: var(--spacing-xs);">
                                    <button class="btn btn-secondary btn-sm" onclick="openMeetingDetail('MTG-2025-001')" title="View Details"><i class="pi pi-external-link"></i></button>
                                    <button class="btn btn-secondary btn-sm" onclick="unlinkMeetingFromCase('MTG-2025-001')" title="Unlink"><i class="pi pi-times"></i></button>
                                </div>
                            </div>

                            <!-- Meeting Info Grid -->
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--spacing-md); padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); margin-bottom: var(--spacing-md);">
                                <div>
                                    <div style="font-size: 10px; color: var(--text-muted); text-transform: uppercase;">Date</div>
                                    <div style="font-weight: 600; font-size: 13px;">Dec 16, 2025</div>
                                </div>
                                <div>
                                    <div style="font-size: 10px; color: var(--text-muted); text-transform: uppercase;">Time</div>
                                    <div style="font-weight: 600; font-size: 13px;">10:00 CET</div>
                                </div>
                                <div>
                                    <div style="font-size: 10px; color: var(--text-muted); text-transform: uppercase;">Practice</div>
                                    <div style="font-weight: 600; font-size: 13px;">Procurement</div>
                                </div>
                                <div>
                                    <div style="font-size: 10px; color: var(--text-muted); text-transform: uppercase;">Location</div>
                                    <div style="font-weight: 600; font-size: 13px;">MS Teams</div>
                                </div>
                            </div>

                            <!-- Attendees -->
                            <div style="margin-bottom: var(--spacing-md);">
                                <div style="font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; margin-bottom: var(--spacing-sm);">Attendees (4)</div>
                                <div style="display: flex; flex-wrap: wrap; gap: var(--spacing-xs);">
                                    <div style="display: flex; align-items: center; gap: 4px; padding: 3px 8px; background: var(--surface-100); border-radius: var(--radius-sm); font-size: 11px;">
                                        <div class="member-avatar" style="width: 20px; height: 20px; font-size: 8px;">MG</div>
                                        <span>Maria Garcia</span>
                                        <span style="color: var(--success-600);">‚úì</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 4px; padding: 3px 8px; background: var(--surface-100); border-radius: var(--radius-sm); font-size: 11px;">
                                        <div class="member-avatar" style="width: 20px; height: 20px; font-size: 8px;">JS</div>
                                        <span>John Smith</span>
                                        <span style="color: var(--success-600);">‚úì</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 4px; padding: 3px 8px; background: var(--surface-100); border-radius: var(--radius-sm); font-size: 11px;">
                                        <div class="member-avatar" style="width: 20px; height: 20px; font-size: 8px;">AK</div>
                                        <span>Anna Kowalski</span>
                                        <span style="color: var(--success-600);">‚úì</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 4px; padding: 3px 8px; background: var(--surface-100); border-radius: var(--radius-sm); font-size: 11px;">
                                        <div class="member-avatar" style="width: 20px; height: 20px; font-size: 8px;">PM</div>
                                        <span>Peter Mueller</span>
                                        <span style="color: var(--warning-600);">‚è≥</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Meeting Notes/Minutes for this meeting -->
                            <div style="border-top: 1px solid var(--surface-200); padding-top: var(--spacing-md);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-sm);">
                                    <div style="font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase;">Meeting Notes (2)</div>
                                    <button class="btn btn-sm btn-secondary" onclick="openAddNotesModal('MTG-2025-001')"><i class="pi pi-plus"></i> Add</button>
                                </div>
                                <div style="display: flex; flex-direction: column; gap: var(--spacing-sm);">
                                    <div style="padding: var(--spacing-sm); background: var(--surface-50); border-radius: var(--radius-sm); font-size: 12px;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                            <span style="font-weight: 600;">Maria Garcia</span>
                                            <span style="color: var(--text-muted); font-size: 11px;">Dec 13 ‚Ä¢ Pre-meeting</span>
                                        </div>
                                        <p style="margin: 0; color: var(--text-secondary);">Initial review completed. Evaluation methodology follows standard guidelines.</p>
                                    </div>
                                    <div style="padding: var(--spacing-sm); background: var(--surface-50); border-radius: var(--radius-sm); font-size: 12px;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                            <span style="font-weight: 600;">John Smith</span>
                                            <span style="color: var(--text-muted); font-size: 11px;">Dec 13 ‚Ä¢ Pre-meeting</span>
                                        </div>
                                        <p style="margin: 0; color: var(--text-secondary);">Vendor qualifications reviewed. MediSupply Global has strong track record.</p>
                                    </div>
                                </div>
                                <div style="margin-top: var(--spacing-sm); padding: var(--spacing-sm); background: var(--warning-50); border-radius: var(--radius-sm); font-size: 11px; color: var(--warning-700); text-align: center;">
                                    <i class="pi pi-clock"></i> Meeting minutes pending - Meeting on Dec 16
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Meeting Card 2 - Completed -->
                    <div class="card" style="margin-bottom: var(--spacing-lg); border-left: 4px solid var(--success-500);">
                        <div class="card-body" style="padding: var(--spacing-lg);">
                            <!-- Meeting Header -->
                            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--spacing-md);">
                                <div>
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: 4px;">
                                        <span style="font-weight: 700; font-size: 15px;">Initial Case Review Meeting</span>
                                        <span class="status-badge" style="font-size: 10px; background: var(--surface-200);">Completed</span>
                                    </div>
                                    <div style="font-size: 12px; color: var(--text-muted);">MTG-2024-098</div>
                                </div>
                                <div style="display: flex; gap: var(--spacing-xs);">
                                    <button class="btn btn-secondary btn-sm" onclick="openMeetingDetail('MTG-2024-098')" title="View Details"><i class="pi pi-external-link"></i></button>
                                    <button class="btn btn-secondary btn-sm" onclick="unlinkMeetingFromCase('MTG-2024-098')" title="Unlink"><i class="pi pi-times"></i></button>
                                </div>
                            </div>

                            <!-- Meeting Info Grid -->
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--spacing-md); padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); margin-bottom: var(--spacing-md);">
                                <div>
                                    <div style="font-size: 10px; color: var(--text-muted); text-transform: uppercase;">Date</div>
                                    <div style="font-weight: 600; font-size: 13px;">Dec 10, 2025</div>
                                </div>
                                <div>
                                    <div style="font-size: 10px; color: var(--text-muted); text-transform: uppercase;">Time</div>
                                    <div style="font-weight: 600; font-size: 13px;">14:00 CET</div>
                                </div>
                                <div>
                                    <div style="font-size: 10px; color: var(--text-muted); text-transform: uppercase;">Practice</div>
                                    <div style="font-weight: 600; font-size: 13px;">Procurement</div>
                                </div>
                                <div>
                                    <div style="font-size: 10px; color: var(--text-muted); text-transform: uppercase;">Attendance</div>
                                    <div style="font-weight: 600; font-size: 13px; color: var(--success-600);">4/4 ‚úì</div>
                                </div>
                            </div>

                            <!-- Attendees -->
                            <div style="margin-bottom: var(--spacing-md);">
                                <div style="font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; margin-bottom: var(--spacing-sm);">Attendees (4)</div>
                                <div style="display: flex; flex-wrap: wrap; gap: var(--spacing-xs);">
                                    <div style="display: flex; align-items: center; gap: 4px; padding: 3px 8px; background: var(--surface-100); border-radius: var(--radius-sm); font-size: 11px;">
                                        <div class="member-avatar" style="width: 20px; height: 20px; font-size: 8px;">MG</div>
                                        <span>Maria Garcia</span>
                                        <span style="color: var(--success-600);">‚úì</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 4px; padding: 3px 8px; background: var(--surface-100); border-radius: var(--radius-sm); font-size: 11px;">
                                        <div class="member-avatar" style="width: 20px; height: 20px; font-size: 8px;">JS</div>
                                        <span>John Smith</span>
                                        <span style="color: var(--success-600);">‚úì</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 4px; padding: 3px 8px; background: var(--surface-100); border-radius: var(--radius-sm); font-size: 11px;">
                                        <div class="member-avatar" style="width: 20px; height: 20px; font-size: 8px;">AK</div>
                                        <span>Anna Kowalski</span>
                                        <span style="color: var(--success-600);">‚úì</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 4px; padding: 3px 8px; background: var(--surface-100); border-radius: var(--radius-sm); font-size: 11px;">
                                        <div class="member-avatar" style="width: 20px; height: 20px; font-size: 8px;">PM</div>
                                        <span>Peter Mueller</span>
                                        <span style="color: var(--success-600);">‚úì</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Meeting Minutes -->
                            <div style="border-top: 1px solid var(--surface-200); padding-top: var(--spacing-md);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-sm);">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                        <div style="font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase;">Meeting Minutes</div>
                                        <span style="padding: 2px 6px; background: var(--success-100); color: var(--success-700); border-radius: var(--radius-sm); font-size: 10px;">‚úì Available</span>
                                    </div>
                                    <button class="btn btn-sm btn-secondary" onclick="downloadMeetingMinutes('MTG-2024-098')"><i class="pi pi-download"></i> Download</button>
                                </div>
                                <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); font-size: 12px;">
                                    <p style="margin: 0 0 var(--spacing-sm) 0; color: var(--text-secondary);"><strong>Summary:</strong> Case reviewed and recommended for approval. Evaluation methodology validated. Competition principles satisfied with 6 qualified bidders.</p>
                                    <p style="margin: 0 0 var(--spacing-sm) 0; color: var(--text-secondary);"><strong>Decision:</strong> Proceed to CPC Associate recommendation phase.</p>
                                    <p style="margin: 0; color: var(--text-secondary);"><strong>Action Items:</strong> Complete 4-dimension assessment by Dec 15.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Empty State (hidden when meetings exist) -->
                    <div id="noMeetingsLinked" style="display: none; text-align: center; padding: var(--spacing-xl); background: var(--surface-50); border-radius: var(--radius-lg); border: 2px dashed var(--surface-300);">
                        <i class="pi pi-calendar" style="font-size: 48px; color: var(--text-muted); margin-bottom: var(--spacing-md);"></i>
                        <h3 style="margin: 0 0 var(--spacing-sm) 0; color: var(--text-secondary);">No Meetings Linked</h3>
                        <p style="margin: 0 0 var(--spacing-md) 0; color: var(--text-muted); font-size: 13px;">Link this case to a CPC meeting to discuss and review.</p>
                        <button class="btn btn-primary" onclick="openLinkMeetingModal()"><i class="pi pi-plus"></i> Link to Meeting</button>
                    </div>
                </div>

                <!-- TAB: Deliberations -->
                <div id="tab-deliberations" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">üí¨ Deliberations</span>
                            <button class="btn btn-primary btn-sm" onclick="addDeliberation()"><i class="pi pi-plus"></i> Add Comment</button>
                        </div>
                        <div class="card-body">
                            <div class="deliberation-thread">
                                <div class="deliberation-author">
                                    <div class="deliberation-avatar">MG</div>
                                    <div>
                                        <div style="font-weight: 600;">Maria Garcia <span class="role-badge chair" style="margin-left: 8px;">CPC Chair</span></div>
                                        <div style="font-size: 11px; color: var(--text-muted);">Dec 11, 2025 - 2:30 PM</div>
                                    </div>
                                </div>
                                <div class="deliberation-content">
                                    I have reviewed the evaluation report and the award recommendation appears sound. However, I would like to discuss the delivery timeline for Lot 2 - the 365-day contract duration seems tight given the complexity of the diagnostic equipment.
                                </div>
                            </div>

                            <div class="deliberation-thread">
                                <div class="deliberation-author">
                                    <div class="deliberation-avatar">JS</div>
                                    <div>
                                        <div style="font-weight: 600;">John Smith <span class="role-badge member" style="margin-left: 8px;">CPC Member</span></div>
                                        <div style="font-size: 11px; color: var(--text-muted);">Dec 11, 2025 - 3:45 PM</div>
                                    </div>
                                </div>
                                <div class="deliberation-content">
                                    Agreed on the timeline concern. I also note that HealthCare Corp. has a CENSURE flag on their UNGM profile. While they can still be awarded, we should consider adding a condition for enhanced monitoring during contract execution.
                                </div>
                            </div>

                            <div class="deliberation-thread">
                                <div class="deliberation-author">
                                    <div class="deliberation-avatar">AK</div>
                                    <div>
                                        <div style="font-weight: 600;">Anna Kowalski <span class="role-badge member" style="margin-left: 8px;">CPC Member</span></div>
                                        <div style="font-size: 11px; color: var(--text-muted);">Dec 12, 2025 - 9:15 AM</div>
                                    </div>
                                </div>
                                <div class="deliberation-content">
                                    The VFM analysis shows good savings compared to market prices. I support the recommendation to approve with the condition that quarterly performance reviews are conducted for HealthCare Corp.
                                </div>
                            </div>

                            <!-- Add new deliberation -->
                            <div style="margin-top: var(--spacing-xl); padding: var(--spacing-lg); background: var(--surface-50); border-radius: var(--radius-md);">
                                <label style="font-weight: 600; display: block; margin-bottom: var(--spacing-sm);">Add Your Comment</label>
                                <textarea style="width: 100%; padding: var(--spacing-md); border: 1px solid var(--surface-300); border-radius: var(--radius-md); min-height: 100px; font-family: inherit; margin-bottom: var(--spacing-sm);" placeholder="Enter your deliberation comment..."></textarea>
                                <div style="display: flex; gap: var(--spacing-sm);">
                                    <button class="btn btn-primary"><i class="pi pi-send"></i> Post Comment</button>
                                    <button class="btn btn-secondary"><i class="pi pi-paperclip"></i> Attach File</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB: Q&A / Clarifications -->
                <div id="tab-qa" class="tab-content" style="display: none;">
                    <div class="card" style="margin-bottom: var(--spacing-lg);">
                        <div class="card-header">
                            <span class="card-title">‚ùì Q&A / Clarifications</span>
                            <div style="display: flex; gap: var(--spacing-sm); align-items: center;">
                                <select class="filter-select" id="qaStatusFilter" onchange="filterCaseQA()" style="font-size: 12px; padding: 4px 8px;">
                                    <option value="all">All Status</option>
                                    <option value="pending">Pending</option>
                                    <option value="answered">Answered</option>
                                    <option value="closed">Closed</option>
                                </select>
                                <input type="text" placeholder="Search Q&A..." class="filter-select" id="qaSearchFilter" oninput="filterCaseQA()" style="font-size: 12px; padding: 4px 8px; width: 150px;">
                                <button class="btn btn-primary btn-sm" onclick="openNewQuestionModal()"><i class="pi pi-plus"></i> New Question</button>
                            </div>
                        </div>
                        <div class="card-body">
                            <p style="color: var(--text-muted); margin-bottom: var(--spacing-md);">
                                Questions and clarifications between CPC Associate and Submitting Officer regarding this case.
                                <a href="#" onclick="event.preventDefault(); showView('qa', document.getElementById('menu-qa'))" style="margin-left: var(--spacing-sm);">View all Q&A ‚Üí</a>
                            </p>
                            
                            <!-- Q&A Thread 1 -->
                            <div class="qa-thread" id="case-qa-thread-1">
                                <div class="qa-thread-header">
                                    <div>
                                        <span style="font-weight: 600; color: var(--text-primary);">Q1: Evaluation Criteria Scoring</span>
                                        <span class="status-badge pending" style="margin-left: var(--spacing-sm);">Pending Response</span>
                                    </div>
                                    <span style="font-size: 12px; color: var(--text-muted);">2 messages</span>
                                </div>
                                
                                <!-- CPC Associate Question -->
                                <div class="qa-message">
                                    <div class="qa-message-header">
                                        <div>
                                            <span class="qa-author cpc">Maria Garcia</span>
                                            <span style="font-size: 11px; color: var(--text-muted); margin-left: var(--spacing-sm);">CPC Associate</span>
                                        </div>
                                        <span class="qa-date">Dec 12, 2025, 10:30 AM</span>
                                    </div>
                                    <div class="qa-content">
                                        <p>Could you please clarify how the technical evaluation scoring was calculated for the winning bidder? The evaluation report shows a score of 87/100 but the breakdown doesn't fully explain how the "Quality Management" sub-criterion was assessed.</p>
                                        <p style="margin-top: var(--spacing-sm);">Specifically:</p>
                                        <ul style="margin: var(--spacing-sm) 0; padding-left: var(--spacing-lg);">
                                            <li>What evidence was provided by the bidder for ISO 9001 certification?</li>
                                            <li>How was the QA/QC plan evaluated against the requirements?</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <!-- Submitting Officer Response -->
                                <div class="qa-message" style="background: var(--surface-50);">
                                    <div class="qa-message-header">
                                        <div>
                                            <span class="qa-author">John Smith</span>
                                            <span style="font-size: 11px; color: var(--text-muted); margin-left: var(--spacing-sm);">Submitting Officer - Kenya Hub</span>
                                        </div>
                                        <span class="qa-date">Dec 12, 2025, 2:45 PM</span>
                                    </div>
                                    <div class="qa-content">
                                        <p>Thank you for your question. I've prepared detailed clarification:</p>
                                        <p style="margin-top: var(--spacing-sm);"><strong>ISO 9001 Certification:</strong> The bidder provided a valid ISO 9001:2015 certificate issued by Bureau Veritas, valid until March 2026. Certificate copy is attached to the evaluation report (Annex D).</p>
                                        <p style="margin-top: var(--spacing-sm);"><strong>QA/QC Plan Assessment:</strong> The plan was evaluated against 5 criteria as per the ToR Section 4.2. The bidder scored 8.7/10 based on:</p>
                                        <ul style="margin: var(--spacing-sm) 0; padding-left: var(--spacing-lg);">
                                            <li>Inspection procedures: 9/10</li>
                                            <li>Testing methodology: 8/10</li>
                                            <li>Documentation standards: 9/10</li>
                                            <li>Corrective action procedures: 8/10</li>
                                            <li>Quality reporting: 9.5/10</li>
                                        </ul>
                                        <div style="margin-top: var(--spacing-sm); padding: var(--spacing-sm); background: var(--info-50); border-radius: var(--radius-sm);">
                                            <i class="pi pi-paperclip" style="color: var(--info-500);"></i>
                                            <span style="font-size: 12px; color: var(--info-700);">QA_QC_Assessment_Details.pdf (attached)</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Reply Box -->
                                <div class="qa-reply-box">
                                    <textarea placeholder="Type your follow-up question or acknowledgment..." id="qa-reply-1"></textarea>
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <button class="btn btn-secondary btn-sm"><i class="pi pi-paperclip"></i> Attach File</button>
                                        <div style="display: flex; gap: var(--spacing-sm);">
                                            <button class="btn btn-secondary btn-sm" onclick="markQAResolved('1')">Mark as Resolved</button>
                                            <button class="btn btn-primary btn-sm" onclick="sendQAReply('1')">Send Reply</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Q&A Thread 2 -->
                            <div class="qa-thread" id="case-qa-thread-2">
                                <div class="qa-thread-header">
                                    <div>
                                        <span style="font-weight: 600; color: var(--text-primary);">Q2: Bid Validity Period</span>
                                        <span class="status-badge success" style="margin-left: var(--spacing-sm);">Resolved</span>
                                    </div>
                                    <span style="font-size: 12px; color: var(--text-muted);">3 messages</span>
                                </div>
                                
                                <!-- CPC Associate Question -->
                                <div class="qa-message">
                                    <div class="qa-message-header">
                                        <div>
                                            <span class="qa-author cpc">Maria Garcia</span>
                                            <span style="font-size: 11px; color: var(--text-muted); margin-left: var(--spacing-sm);">CPC Associate</span>
                                        </div>
                                        <span class="qa-date">Dec 11, 2025, 9:15 AM</span>
                                    </div>
                                    <div class="qa-content">
                                        <p>The evaluation report indicates that bid validity ends on January 15, 2026. Given the current timeline, will there be sufficient time to complete the award process? If not, has an extension been requested from the bidders?</p>
                                    </div>
                                </div>
                                
                                <!-- Submitting Officer Response -->
                                <div class="qa-message" style="background: var(--surface-50);">
                                    <div class="qa-message-header">
                                        <div>
                                            <span class="qa-author">John Smith</span>
                                            <span style="font-size: 11px; color: var(--text-muted); margin-left: var(--spacing-sm);">Submitting Officer - Kenya Hub</span>
                                        </div>
                                        <span class="qa-date">Dec 11, 2025, 11:30 AM</span>
                                    </div>
                                    <div class="qa-content">
                                        <p>Good question. Yes, we have already requested and received bid validity extensions from all qualified bidders. The new validity period is extended to February 28, 2026. Extension confirmation letters are available in the case documents (see "Bid Extensions" folder).</p>
                                    </div>
                                </div>
                                
                                <!-- CPC Acknowledgment -->
                                <div class="qa-message">
                                    <div class="qa-message-header">
                                        <div>
                                            <span class="qa-author cpc">Maria Garcia</span>
                                            <span style="font-size: 11px; color: var(--text-muted); margin-left: var(--spacing-sm);">CPC Associate</span>
                                        </div>
                                        <span class="qa-date">Dec 11, 2025, 2:00 PM</span>
                                    </div>
                                    <div class="qa-content">
                                        <p>Thank you for the clarification. I've reviewed the extension letters and confirmed they are in order. This question is now resolved. ‚úì</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB: History (placeholder) -->
                <div id="tab-history" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">üìú Case History</span>
                        </div>
                        <div class="card-body">
                            <div style="border-left: 2px solid var(--surface-300); padding-left: var(--spacing-lg); margin-left: var(--spacing-sm);">
                                <div style="margin-bottom: var(--spacing-lg); position: relative;">
                                    <div style="position: absolute; left: -26px; top: 0; width: 12px; height: 12px; background: var(--success-500); border-radius: 50%;"></div>
                                    <div style="font-weight: 600;">Case Submitted</div>
                                    <div style="font-size: 12px; color: var(--text-muted);">Dec 10, 2025 09:30 AM by John Smith</div>
                                </div>
                                <div style="margin-bottom: var(--spacing-lg); position: relative;">
                                    <div style="position: absolute; left: -26px; top: 0; width: 12px; height: 12px; background: var(--success-500); border-radius: 50%;"></div>
                                    <div style="font-weight: 600;">Case Cleared by Clearing Authority</div>
                                    <div style="font-size: 12px; color: var(--text-muted);">Dec 10, 2025 02:15 PM by Sarah Chen</div>
                                </div>
                                <div style="margin-bottom: var(--spacing-lg); position: relative;">
                                    <div style="position: absolute; left: -26px; top: 0; width: 12px; height: 12px; background: var(--primary-500); border-radius: 50%;"></div>
                                    <div style="font-weight: 600;">Review Team Assigned</div>
                                    <div style="font-size: 12px; color: var(--text-muted);">Dec 11, 2025 10:00 AM by CPC Admin</div>
                                </div>
                                <div style="position: relative;">
                                    <div style="position: absolute; left: -26px; top: 0; width: 12px; height: 12px; background: var(--warning-500); border-radius: 50%;"></div>
                                    <div style="font-weight: 600;">CPC Review In Progress</div>
                                    <div style="font-size: 12px; color: var(--text-muted);">Current Status</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB: Documents (placeholder) -->
                <div id="tab-documents" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">üìÅ Documents (8)</span>
                        </div>
                        <div class="card-body">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Document Name</th>
                                        <th>Type</th>
                                        <th>Uploaded By</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><i class="pi pi-file-pdf" style="color: var(--danger-500);"></i> Evaluation_Report_ITB2024023.pdf</td>
                                        <td>Evaluation Report</td>
                                        <td>John Smith</td>
                                        <td>Dec 10, 2025</td>
                                        <td><button class="btn btn-sm btn-secondary"><i class="pi pi-download"></i></button></td>
                                    </tr>
                                    <tr>
                                        <td><i class="pi pi-file-excel" style="color: var(--success-500);"></i> Financial_Comparison.xlsx</td>
                                        <td>Financial Analysis</td>
                                        <td>John Smith</td>
                                        <td>Dec 10, 2025</td>
                                        <td><button class="btn btn-sm btn-secondary"><i class="pi pi-download"></i></button></td>
                                    </tr>
                                    <tr>
                                        <td><i class="pi pi-file-pdf" style="color: var(--danger-500);"></i> Technical_Evaluation_Lot1.pdf</td>
                                        <td>Technical Evaluation</td>
                                        <td>Alice Johnson</td>
                                        <td>Dec 9, 2025</td>
                                        <td><button class="btn btn-sm btn-secondary"><i class="pi pi-download"></i></button></td>
                                    </tr>
                                    <tr>
                                        <td><i class="pi pi-file-pdf" style="color: var(--danger-500);"></i> Technical_Evaluation_Lot2.pdf</td>
                                        <td>Technical Evaluation</td>
                                        <td>Jane Doe</td>
                                        <td>Dec 9, 2025</td>
                                        <td><button class="btn btn-sm btn-secondary"><i class="pi pi-download"></i></button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Review Team Assignment Modal -->
    <div class="modal-overlay" id="reviewTeamModal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="pi pi-users"></i>
                    <span>Manage Review Team</span>
                </h2>
                <button class="modal-close" onclick="closeReviewTeamModal()">√ó</button>
            </div>

            <div class="modal-body">
                <!-- Info Banner -->
                <div style="background: var(--primary-50); padding: var(--spacing-md); border-radius: var(--radius-md); margin-bottom: var(--spacing-lg); border-left: 4px solid var(--primary-400);">
                    <strong style="font-size: 13px; color: var(--primary-600);">Case: CPC-2025-0042</strong>
                    <span style="margin-left: var(--spacing-sm); font-size: 13px;">Medical Supplies - Emergency Response</span>
                </div>

                <!-- Review Team Setup -->
                <div style="margin-bottom: var(--spacing-xl);">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: var(--spacing-md); color: var(--text-primary);">
                        Review Team Roles
                    </h3>
                    <p style="font-size: 13px; color: var(--text-secondary); margin-bottom: var(--spacing-lg);">
                        Assign CPC members to review this case. Based on case value ($362,400), Panel Review is required.
                    </p>

                    <!-- CPC Chair -->
                    <div style="background: var(--surface-50); padding: var(--spacing-md); border-radius: var(--radius-md); margin-bottom: var(--spacing-md); border: 1px solid var(--surface-200);">
                        <div style="font-weight: 600; margin-bottom: var(--spacing-sm); display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-size: 13px;">CPC Chair <span style="font-size: 10px; color: var(--text-muted); font-weight: 400;">(Required)</span></span>
                            <span style="font-size: 11px; color: var(--success-600);">‚úì 1 Assigned</span>
                        </div>
                        <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap;">
                            <div class="team-badge">Maria Garcia <button onclick="removeFromRole('chair', 'maria')">√ó</button></div>
                            <button class="btn btn-secondary btn-sm" onclick="addMemberToRole('chair')"><i class="pi pi-plus"></i> Change</button>
                        </div>
                    </div>

                    <!-- CPC Members -->
                    <div style="background: var(--surface-50); padding: var(--spacing-md); border-radius: var(--radius-md); margin-bottom: var(--spacing-md); border: 1px solid var(--surface-200);">
                        <div style="font-weight: 600; margin-bottom: var(--spacing-sm); display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-size: 13px;">CPC Members <span style="font-size: 10px; color: var(--text-muted); font-weight: 400;">(Min. 2 Required)</span></span>
                            <span style="font-size: 11px; color: var(--success-600);">‚úì 2 Assigned</span>
                        </div>
                        <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap;">
                            <div class="team-badge">John Smith <button onclick="removeFromRole('member', 'john')">√ó</button></div>
                            <div class="team-badge">Anna Kowalski <button onclick="removeFromRole('member', 'anna')">√ó</button></div>
                            <button class="btn btn-secondary btn-sm" onclick="addMemberToRole('member')"><i class="pi pi-plus"></i> Add</button>
                        </div>
                    </div>

                    <!-- CPC Associate -->
                    <div style="background: var(--surface-50); padding: var(--spacing-md); border-radius: var(--radius-md); margin-bottom: var(--spacing-md); border: 1px solid var(--surface-200);">
                        <div style="font-weight: 600; margin-bottom: var(--spacing-sm); display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-size: 13px;">CPC Associate <span style="font-size: 10px; color: var(--text-muted); font-weight: 400;">(Required for Preliminary Review)</span></span>
                            <span style="font-size: 11px; color: var(--success-600);">‚úì 1 Assigned</span>
                        </div>
                        <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap;">
                            <div class="team-badge">Peter Mueller <button onclick="removeFromRole('associate', 'peter')">√ó</button></div>
                            <button class="btn btn-secondary btn-sm" onclick="addMemberToRole('associate')"><i class="pi pi-plus"></i> Change</button>
                        </div>
                    </div>

                    <!-- Expert (Optional) -->
                    <div style="background: var(--surface-50); padding: var(--spacing-md); border-radius: var(--radius-md); border: 1px solid var(--surface-200);">
                        <div style="font-weight: 600; margin-bottom: var(--spacing-sm); display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-size: 13px;">Expert <span style="font-size: 10px; color: var(--text-muted); font-weight: 400;">(Optional)</span></span>
                            <span style="font-size: 11px; color: var(--success-600);">‚úì 1 Assigned</span>
                        </div>
                        <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap;">
                            <div class="team-badge">Dr. Robert Lee - Medical Equipment <button onclick="removeFromRole('expert', 'robert')">√ó</button></div>
                            <button class="btn btn-secondary btn-sm" onclick="addMemberToRole('expert')"><i class="pi pi-plus"></i> Add</button>
                        </div>
                    </div>
                </div>

                <!-- Available Members Pool -->
                <div style="background: var(--surface-50); padding: var(--spacing-md); border-radius: var(--radius-md); border: 1px solid var(--surface-200);">
                    <h4 style="font-size: 14px; font-weight: 600; margin-bottom: var(--spacing-sm); color: var(--text-primary);">
                        üí° Available CPC Members (Europe & CIS Region)
                    </h4>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: var(--spacing-sm);">
                        Click to add members to the review team:
                    </div>
                    <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap;">
                        <span class="team-badge" style="background: white; cursor: pointer;" onclick="quickAddMember('David Chen')">David Chen (Chair)</span>
                        <span class="team-badge" style="background: white; cursor: pointer;" onclick="quickAddMember('Sarah Johnson')">Sarah Johnson</span>
                        <span class="team-badge" style="background: white; cursor: pointer;" onclick="quickAddMember('Ahmed Hassan')">Ahmed Hassan</span>
                        <span class="team-badge" style="background: white; cursor: pointer;" onclick="quickAddMember('Elena Volkov')">Elena Volkov</span>
                        <span class="team-badge" style="background: white; cursor: pointer;" onclick="quickAddMember('Thomas Berg')">Thomas Berg</span>
                    </div>
                </div>

            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeReviewTeamModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveReviewTeam()">
                    <i class="pi pi-check"></i> Save Team Assignment
                </button>
            </div>
        </div>
    </div>

    <!-- Member Management Modal -->
    <div class="modal-overlay" id="memberManagementModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="pi pi-user"></i>
                    <span id="memberModalTitle">Member Profile</span>
                </h2>
                <button class="modal-close" onclick="closeMemberModal()">
                    <i class="pi pi-times"></i>
                </button>
            </div>

            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                <!-- Member Header -->
                <div style="display: flex; align-items: center; gap: var(--spacing-lg); padding-bottom: var(--spacing-lg); border-bottom: 1px solid var(--surface-200); margin-bottom: var(--spacing-lg);">
                    <div class="member-avatar" style="width: 72px; height: 72px; font-size: 24px;" id="memberModalAvatar">MG</div>
                    <div style="flex: 1;">
                        <div style="font-size: 20px; font-weight: 600;" id="memberModalName">Maria Garcia</div>
                        <div style="font-size: 14px; color: var(--text-secondary);" id="memberModalRole">CPC Chair | Europe & CIS</div>
                        <div style="display: flex; gap: var(--spacing-sm); margin-top: var(--spacing-sm);">
                            <span style="padding: 2px 10px; background: var(--primary-50); color: var(--primary-700); border-radius: var(--radius-sm); font-size: 11px;" id="memberModalPractice">Procurement</span>
                            <span style="padding: 2px 10px; background: var(--success-100); color: var(--success-700); border-radius: var(--radius-sm); font-size: 11px;">Active</span>
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 32px; font-weight: 700; color: var(--primary-500);" id="memberModalAttendance">95%</div>
                        <div style="font-size: 11px; color: var(--text-muted);">Attendance Rate</div>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs" style="margin-bottom: var(--spacing-lg);" id="memberModalTabs">
                    <div class="tab active" onclick="switchMemberModalTab('overview')">Overview</div>
                    <div class="tab" onclick="switchMemberModalTab('cases')">Cases (23)</div>
                    <div class="tab" onclick="switchMemberModalTab('meetings')">Meetings</div>
                    <div class="tab" onclick="switchMemberModalTab('history')">History</div>
                </div>

                <!-- Overview Tab -->
                <div id="member-tab-overview" class="member-modal-tab">
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--spacing-md); margin-bottom: var(--spacing-lg);">
                        <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--primary-500);">23</div>
                            <div style="font-size: 11px; color: var(--text-muted);">Cases (YTD)</div>
                        </div>
                        <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--success-500);">18</div>
                            <div style="font-size: 11px; color: var(--text-muted);">Meetings Attended</div>
                        </div>
                        <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--info-500);">5</div>
                            <div style="font-size: 11px; color: var(--text-muted);">Active Cases</div>
                        </div>
                        <div style="padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--warning-500);">2</div>
                            <div style="font-size: 11px; color: var(--text-muted);">Pending Votes</div>
                        </div>
                    </div>

                    <h4 style="font-size: 13px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; margin-bottom: var(--spacing-sm);">Quarterly Assignments</h4>
                    <table style="width: 100%; border-collapse: collapse; font-size: 13px; margin-bottom: var(--spacing-lg);">
                        <thead>
                            <tr style="background: var(--surface-50);">
                                <th style="padding: 8px 12px; text-align: left;">Quarter</th>
                                <th style="padding: 8px 12px; text-align: left;">Region(s)</th>
                                <th style="padding: 8px 12px; text-align: center;">Cases</th>
                                <th style="padding: 8px 12px; text-align: center;">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid var(--surface-100);">
                                <td style="padding: 8px 12px; font-weight: 500;">Q1 2025</td>
                                <td style="padding: 8px 12px;">Europe & CIS, HQ</td>
                                <td style="padding: 8px 12px; text-align: center;">8</td>
                                <td style="padding: 8px 12px; text-align: center;"><span class="status-badge success">Active</span></td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--surface-100);">
                                <td style="padding: 8px 12px; font-weight: 500;">Q4 2024</td>
                                <td style="padding: 8px 12px;">Asia Pacific</td>
                                <td style="padding: 8px 12px; text-align: center;">7</td>
                                <td style="padding: 8px 12px; text-align: center;"><span class="status-badge" style="background: var(--surface-200); color: var(--text-muted);">Completed</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <h4 style="font-size: 13px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; margin-bottom: var(--spacing-sm);">Skills & Expertise</h4>
                    <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap;">
                        <span style="padding: 4px 12px; background: var(--primary-50); color: var(--primary-700); border-radius: var(--radius-sm); font-size: 12px;">Procurement</span>
                        <span style="padding: 4px 12px; background: var(--info-50); color: var(--info-700); border-radius: var(--radius-sm); font-size: 12px;">IT Equipment</span>
                        <span style="padding: 4px 12px; background: var(--success-50); color: var(--success-700); border-radius: var(--radius-sm); font-size: 12px;">Construction</span>
                        <span style="padding: 4px 12px; background: var(--warning-50); color: var(--warning-700); border-radius: var(--radius-sm); font-size: 12px;">Medical Supplies</span>
                    </div>
                </div>

                <!-- Cases Tab -->
                <div id="member-tab-cases" class="member-modal-tab" style="display: none;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                        <thead>
                            <tr style="background: var(--surface-50);">
                                <th style="padding: 8px 12px; text-align: left;">Case ID</th>
                                <th style="padding: 8px 12px; text-align: left;">Title</th>
                                <th style="padding: 8px 12px; text-align: center;">Role</th>
                                <th style="padding: 8px 12px; text-align: center;">Status</th>
                                <th style="padding: 8px 12px; text-align: center;">Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid var(--surface-100);">
                                <td style="padding: 8px 12px; font-weight: 500;">CPC-2025-0042</td>
                                <td style="padding: 8px 12px;">Medical Supplies - Emergency</td>
                                <td style="padding: 8px 12px; text-align: center;"><span style="background: var(--purple-100); color: var(--purple-700); padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px;">Chair</span></td>
                                <td style="padding: 8px 12px; text-align: center;"><span class="status-badge pending">In Review</span></td>
                                <td style="padding: 8px 12px; text-align: center;">Dec 10</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--surface-100);">
                                <td style="padding: 8px 12px; font-weight: 500;">CPC-2025-0041</td>
                                <td style="padding: 8px 12px;">IT Infrastructure Upgrade</td>
                                <td style="padding: 8px 12px; text-align: center;"><span style="background: var(--purple-100); color: var(--purple-700); padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px;">Chair</span></td>
                                <td style="padding: 8px 12px; text-align: center;"><span class="status-badge review">Chair Review</span></td>
                                <td style="padding: 8px 12px; text-align: center;">Dec 8</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--surface-100);">
                                <td style="padding: 8px 12px; font-weight: 500;">CPC-2025-0039</td>
                                <td style="padding: 8px 12px;">Office Equipment Supply</td>
                                <td style="padding: 8px 12px; text-align: center;"><span style="background: var(--info-100); color: var(--info-700); padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px;">Member</span></td>
                                <td style="padding: 8px 12px; text-align: center;"><span class="status-badge success">Approved</span></td>
                                <td style="padding: 8px 12px; text-align: center;">Dec 5</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--surface-100);">
                                <td style="padding: 8px 12px; font-weight: 500;">CPC-2025-0037</td>
                                <td style="padding: 8px 12px;">Security Services Contract</td>
                                <td style="padding: 8px 12px; text-align: center;"><span style="background: var(--purple-100); color: var(--purple-700); padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px;">Chair</span></td>
                                <td style="padding: 8px 12px; text-align: center;"><span class="status-badge deliberation">Voting</span></td>
                                <td style="padding: 8px 12px; text-align: center;">Dec 3</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Meetings Tab -->
                <div id="member-tab-meetings" class="member-modal-tab" style="display: none;">
                    <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: var(--spacing-md);">
                        <strong>18/19</strong> meetings attended (95% attendance)
                    </div>
                    <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                        <thead>
                            <tr style="background: var(--surface-50);">
                                <th style="padding: 8px 12px; text-align: left;">Meeting</th>
                                <th style="padding: 8px 12px; text-align: left;">Date</th>
                                <th style="padding: 8px 12px; text-align: center;">Cases</th>
                                <th style="padding: 8px 12px; text-align: center;">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid var(--surface-100);">
                                <td style="padding: 8px 12px;">CPC Panel Review - Europe</td>
                                <td style="padding: 8px 12px;">Dec 13, 2025</td>
                                <td style="padding: 8px 12px; text-align: center;">4</td>
                                <td style="padding: 8px 12px; text-align: center;"><span style="color: var(--success-600);">‚úì Present</span></td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--surface-100);">
                                <td style="padding: 8px 12px;">CPC Panel Review - Europe</td>
                                <td style="padding: 8px 12px;">Dec 6, 2025</td>
                                <td style="padding: 8px 12px; text-align: center;">5</td>
                                <td style="padding: 8px 12px; text-align: center;"><span style="color: var(--success-600);">‚úì Present</span></td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--surface-100);">
                                <td style="padding: 8px 12px;">CPC Panel Review - Europe</td>
                                <td style="padding: 8px 12px;">Nov 22, 2025</td>
                                <td style="padding: 8px 12px; text-align: center;">4</td>
                                <td style="padding: 8px 12px; text-align: center;"><span style="color: var(--danger-600);">‚úó Absent</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- History Tab -->
                <div id="member-tab-history" class="member-modal-tab" style="display: none;">
                    <div style="border-left: 2px solid var(--surface-300); padding-left: var(--spacing-lg); margin-left: var(--spacing-sm);">
                        <div style="margin-bottom: var(--spacing-lg); position: relative;">
                            <div style="position: absolute; left: -26px; top: 0; width: 12px; height: 12px; background: var(--primary-500); border-radius: 50%;"></div>
                            <div style="font-weight: 600; font-size: 13px;">Assigned to Europe & CIS for Q1 2025</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Dec 10, 2025</div>
                        </div>
                        <div style="margin-bottom: var(--spacing-lg); position: relative;">
                            <div style="position: absolute; left: -26px; top: 0; width: 12px; height: 12px; background: var(--success-500); border-radius: 50%;"></div>
                            <div style="font-weight: 600; font-size: 13px;">Completed Q4 2024 assignment</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Dec 1, 2025 ‚Ä¢ 7 cases reviewed</div>
                        </div>
                        <div style="margin-bottom: var(--spacing-lg); position: relative;">
                            <div style="position: absolute; left: -26px; top: 0; width: 12px; height: 12px; background: var(--warning-500); border-radius: 50%;"></div>
                            <div style="font-weight: 600; font-size: 13px;">Promoted to CPC Chair</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Sep 1, 2024</div>
                        </div>
                        <div style="position: relative;">
                            <div style="position: absolute; left: -26px; top: 0; width: 12px; height: 12px; background: var(--surface-400); border-radius: 50%;"></div>
                            <div style="font-weight: 600; font-size: 13px;">Joined CPC as Member</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Jan 15, 2022</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeMemberModal()">Close</button>
                <button class="btn btn-primary" onclick="editMemberAvailability()"><i class="pi pi-calendar"></i> Edit Availability</button>
            </div>
        </div>
    </div>

    <!-- Auto-Assign Results Modal -->
    <div class="modal-overlay" id="autoAssignModal">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="pi pi-sync"></i>
                    <span>Auto-Assignment Results</span>
                </h2>
                <button class="modal-close" onclick="closeAutoAssignModal()">
                    <i class="pi pi-times"></i>
                </button>
            </div>

            <div class="modal-body">
                <div style="padding: var(--spacing-md); background: var(--success-50); border-radius: var(--radius-md); margin-bottom: var(--spacing-lg);">
                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); color: var(--success-700);">
                        <i class="pi pi-check-circle" style="font-size: 20px;"></i>
                        <div>
                            <div style="font-weight: 600;">Auto-assignment completed successfully</div>
                            <div style="font-size: 12px;">18 members assigned across 6 regions for Q1 2025</div>
                        </div>
                    </div>
                </div>

                <h4 style="font-size: 13px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; margin-bottom: var(--spacing-md);">Rules Applied</h4>
                <div style="display: grid; gap: var(--spacing-sm); margin-bottom: var(--spacing-lg);">
                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm); background: var(--surface-50); border-radius: var(--radius-sm);">
                        <span style="color: var(--success-600);">‚úì</span>
                        <span style="font-size: 13px;">No member assigned to same region as Q4 2024</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm); background: var(--surface-50); border-radius: var(--radius-sm);">
                        <span style="color: var(--success-600);">‚úì</span>
                        <span style="font-size: 13px;">Attendance balanced: Avg 92% per region</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm); background: var(--surface-50); border-radius: var(--radius-sm);">
                        <span style="color: var(--success-600);">‚úì</span>
                        <span style="font-size: 13px;">Practice areas balanced: 6 Procurement, 6 ICA, 6 Finance</span>
                    </div>
                </div>

                <h4 style="font-size: 13px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; margin-bottom: var(--spacing-md);">Changes from Previous Quarter</h4>
                <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                    <thead>
                        <tr style="background: var(--surface-50);">
                            <th style="padding: 8px 12px; text-align: left;">Member</th>
                            <th style="padding: 8px 12px; text-align: left;">Q4 2024</th>
                            <th style="padding: 8px 12px; text-align: center;">‚Üí</th>
                            <th style="padding: 8px 12px; text-align: left;">Q1 2025</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="border-bottom: 1px solid var(--surface-100);">
                            <td style="padding: 8px 12px;">Maria Garcia</td>
                            <td style="padding: 8px 12px;">Asia Pacific</td>
                            <td style="padding: 8px 12px; text-align: center;">‚Üí</td>
                            <td style="padding: 8px 12px; font-weight: 500; color: var(--primary-600);">Europe & CIS</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--surface-100);">
                            <td style="padding: 8px 12px;">David Chen</td>
                            <td style="padding: 8px 12px;">Europe & CIS</td>
                            <td style="padding: 8px 12px; text-align: center;">‚Üí</td>
                            <td style="padding: 8px 12px; font-weight: 500; color: var(--primary-600);">Asia Pacific</td>
                        </tr>
                        <tr style="border-bottom: 1px solid var(--surface-100);">
                            <td style="padding: 8px 12px;">Ahmed Hassan</td>
                            <td style="padding: 8px 12px;">Middle East</td>
                            <td style="padding: 8px 12px; text-align: center;">‚Üí</td>
                            <td style="padding: 8px 12px; font-weight: 500; color: var(--primary-600);">Africa</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeAutoAssignModal()">Review Later</button>
                <button class="btn btn-primary" onclick="acceptAutoAssignment()"><i class="pi pi-check"></i> Accept & Save</button>
            </div>
        </div>
    </div>

    <!-- Create Meeting Modal -->
    <div class="modal-overlay" id="createMeetingModal">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="modal-title"><i class="pi pi-calendar-plus"></i> <span id="meetingModalTitle">Create New Meeting</span></h2>
                <button class="modal-close" onclick="closeCreateMeetingModal()"><i class="pi pi-times"></i></button>
            </div>
            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                <!-- Meeting Details -->
                <div style="margin-bottom: var(--spacing-lg);">
                    <h4 style="font-size: 12px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; margin-bottom: var(--spacing-md);">Meeting Details</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-md);">
                        <div>
                            <label style="display: block; font-weight: 500; font-size: 13px; margin-bottom: 4px;">Title</label>
                            <input type="text" id="meetingTitle" class="filter-select" style="width: 100%;" placeholder="e.g., Europe & CIS Review">
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; font-size: 13px; margin-bottom: 4px;">Region *</label>
                            <select id="meetingRegion" class="filter-select" style="width: 100%;" onchange="updateAvailableMembers()">
                                <option value="">-- Select --</option>
                                <option value="europe">Europe & CIS</option>
                                <option value="asia">Asia Pacific</option>
                                <option value="africa">Africa</option>
                                <option value="americas">Americas</option>
                                <option value="middleeast">Middle East</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; font-size: 13px; margin-bottom: 4px;">Date *</label>
                            <input type="date" id="meetingDate" class="filter-select" style="width: 100%;" onchange="updateAvailableMembers()">
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; font-size: 13px; margin-bottom: 4px;">Time *</label>
                            <input type="time" id="meetingTime" class="filter-select" style="width: 100%;">
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; font-size: 13px; margin-bottom: 4px;">Practice *</label>
                            <select id="meetingPractice" class="filter-select" style="width: 100%;" onchange="updateAvailableMembers()">
                                <option value="">-- Select --</option>
                                <option value="procurement">Procurement</option>
                                <option value="ica">ICA</option>
                                <option value="finance">Finance</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; font-size: 13px; margin-bottom: 4px;">Location</label>
                            <select id="meetingLocation" class="filter-select" style="width: 100%;">
                                <option value="teams">MS Teams</option>
                                <option value="zoom">Zoom</option>
                                <option value="hybrid">Hybrid</option>
                                <option value="inperson">In-person</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Invite Attendees (FR-034) -->
                <div style="margin-bottom: var(--spacing-lg);">
                    <h4 style="font-size: 12px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; margin-bottom: var(--spacing-md);">Invite Attendees <span style="font-weight: 400; text-transform: none;">(based on region/date/practice)</span></h4>
                    <div id="meetingAvailableMembers" style="border: 1px solid var(--surface-200); border-radius: var(--radius-md); max-height: 180px; overflow-y: auto;">
                        <div style="padding: var(--spacing-md); text-align: center; color: var(--text-muted); font-size: 13px;">
                            <i class="pi pi-info-circle"></i> Select region, date & practice to see available members
                        </div>
                    </div>
                    <div style="margin-top: var(--spacing-sm); font-size: 12px; color: var(--text-muted);"><span id="selectedAttendeesCount">0</span> members selected</div>
                </div>

                <!-- Link Cases (FR-033) -->
                <div style="margin-bottom: var(--spacing-lg);">
                    <h4 style="font-size: 12px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; margin-bottom: var(--spacing-md);">Link Cases</h4>
                    <input type="text" id="meetingCaseSearch" class="filter-select" style="width: 100%; margin-bottom: var(--spacing-sm);" placeholder="Search cases..." oninput="searchCasesForMeeting()">
                    <div id="meetingLinkedCases" style="display: flex; flex-wrap: wrap; gap: var(--spacing-sm); min-height: 28px;"></div>
                    <div id="meetingCaseResults" style="border: 1px solid var(--surface-200); border-radius: var(--radius-md); max-height: 120px; overflow-y: auto; margin-top: var(--spacing-sm); display: none;"></div>
                </div>

                <!-- Notification Settings -->
                <div>
                    <h4 style="font-size: 12px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; margin-bottom: var(--spacing-md);">Notifications</h4>
                    <label style="display: flex; align-items: center; gap: var(--spacing-sm); cursor: pointer; margin-bottom: var(--spacing-xs);"><input type="checkbox" checked><span style="font-size: 13px;">Send email invitations</span></label>
                    <label style="display: flex; align-items: center; gap: var(--spacing-sm); cursor: pointer; margin-bottom: var(--spacing-xs);"><input type="checkbox" checked><span style="font-size: 13px;">24h reminder (FR-047)</span></label>
                    <label style="display: flex; align-items: center; gap: var(--spacing-sm); cursor: pointer;"><input type="checkbox" checked><span style="font-size: 13px;">Google Calendar (FR-049)</span></label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="saveMeetingDraft()"><i class="pi pi-save"></i> Save Draft</button>
                <button class="btn btn-secondary" onclick="closeCreateMeetingModal()">Cancel</button>
                <button class="btn btn-primary" onclick="createMeeting()"><i class="pi pi-send"></i> Create & Send Invitations</button>
            </div>
        </div>
    </div>

    <!-- Meeting Detail Modal -->
    <div class="modal-overlay" id="meetingDetailModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="modal-title"><span id="meetingDetailIcon">üìÖ</span> <span id="meetingDetailTitle">Meeting Details</span></h2>
                <button class="modal-close" onclick="closeMeetingDetailModal()"><i class="pi pi-times"></i></button>
            </div>
            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                <!-- Meeting Info -->
                <div style="background: linear-gradient(135deg, var(--primary-50), var(--primary-100)); border-radius: var(--radius-lg); padding: var(--spacing-lg); margin-bottom: var(--spacing-lg);">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--spacing-md);">
                        <div>
                            <div style="font-size: 10px; color: var(--text-muted); margin-bottom: 2px;">MEETING ID</div>
                            <div id="meetingDetailId" style="font-weight: 600;">MTG-2025-001</div>
                        </div>
                        <span id="meetingDetailStatus" class="status-badge success">Confirmed</span>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--spacing-md);">
                        <div><div style="font-size: 10px; color: var(--text-muted);">DATE</div><div id="meetingDetailDate" style="font-weight: 600;">Dec 16, 2025</div></div>
                        <div><div style="font-size: 10px; color: var(--text-muted);">TIME</div><div id="meetingDetailTime" style="font-weight: 600;">10:00 CET</div></div>
                        <div><div style="font-size: 10px; color: var(--text-muted);">REGION</div><div id="meetingDetailRegion" style="font-weight: 600;">üåç Europe & CIS</div></div>
                        <div><div style="font-size: 10px; color: var(--text-muted);">PRACTICE</div><div id="meetingDetailPractice" style="font-weight: 600;">üìã Procurement</div></div>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs" style="margin-bottom: var(--spacing-lg);">
                    <div class="tab active" onclick="switchMeetingDetailTab('attendees')">Attendees</div>
                    <div class="tab" onclick="switchMeetingDetailTab('cases')">Cases</div>
                    <div class="tab" onclick="switchMeetingDetailTab('notes')">Notes & Minutes</div>
                    <div class="tab" onclick="switchMeetingDetailTab('actions')">Actions</div>
                </div>

                <!-- Attendees Tab -->
                <div id="meeting-detail-attendees" class="meeting-detail-tab">
                    <div style="display: flex; justify-content: space-between; margin-bottom: var(--spacing-md);">
                        <span style="font-size: 13px; color: var(--text-muted);"><span style="color: var(--success-600);">3 confirmed</span> ‚Ä¢ <span style="color: var(--warning-600);">1 pending</span></span>
                        <button class="btn btn-sm btn-secondary" onclick="sendMeetingReminder(currentMeetingId)"><i class="pi pi-bell"></i> Send Reminders</button>
                    </div>
                    <div id="meetingDetailAttendees" style="display: grid; gap: var(--spacing-sm);"></div>
                </div>

                <!-- Cases Tab -->
                <div id="meeting-detail-cases" class="meeting-detail-tab" style="display: none;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: var(--spacing-md);">
                        <span style="font-size: 13px; color: var(--text-muted);">Cases to review</span>
                        <button class="btn btn-sm btn-secondary" onclick="addCaseToMeeting()"><i class="pi pi-plus"></i> Add Case</button>
                    </div>
                    <div id="meetingDetailCases" style="display: grid; gap: var(--spacing-sm);"></div>
                </div>

                <!-- Notes Tab -->
                <div id="meeting-detail-notes" class="meeting-detail-tab" style="display: none;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: var(--spacing-md);">
                        <span style="font-size: 13px; color: var(--text-muted);">Meeting notes and minutes</span>
                        <button class="btn btn-sm btn-primary" onclick="addMeetingNote()"><i class="pi pi-plus"></i> Add Note</button>
                    </div>
                    <div id="meetingDetailNotes"></div>
                </div>

                <!-- Actions Tab -->
                <div id="meeting-detail-actions" class="meeting-detail-tab" style="display: none;">
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--spacing-md);">
                        <button class="btn btn-secondary" onclick="editMeeting(currentMeetingId)" style="padding: var(--spacing-md); display: flex; flex-direction: column; align-items: center; gap: var(--spacing-xs);"><i class="pi pi-pencil" style="font-size: 20px;"></i><span style="font-size: 12px;">Edit</span></button>
                        <button class="btn btn-secondary" onclick="sendMeetingReminder(currentMeetingId)" style="padding: var(--spacing-md); display: flex; flex-direction: column; align-items: center; gap: var(--spacing-xs);"><i class="pi pi-bell" style="font-size: 20px;"></i><span style="font-size: 12px;">Remind</span></button>
                        <button class="btn btn-secondary" onclick="exportMeetingCalendar()" style="padding: var(--spacing-md); display: flex; flex-direction: column; align-items: center; gap: var(--spacing-xs);"><i class="pi pi-calendar" style="font-size: 20px;"></i><span style="font-size: 12px;">Calendar</span></button>
                        <button class="btn btn-secondary" onclick="generateMeetingMinutes()" style="padding: var(--spacing-md); display: flex; flex-direction: column; align-items: center; gap: var(--spacing-xs);"><i class="pi pi-file" style="font-size: 20px;"></i><span style="font-size: 12px;">Minutes</span></button>
                        <button class="btn btn-secondary" onclick="duplicateMeeting()" style="padding: var(--spacing-md); display: flex; flex-direction: column; align-items: center; gap: var(--spacing-xs);"><i class="pi pi-copy" style="font-size: 20px;"></i><span style="font-size: 12px;">Duplicate</span></button>
                        <button class="btn btn-secondary" onclick="cancelMeeting()" style="padding: var(--spacing-md); display: flex; flex-direction: column; align-items: center; gap: var(--spacing-xs); color: var(--danger-600);"><i class="pi pi-times-circle" style="font-size: 20px;"></i><span style="font-size: 12px;">Cancel</span></button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeMeetingDetailModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Link Meeting Modal -->
    <div class="modal-overlay" id="linkMeetingModal">
        <div class="modal" style="max-width: 450px;">
            <div class="modal-header">
                <h2 class="modal-title"><i class="pi pi-link"></i> Link to Meeting</h2>
                <button class="modal-close" onclick="closeLinkMeetingModal()"><i class="pi pi-times"></i></button>
            </div>
            <div class="modal-body">
                <p style="font-size: 13px; color: var(--text-muted); margin-bottom: var(--spacing-lg);">Select a meeting to link this case to:</p>
                <select id="linkMeetingSelect" class="filter-select" style="width: 100%; margin-bottom: var(--spacing-md);" onchange="previewSelectedMeeting()">
                    <option value="">-- Select meeting --</option>
                    <option value="MTG-2025-001">Dec 16 - Europe & CIS Review</option>
                    <option value="MTG-2025-002">Dec 18 - Asia Pacific Review</option>
                    <option value="MTG-2025-003">Dec 20 - Africa Review</option>
                    <option value="new">+ Create New Meeting</option>
                </select>
                <div id="selectedMeetingPreview" style="display: none; background: var(--surface-50); border-radius: var(--radius-md); padding: var(--spacing-md);">
                    <div id="previewMeetingTitle" style="font-weight: 600;"></div>
                    <div style="font-size: 12px; color: var(--text-muted);"><span id="previewMeetingDate"></span></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeLinkMeetingModal()">Cancel</button>
                <button class="btn btn-primary" onclick="linkCaseToMeeting()"><i class="pi pi-check"></i> Link</button>
            </div>
        </div>
    </div>

    <!-- Add Notes Modal -->
    <div class="modal-overlay" id="addNotesModal">
        <div class="modal" style="max-width: 450px;">
            <div class="modal-header">
                <h2 class="modal-title"><i class="pi pi-pencil"></i> Add Meeting Note</h2>
                <button class="modal-close" onclick="closeAddNotesModal()"><i class="pi pi-times"></i></button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: var(--spacing-md);">
                    <label style="display: block; font-weight: 500; font-size: 13px; margin-bottom: 4px;">Type</label>
                    <select id="noteType" class="filter-select" style="width: 100%;">
                        <option value="pre">Pre-meeting</option>
                        <option value="during">During Meeting</option>
                        <option value="action">Action Item</option>
                        <option value="decision">Decision</option>
                    </select>
                </div>
                <div style="margin-bottom: var(--spacing-md);">
                    <label style="display: block; font-weight: 500; font-size: 13px; margin-bottom: 4px;">Note</label>
                    <textarea id="noteContent" style="width: 100%; padding: var(--spacing-sm); border: 1px solid var(--surface-300); border-radius: var(--radius-md); font-family: inherit; font-size: 13px;" rows="4" placeholder="Enter your note..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeAddNotesModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveMeetingNote()"><i class="pi pi-check"></i> Save</button>
            </div>
        </div>
    </div>

    <!-- Region Assignment Modal -->
    <div class="modal-overlay" id="regionAssignmentModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="modal-title">
                    <span id="regionModalIcon">üåç</span>
                    <span>Manage <span id="regionModalName">Region</span> Assignment</span>
                </h2>
                <button class="modal-close" onclick="closeRegionAssignmentModal()">
                    <i class="pi pi-times"></i>
                </button>
            </div>

            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                <!-- Quarter Context -->
                <div style="display: flex; justify-content: space-between; align-items: center; padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md); margin-bottom: var(--spacing-lg);">
                    <div>
                        <div style="font-size: 12px; color: var(--text-muted);">Assigning for</div>
                        <div style="font-weight: 600;">Q1 2025</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 12px; color: var(--text-muted);">Previous assignment (Q4 2024)</div>
                        <div style="font-size: 13px; color: var(--text-secondary);" id="regionPreviousMembers">3 members</div>
                    </div>
                </div>

                <!-- Warning for consecutive region -->
                <div id="regionWarningBanner" style="display: none; padding: var(--spacing-md); background: var(--warning-50); border: 1px solid var(--warning-200); border-radius: var(--radius-md); margin-bottom: var(--spacing-lg);">
                    <div style="display: flex; align-items: center; gap: var(--spacing-sm); color: var(--warning-700);">
                        <i class="pi pi-exclamation-triangle"></i>
                        <span style="font-size: 13px;">Members marked with ‚ö†Ô∏è were assigned to this region in Q4 2024</span>
                    </div>
                </div>

                <!-- Current Assignments -->
                <div style="margin-bottom: var(--spacing-xl);">
                    <h4 style="font-size: 13px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; margin-bottom: var(--spacing-md);">
                        Current Assignments (<span id="regionAssignedCount">4</span>)
                    </h4>
                    <div id="regionAssignedMembers" style="display: grid; gap: var(--spacing-sm);">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Available Members -->
                <div>
                    <h4 style="font-size: 13px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; margin-bottom: var(--spacing-sm);">
                        Available Members
                    </h4>
                    <div style="display: flex; gap: var(--spacing-sm); margin-bottom: var(--spacing-md);">
                        <select class="filter-select" id="regionFilterPractice" onchange="filterAvailableMembers()">
                            <option value="all">All Practices</option>
                            <option value="procurement">Procurement</option>
                            <option value="ica">ICA</option>
                            <option value="finance">Finance</option>
                        </select>
                        <select class="filter-select" id="regionFilterRole" onchange="filterAvailableMembers()">
                            <option value="all">All Roles</option>
                            <option value="chair">Chairs</option>
                            <option value="member">Members</option>
                        </select>
                        <input type="text" placeholder="Search..." class="filter-select" style="flex: 1;" id="regionSearchInput" oninput="filterAvailableMembers()">
                    </div>
                    <div id="regionAvailableMembers" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--spacing-sm); max-height: 250px; overflow-y: auto;">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <div style="flex: 1; font-size: 12px; color: var(--text-muted);">
                    <span id="regionBalanceInfo">Practice balance: 2 Procurement, 1 ICA, 1 Finance</span>
                </div>
                <button class="btn btn-secondary" onclick="closeRegionAssignmentModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveRegionAssignment()"><i class="pi pi-check"></i> Save Assignment</button>
            </div>
        </div>
    </div>

    <script>
        // ===== VIEW MANAGEMENT =====
        function showView(viewName, menuItem) {
            // Hide all views
            document.querySelectorAll('.view-section').forEach(section => {
                section.classList.remove('active');
            });

            // Remove active from all nav items
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });

            // Show selected view
            const viewId = 'view-' + viewName;
            const viewElement = document.getElementById(viewId);
            if (viewElement) {
                viewElement.classList.add('active');
            }

            // Add active to clicked nav item
            if (menuItem) {
                menuItem.classList.add('active');
            }

            window.scrollTo({ top: 0, behavior: 'smooth' });
            console.log('Switched to view:', viewName);
        }

        // ===== MY CASES FILTER =====
        function filterMyCases() {
            const roleFilter = document.getElementById('myCasesRoleFilter').value;
            const statusFilter = document.getElementById('myCasesStatusFilter').value;
            const cards = document.querySelectorAll('#myCasesGrid .my-case-card');
            
            cards.forEach(card => {
                const cardRole = card.dataset.role;
                const cardStatus = card.dataset.status;
                
                const matchRole = roleFilter === 'all' || cardRole === roleFilter;
                const matchStatus = statusFilter === 'all' || cardStatus === statusFilter;
                
                card.style.display = (matchRole && matchStatus) ? 'block' : 'none';
            });
        }

        // ===== CASE DETAIL =====
        function openCase(caseId) {
            const caseData = {
                'CPC-2025-0043': {
                    id: 'CPC-2025-0043',
                    title: 'Agricultural Equipment Supply',
                    meta: 'ITB/2024/025 | Africa | Submitted: Today',
                    status: 'Just Received',
                    statusClass: 'new',
                    assessmentScenario: 'fresh',  // Fresh case - no team, no deliberations, no meetings, no Q&A
                    isFreshCase: true,
                    value: 1650000,
                    reviewModality: 'panel'  // Panel Review (value > $250k)
                },
                'CPC-2025-0042': {
                    id: 'CPC-2025-0042',
                    title: 'Medical Supplies - Emergency Response',
                    meta: 'ITB/2024/023 | Europe & CIS | Submitted: Dec 10, 2025',
                    status: 'Pending Review',
                    statusClass: 'pending',
                    assessmentScenario: 'member-voting',
                    value: 2400000,
                    reviewModality: 'panel'  // Panel Review (value > $250k)
                },
                'CPC-2025-0041': {
                    id: 'CPC-2025-0041',
                    title: 'IT Infrastructure Upgrade',
                    meta: 'RFP/2024/089 | HQ | Submitted: Dec 8, 2025',
                    status: 'Chair Review',
                    statusClass: 'deliberation',
                    assessmentScenario: 'chair-rating',
                    value: 1800000,
                    reviewModality: 'panel'  // Panel Review (value > $250k)
                },
                'CPC-2025-0040': {
                    id: 'CPC-2025-0040',
                    title: 'Vehicle Fleet Procurement',
                    meta: 'ITB/2024/021 | Africa | Submitted: Dec 5, 2025',
                    status: 'Approved',
                    statusClass: 'approved',
                    assessmentScenario: 'completed',
                    value: 3200000,
                    reviewModality: 'panel'  // Panel Review (value > $250k)
                },
                'CPC-2025-0039': {
                    id: 'CPC-2025-0039',
                    title: 'Office Equipment Supply',
                    meta: 'RFQ/2024/156 | Asia | Submitted: Dec 6, 2025',
                    status: 'Q&A Pending',
                    statusClass: 'review',
                    assessmentScenario: 'member-voting',
                    value: 450000,
                    reviewModality: 'panel'  // Panel Review (value > $250k)
                },
                'CPC-2025-0038': {
                    id: 'CPC-2025-0038',
                    title: 'Construction Materials',
                    meta: 'ITB/2024/019 | Americas | Submitted: Dec 7, 2025',
                    status: 'Associate Review',
                    statusClass: 'pending',
                    assessmentScenario: 'associate-edit',
                    value: 5100000,
                    reviewModality: 'panel'  // Panel Review (value > $250k)
                },
                'CPC-2025-0037': {
                    id: 'CPC-2025-0037',
                    title: 'Security Services Contract',
                    meta: 'RFP/2024/078 | Europe & CIS | Submitted: Dec 9, 2025',
                    status: 'Awaiting Vote',
                    statusClass: 'deliberation',
                    assessmentScenario: 'member-voting',
                    value: 890000,
                    reviewModality: 'panel'  // Panel Review (value > $250k)
                },
                'CPC-2025-0035': {
                    id: 'CPC-2025-0035',
                    title: 'Office Supplies Replenishment',
                    meta: 'RFQ/2024/201 | Americas | Submitted: Dec 11, 2025',
                    status: 'Pending Review',
                    statusClass: 'pending',
                    assessmentScenario: 'associate-edit',
                    value: 125000,
                    reviewModality: 'direct'  // Direct Review (value < $250k)
                }
            };

            const data = caseData[caseId] || caseData['CPC-2025-0042'];
            
            document.getElementById('case-detail-id').textContent = data.id;
            document.getElementById('case-detail-title').textContent = data.title;
            document.getElementById('case-detail-meta').textContent = data.meta;
            
            const statusBadge = document.getElementById('case-detail-status');
            statusBadge.textContent = data.status;
            statusBadge.className = 'status-badge ' + (data.statusClass || 'pending');
            
            // Set review modality
            const modalityBadge = document.getElementById('case-review-modality');
            if (modalityBadge) {
                if (data.reviewModality === 'panel') {
                    modalityBadge.innerHTML = 'üë• Panel Review';
                    modalityBadge.title = 'Panel Review required for cases above $250,000';
                } else {
                    modalityBadge.innerHTML = 'üë§ Direct Review';
                    modalityBadge.title = 'Direct Review for cases below $250,000';
                }
            }

            // Show case detail view
            showView('case-detail', null);
            
            // Keep Cases as active in nav
            document.getElementById('menu-cases').classList.add('active');

            // Show first tab
            switchCaseTab('evaluation-report');
            
            // Configure Assessment tab based on case scenario
            configureAssessmentTab(data.assessmentScenario || 'member-voting');
            
            // Handle fresh case - show empty states
            if (data.isFreshCase) {
                showFreshCaseState();
            } else {
                hideFreshCaseState();
            }

            showToast('Opened case: ' + caseId);
        }
        
        // Show empty states for fresh cases
        function showFreshCaseState() {
            // Update Review Team tab to show empty state
            const reviewTeamCard = document.querySelector('#tab-review-team .card-body');
            if (reviewTeamCard) {
                reviewTeamCard.innerHTML = `
                    <div style="text-align: center; padding: var(--spacing-xl); color: var(--text-muted);">
                        <i class="pi pi-users" style="font-size: 48px; margin-bottom: var(--spacing-md); opacity: 0.3;"></i>
                        <h3 style="margin: 0 0 var(--spacing-sm) 0; color: var(--text-secondary);">No Review Team Assigned</h3>
                        <p style="margin: 0 0 var(--spacing-md) 0; font-size: 13px;">This case has just arrived. Assign a review team to begin the review process.</p>
                        <button class="btn btn-primary" onclick="openReviewTeamModal()"><i class="pi pi-plus"></i> Assign Team</button>
                    </div>
                `;
            }
            
            // Update Meeting tab to show empty state
            const meetingTab = document.getElementById('tab-meeting');
            if (meetingTab) {
                meetingTab.innerHTML = `
                    <div style="text-align: center; padding: var(--spacing-xl); background: var(--surface-50); border-radius: var(--radius-lg); border: 2px dashed var(--surface-300);">
                        <i class="pi pi-calendar" style="font-size: 48px; color: var(--text-muted); margin-bottom: var(--spacing-md); opacity: 0.3;"></i>
                        <h3 style="margin: 0 0 var(--spacing-sm) 0; color: var(--text-secondary);">No Meetings Linked</h3>
                        <p style="margin: 0 0 var(--spacing-md) 0; color: var(--text-muted); font-size: 13px;">Link this case to a CPC meeting to discuss and review.</p>
                        <button class="btn btn-primary" onclick="openLinkMeetingModal()"><i class="pi pi-plus"></i> Link to Meeting</button>
                    </div>
                `;
            }
            
            // Update Deliberations tab to show empty state
            const deliberationsTab = document.getElementById('tab-deliberations');
            if (deliberationsTab) {
                const deliberationsBody = deliberationsTab.querySelector('.card-body');
                if (deliberationsBody) {
                    deliberationsBody.innerHTML = `
                        <div style="text-align: center; padding: var(--spacing-xl); color: var(--text-muted);">
                            <i class="pi pi-comments" style="font-size: 48px; margin-bottom: var(--spacing-md); opacity: 0.3;"></i>
                            <h3 style="margin: 0 0 var(--spacing-sm) 0; color: var(--text-secondary);">No Deliberations Yet</h3>
                            <p style="margin: 0; font-size: 13px;">Deliberations will appear here once the review team starts discussing the case.</p>
                        </div>
                    `;
                }
            }
            
            // Update Q&A tab to show empty state
            const qaTab = document.getElementById('tab-qa');
            if (qaTab) {
                const qaBody = qaTab.querySelector('.card-body');
                if (qaBody) {
                    qaBody.innerHTML = `
                        <div style="text-align: center; padding: var(--spacing-xl); color: var(--text-muted);">
                            <i class="pi pi-question-circle" style="font-size: 48px; margin-bottom: var(--spacing-md); opacity: 0.3;"></i>
                            <h3 style="margin: 0 0 var(--spacing-sm) 0; color: var(--text-secondary);">No Q&A Yet</h3>
                            <p style="margin: 0 0 var(--spacing-md) 0; font-size: 13px;">Questions and clarifications will appear here once the review begins.</p>
                            <button class="btn btn-secondary" onclick="openNewQuestionModal()"><i class="pi pi-plus"></i> Start Q&A</button>
                        </div>
                    `;
                }
            }
            
            // Update tab badges to show (0)
            document.querySelectorAll('#caseDetailTabs .tab').forEach(tab => {
                if (tab.textContent.includes('Deliberations')) {
                    tab.textContent = 'Deliberations (0)';
                }
                if (tab.textContent.includes('Q&A')) {
                    tab.textContent = 'Q&A (0)';
                }
            });
        }
        
        // Hide fresh case states and restore normal content
        function hideFreshCaseState() {
            // Restore tab badges
            document.querySelectorAll('#caseDetailTabs .tab').forEach(tab => {
                if (tab.textContent.includes('Deliberations')) {
                    tab.textContent = 'Deliberations (3)';
                }
                if (tab.textContent.includes('Q&A')) {
                    tab.textContent = 'Q&A (2)';
                }
            });
        }

        // ===== CASE DETAIL TABS =====
        function switchCaseTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Remove active from all tabs in case detail
            document.querySelectorAll('#caseDetailTabs .tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            const tabContent = document.getElementById('tab-' + tabName);
            if (tabContent) {
                tabContent.style.display = 'block';
            }
            
            // Mark tab as active
            const tabs = document.querySelectorAll('#caseDetailTabs .tab');
            tabs.forEach(tab => {
                if (tab.textContent.toLowerCase().includes(tabName.replace('-', ' ').split(' ')[0])) {
                    tab.classList.add('active');
                }
            });
        }

        // ===== MENU GROUP TOGGLE =====
        function toggleMenuGroup(header) {
            const group = header.parentElement;
            group.classList.toggle('collapsed');
        }

        // ===== COLLAPSIBLE SECTIONS =====
        function toggleSection(sectionName) {
            const content = document.getElementById('content-' + sectionName);
            const icon = document.getElementById('icon-' + sectionName);
            
            if (!content) return;
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                if (icon) icon.style.transform = 'rotate(0deg)';
            } else {
                content.classList.add('collapsed');
                if (icon) icon.style.transform = 'rotate(180deg)';
            }
        }

        // Track collapse state for tabs
        let evalSectionsCollapsed = false;
        let assessSectionsCollapsed = false;

        function toggleAllEvaluationSections() {
            // Correct section names from the HTML
            const sections = ['tender-summary', 'award-rec', 'competition', 'evaluation', 
                            'vfm', 'capacity', 'signoff'];
            evalSectionsCollapsed = !evalSectionsCollapsed;
            
            sections.forEach(sectionName => {
                const content = document.getElementById('content-' + sectionName);
                const icon = document.getElementById('icon-' + sectionName);
                if (content) {
                    if (evalSectionsCollapsed) {
                        content.classList.add('collapsed');
                        if (icon) icon.style.transform = 'rotate(180deg)';
                    } else {
                        content.classList.remove('collapsed');
                        if (icon) icon.style.transform = 'rotate(0deg)';
                    }
                }
            });
            
            // Update button text
            const icon = document.getElementById('evalToggleIcon');
            const text = document.getElementById('evalToggleText');
            if (evalSectionsCollapsed) {
                icon.className = 'pi pi-chevron-down';
                text.textContent = 'Expand All';
            } else {
                icon.className = 'pi pi-chevron-up';
                text.textContent = 'Collapse All';
            }
        }

        function toggleAllAssessmentSections() {
            const sections = document.querySelectorAll('#tab-assessment .card');
            assessSectionsCollapsed = !assessSectionsCollapsed;
            
            sections.forEach(card => {
                const collapseContent = card.querySelector('.collapse-content, .card-body');
                const icon = card.querySelector('.pi-chevron-down, .pi-chevron-up');
                if (collapseContent && collapseContent.style) {
                    collapseContent.style.display = assessSectionsCollapsed ? 'none' : 'block';
                }
                if (icon) {
                    icon.className = assessSectionsCollapsed ? 'pi pi-chevron-down' : 'pi pi-chevron-up';
                }
            });
            
            // Update button text
            const icon = document.getElementById('assessToggleIcon');
            const text = document.getElementById('assessToggleText');
            if (assessSectionsCollapsed) {
                icon.className = 'pi pi-chevron-down';
                text.textContent = 'Expand All';
            } else {
                icon.className = 'pi pi-chevron-up';
                text.textContent = 'Collapse All';
            }
        }

        function filterCaseQA() {
            const statusFilter = document.getElementById('qaStatusFilter').value;
            const searchFilter = document.getElementById('qaSearchFilter').value.toLowerCase();
            const threads = document.querySelectorAll('#tab-qa .qa-thread');
            
            threads.forEach(thread => {
                const statusBadge = thread.querySelector('.status-badge');
                const statusText = statusBadge ? statusBadge.textContent.toLowerCase() : '';
                const statusClass = statusBadge ? statusBadge.className.toLowerCase() : '';
                const text = thread.textContent.toLowerCase();
                
                let statusMatch = statusFilter === 'all';
                // Match based on both badge text and class
                if (statusFilter === 'pending') {
                    statusMatch = statusText.includes('pending') || statusClass.includes('pending');
                }
                if (statusFilter === 'answered') {
                    // "Resolved" threads have been answered
                    statusMatch = statusText.includes('resolved') || statusText.includes('answered') || statusClass.includes('success');
                }
                if (statusFilter === 'closed') {
                    statusMatch = statusText.includes('closed') || statusClass.includes('closed');
                }
                
                const searchMatch = !searchFilter || text.includes(searchFilter);
                
                thread.style.display = (statusMatch && searchMatch) ? 'block' : 'none';
            });
        }

        // ===== REVIEW TEAM MODAL =====
        function openReviewTeamModal(caseId) {
            document.getElementById('reviewTeamModal').classList.add('active');
        }

        function closeReviewTeamModal() {
            document.getElementById('reviewTeamModal').classList.remove('active');
        }

        function saveReviewTeam() {
            closeReviewTeamModal();
            showToast('‚úÖ Review team assignments saved successfully');
        }

        function removeFromRole(role, memberId) {
            showToast('Member removed from ' + role + ' role', 'warning');
        }

        function addMemberToRole(role) {
            showToast('Select a member to add as ' + role);
        }

        function quickAddMember(memberName) {
            showToast('Added ' + memberName + ' to review team');
        }

        // ===== DELIBERATIONS =====
        function addDeliberation() {
            const textarea = document.querySelector('#tab-deliberations textarea');
            if (textarea && textarea.value.trim()) {
                showToast('Comment posted to deliberations');
                textarea.value = '';
            } else {
                showToast('Please enter a comment', 'warning');
            }
        }

        // ===== HEADER ACTIONS =====
        
        // Accessibility Panel
        function openAccessibilityPanel() {
            const existing = document.getElementById('accessibilityPanel');
            if (existing) {
                existing.remove();
                return;
            }
            // Close other panels
            closeAllHeaderPanels();

            const panelHtml = `
                <div id="accessibilityPanel" class="accessibility-panel open" role="dialog" aria-labelledby="a11y-title" aria-modal="true">
                    <div class="accessibility-panel-header">
                        <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                            <i class="pi pi-eye" style="color: var(--primary-500);"></i>
                            <span id="a11y-title" style="font-weight: 600;">Accessibility Options</span>
                        </div>
                        <button onclick="document.getElementById('accessibilityPanel').remove()" style="background: none; border: none; cursor: pointer;" aria-label="Close accessibility panel">
                            <i class="pi pi-times"></i>
                        </button>
                    </div>
                    <div style="padding: var(--spacing-md);">
                        <div class="accessibility-option">
                            <div>
                                <div style="font-weight: 500; font-size: 13px;">High Contrast</div>
                                <div style="font-size: 11px; color: var(--text-muted);">Increase color contrast for better visibility</div>
                            </div>
                            <div class="accessibility-toggle ${document.body.classList.contains('high-contrast') ? 'active' : ''}" 
                                 onclick="toggleAccessibility('high-contrast', this)"
                                 role="switch"
                                 tabindex="0"></div>
                        </div>
                        <div class="accessibility-option">
                            <div>
                                <div style="font-weight: 500; font-size: 13px;">Large Text</div>
                                <div style="font-size: 11px; color: var(--text-muted);">Increase text size throughout the app</div>
                            </div>
                            <div class="accessibility-toggle ${document.body.classList.contains('large-text') ? 'active' : ''}" 
                                 onclick="toggleAccessibility('large-text', this)"
                                 role="switch"
                                 tabindex="0"></div>
                        </div>
                        <div class="accessibility-option">
                            <div>
                                <div style="font-weight: 500; font-size: 13px;">Reduced Motion</div>
                                <div style="font-size: 11px; color: var(--text-muted);">Minimize animations and transitions</div>
                            </div>
                            <div class="accessibility-toggle ${document.body.classList.contains('reduced-motion') ? 'active' : ''}" 
                                 onclick="toggleAccessibility('reduced-motion', this)"
                                 role="switch"
                                 tabindex="0"></div>
                        </div>
                        <div style="padding: var(--spacing-md); background: var(--info-50); border-radius: var(--radius-sm); margin-top: var(--spacing-sm);">
                            <div style="font-size: 11px; color: var(--info-600);">
                                <strong>Keyboard Shortcuts:</strong><br>
                                <span style="font-family: monospace;">Alt + 1</span> - Dashboard<br>
                                <span style="font-family: monospace;">Alt + H</span> - Help<br>
                                <span style="font-family: monospace;">Esc</span> - Close panels
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', panelHtml);
        }

        function toggleAccessibility(mode, element) {
            document.body.classList.toggle(mode);
            element.classList.toggle('active');
            showToast(mode.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase()) + (document.body.classList.contains(mode) ? ' enabled' : ' disabled'));
        }

        // Language Selector
        function openLanguageSelector() {
            const existing = document.getElementById('languagePanel');
            if (existing) {
                existing.remove();
                return;
            }
            closeAllHeaderPanels();

            const languages = [
                { code: 'EN', name: 'English', flag: 'üá¨üáß' },
                { code: 'FR', name: 'Fran√ßais', flag: 'üá´üá∑' },
                { code: 'ES', name: 'Espa√±ol', flag: 'üá™üá∏' },
                { code: 'AR', name: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©', flag: 'üá∏üá¶', rtl: true },
                { code: 'PT', name: 'Portugu√™s', flag: 'üáµüáπ' },
                { code: 'RU', name: '–†—É—Å—Å–∫–∏–π', flag: 'üá∑üá∫' }
            ];

            const panelHtml = `
                <div id="languagePanel" style="position: fixed; top: 70px; right: 180px; width: 220px; background: var(--surface-0); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); z-index: 10000; border: 1px solid var(--surface-200);" role="dialog" aria-label="Language selection">
                    <div style="padding: var(--spacing-md); border-bottom: 1px solid var(--surface-200); display: flex; justify-content: space-between; align-items: center;">
                        <span style="font-weight: 600; font-size: 13px;">üåê Select Language</span>
                        <button onclick="document.getElementById('languagePanel').remove()" style="background: none; border: none; cursor: pointer;" aria-label="Close">
                            <i class="pi pi-times"></i>
                        </button>
                    </div>
                    <div style="padding: var(--spacing-sm);">
                        ${languages.map(lang => `
                            <div onclick="selectLanguage('${lang.code}', '${lang.name}')" 
                                 style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm); border-radius: var(--radius-sm); cursor: pointer; transition: background 0.2s;"
                                 onmouseover="this.style.background='var(--primary-50)'"
                                 onmouseout="this.style.background='transparent'"
                                 role="button"
                                 tabindex="0">
                                <span style="font-size: 18px;">${lang.flag}</span>
                                <span style="font-size: 13px; ${lang.rtl ? 'direction: rtl;' : ''}">${lang.name}</span>
                                ${lang.code === 'EN' ? '<i class="pi pi-check" style="margin-left: auto; color: var(--success-500);"></i>' : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', panelHtml);
        }

        function selectLanguage(code, name) {
            document.getElementById('languagePanel').remove();
            showToast('üåê Language changed to ' + name);
        }

        // AI Assistant
        function openAIAssistant() {
            const existing = document.getElementById('aiAssistantPanel');
            if (existing) {
                existing.remove();
                return;
            }
            closeAllHeaderPanels();

            const panelHtml = `
                <div id="aiAssistantPanel" style="position: fixed; top: 70px; right: 100px; width: 380px; max-height: 480px; background: var(--surface-0); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); z-index: 10000; border: 1px solid var(--surface-200); display: flex; flex-direction: column;" role="dialog" aria-labelledby="ai-title">
                    <div style="padding: var(--spacing-lg); background: linear-gradient(135deg, #8b5cf6 0%, #3b82f6 100%); border-radius: var(--radius-lg) var(--radius-lg) 0 0; color: white;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                <div style="width: 36px; height: 36px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                    <i class="pi pi-bolt" style="font-size: 18px;"></i>
                                </div>
                                <div>
                                    <div id="ai-title" style="font-weight: 600; font-size: 14px;">AI Procurement Assistant</div>
                                    <div style="font-size: 11px; opacity: 0.8;">Powered by UNOPS AI</div>
                                </div>
                            </div>
                            <button onclick="document.getElementById('aiAssistantPanel').remove()" style="background: rgba(255,255,255,0.2); border: none; width: 28px; height: 28px; border-radius: 50%; cursor: pointer; color: white;" aria-label="Close AI assistant">
                                <i class="pi pi-times"></i>
                            </button>
                        </div>
                    </div>
                    <div style="flex: 1; padding: var(--spacing-md); overflow-y: auto; max-height: 280px;">
                        <div style="background: var(--surface-50); padding: var(--spacing-md); border-radius: var(--radius-md); margin-bottom: var(--spacing-md);">
                            <div style="font-size: 12px; color: var(--text-primary);">
                                üëã Hello! I'm your AI assistant. I can help you with:
                            </div>
                            <ul style="margin: 8px 0 0 16px; padding: 0; font-size: 12px; color: var(--text-secondary);">
                                <li>Reviewing CPC case submissions</li>
                                <li>Explaining procurement policies</li>
                                <li>Drafting Q&A responses</li>
                                <li>Understanding evaluation reports</li>
                            </ul>
                        </div>
                        <div style="display: grid; gap: var(--spacing-sm);">
                            <button onclick="askAI('How do I review this case?')" style="text-align: left; padding: var(--spacing-sm); background: var(--primary-50); border: 1px solid var(--primary-200); border-radius: var(--radius-sm); cursor: pointer; font-size: 12px;">
                                üí° How do I review this case?
                            </button>
                            <button onclick="askAI('Explain the four review principles')" style="text-align: left; padding: var(--spacing-sm); background: var(--primary-50); border: 1px solid var(--primary-200); border-radius: var(--radius-sm); cursor: pointer; font-size: 12px;">
                                üìã Explain the four review principles
                            </button>
                            <button onclick="askAI('Help draft a clarification')" style="text-align: left; padding: var(--spacing-sm); background: var(--primary-50); border: 1px solid var(--primary-200); border-radius: var(--radius-sm); cursor: pointer; font-size: 12px;">
                                ‚úçÔ∏è Help me draft a clarification request
                            </button>
                        </div>
                    </div>
                    <div style="padding: var(--spacing-md); border-top: 1px solid var(--surface-200);">
                        <div style="display: flex; gap: var(--spacing-sm);">
                            <input type="text" id="aiInput" placeholder="Ask me anything about CPC reviews..." style="flex: 1; padding: var(--spacing-sm); border: 1px solid var(--surface-300); border-radius: var(--radius-sm); font-size: 12px;" aria-label="Ask AI a question">
                            <button onclick="askAI(document.getElementById('aiInput').value)" style="background: linear-gradient(135deg, #8b5cf6 0%, #3b82f6 100%); color: white; border: none; padding: var(--spacing-sm) var(--spacing-md); border-radius: var(--radius-sm); cursor: pointer;">
                                <i class="pi pi-send"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', panelHtml);
        }

        function askAI(question) {
            if (!question || !question.trim()) return;
            showToast('ü§ñ AI is thinking... (Feature coming soon)');
            const input = document.getElementById('aiInput');
            if (input) input.value = '';
        }

        // Help Center
        function openHelpCenter() {
            const existing = document.getElementById('helpPanel');
            if (existing) {
                existing.remove();
                return;
            }
            closeAllHeaderPanels();

            const panelHtml = `
                <div id="helpPanel" style="position: fixed; top: 70px; right: 60px; width: 340px; background: var(--surface-0); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); z-index: 10000; border: 1px solid var(--surface-200);" role="dialog" aria-labelledby="help-title">
                    <div style="padding: var(--spacing-lg); border-bottom: 1px solid var(--surface-200);">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                                <i class="pi pi-question-circle" style="font-size: 20px; color: var(--primary-500);"></i>
                                <span id="help-title" style="font-weight: 600;">Help Center</span>
                            </div>
                            <button onclick="document.getElementById('helpPanel').remove()" style="background: none; border: none; cursor: pointer;" aria-label="Close help">
                                <i class="pi pi-times"></i>
                            </button>
                        </div>
                        <input type="text" placeholder="Search help articles..." style="width: 100%; padding: var(--spacing-sm); border: 1px solid var(--surface-300); border-radius: var(--radius-sm); margin-top: var(--spacing-md); font-size: 13px;" aria-label="Search help">
                    </div>
                    <div style="padding: var(--spacing-md); max-height: 320px; overflow-y: auto;">
                        <div style="font-size: 11px; color: var(--text-muted); text-transform: uppercase; margin-bottom: var(--spacing-sm);">Quick Links</div>
                        <div style="display: grid; gap: var(--spacing-sm);">
                            <a href="#" onclick="event.preventDefault(); showToast('üìñ Opening documentation...')" style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm); background: var(--surface-50); border-radius: var(--radius-sm); text-decoration: none; color: var(--text-primary); font-size: 13px;">
                                <i class="pi pi-book" style="color: var(--primary-500);"></i>
                                <span>CPC User Guide</span>
                            </a>
                            <a href="#" onclick="event.preventDefault(); showToast('üé• Opening video tutorials...')" style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm); background: var(--surface-50); border-radius: var(--radius-sm); text-decoration: none; color: var(--text-primary); font-size: 13px;">
                                <i class="pi pi-video" style="color: var(--success-500);"></i>
                                <span>Video Tutorials</span>
                            </a>
                            <a href="#" onclick="event.preventDefault(); showToast('‚ùì Opening FAQ...')" style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm); background: var(--surface-50); border-radius: var(--radius-sm); text-decoration: none; color: var(--text-primary); font-size: 13px;">
                                <i class="pi pi-list" style="color: var(--warning-500);"></i>
                                <span>Frequently Asked Questions</span>
                            </a>
                            <a href="#" onclick="event.preventDefault(); showToast('üìß Contact support...')" style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm); background: var(--surface-50); border-radius: var(--radius-sm); text-decoration: none; color: var(--text-primary); font-size: 13px;">
                                <i class="pi pi-envelope" style="color: var(--info-500);"></i>
                                <span>Contact Support</span>
                            </a>
                        </div>
                        <div style="font-size: 11px; color: var(--text-muted); text-transform: uppercase; margin: var(--spacing-lg) 0 var(--spacing-sm) 0;">Popular Topics</div>
                        <div style="display: flex; flex-wrap: wrap; gap: var(--spacing-xs);">
                            <span style="padding: 4px 10px; background: var(--primary-50); color: var(--primary-600); border-radius: var(--radius-sm); font-size: 11px; cursor: pointer;">Case Review</span>
                            <span style="padding: 4px 10px; background: var(--primary-50); color: var(--primary-600); border-radius: var(--radius-sm); font-size: 11px; cursor: pointer;">Deliberations</span>
                            <span style="padding: 4px 10px; background: var(--primary-50); color: var(--primary-600); border-radius: var(--radius-sm); font-size: 11px; cursor: pointer;">Voting</span>
                            <span style="padding: 4px 10px; background: var(--primary-50); color: var(--primary-600); border-radius: var(--radius-sm); font-size: 11px; cursor: pointer;">Q&A</span>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', panelHtml);
        }

        // Notifications Panel
        function openNotificationsPanel() {
            const existing = document.getElementById('notificationsPanel');
            if (existing) {
                existing.remove();
                return;
            }
            closeAllHeaderPanels();

            const notifications = [
                { type: 'urgent', icon: 'üî¥', title: 'Case review deadline approaching', desc: 'CPC/2024/047 review due in 2 hours', time: '5 min ago' },
                { type: 'info', icon: 'üí¨', title: 'New Q&A from Submitting Officer', desc: 'Kenya Hub asked about evaluation criteria', time: '15 min ago' },
                { type: 'success', icon: '‚úÖ', title: 'Vote recorded', desc: 'Your vote on CPC/2024/038 has been recorded', time: '1 hour ago' },
                { type: 'warning', icon: '‚ö†Ô∏è', title: 'Deliberation input needed', desc: 'CPC/2024/041 awaiting your technical input', time: '2 hours ago' },
                { type: 'info', icon: 'üì®', title: 'New case submitted', desc: 'CPC/2024/048 submitted by DRC Hub', time: '3 hours ago' },
                { type: 'info', icon: 'üë•', title: 'Expert assigned', desc: 'Dr. Ahmed Hassan assigned as IT expert', time: 'Yesterday' },
                { type: 'success', icon: 'üìã', title: 'Case approved', desc: 'CPC/2024/035 received PA approval', time: 'Yesterday' }
            ];

            const panelHtml = `
                <div id="notificationsPanel" style="position: fixed; top: 70px; right: 20px; width: 360px; background: var(--surface-0); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); z-index: 10000; border: 1px solid var(--surface-200);" role="dialog" aria-labelledby="notif-title">
                    <div style="padding: var(--spacing-lg); border-bottom: 1px solid var(--surface-200); display: flex; justify-content: space-between; align-items: center;">
                        <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                            <i class="pi pi-bell" style="font-size: 18px; color: var(--primary-500);"></i>
                            <span id="notif-title" style="font-weight: 600;">Notifications</span>
                            <span style="background: var(--danger-500); color: white; font-size: 10px; padding: 2px 8px; border-radius: 10px; font-weight: 600;">7 new</span>
                        </div>
                        <button onclick="document.getElementById('notificationsPanel').remove()" style="background: none; border: none; cursor: pointer;" aria-label="Close notifications">
                            <i class="pi pi-times"></i>
                        </button>
                    </div>
                    <div style="max-height: 380px; overflow-y: auto;">
                        ${notifications.map((notif, i) => `
                            <div style="padding: var(--spacing-md); border-bottom: 1px solid var(--surface-100); cursor: pointer; transition: background 0.2s; ${i < 3 ? 'background: var(--primary-50);' : ''}"
                                 onmouseover="this.style.background='var(--surface-50)'"
                                 onmouseout="this.style.background='${i < 3 ? 'var(--primary-50)' : 'transparent'}'"
                                 role="button"
                                 tabindex="0">
                                <div style="display: flex; gap: var(--spacing-sm);">
                                    <span style="font-size: 16px;">${notif.icon}</span>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600; font-size: 12px; color: var(--text-primary);">${notif.title}</div>
                                        <div style="font-size: 11px; color: var(--text-secondary); margin-top: 2px;">${notif.desc}</div>
                                        <div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">${notif.time}</div>
                                    </div>
                                    ${i < 3 ? '<div style="width: 8px; height: 8px; background: var(--primary-500); border-radius: 50%; flex-shrink: 0;"></div>' : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="padding: var(--spacing-md); border-top: 1px solid var(--surface-200); text-align: center;">
                        <button onclick="showToast('üì¨ Viewing all notifications...'); document.getElementById('notificationsPanel').remove();" style="background: none; border: none; color: var(--primary-500); font-size: 13px; font-weight: 600; cursor: pointer;">
                            View All Notifications
                        </button>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', panelHtml);
        }

        // Helper to close all header panels
        function closeAllHeaderPanels() {
            const panels = ['accessibilityPanel', 'languagePanel', 'aiAssistantPanel', 'helpPanel', 'notificationsPanel'];
            panels.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.remove();
            });
        }

        // ===== ASSESSMENT & VOTING FUNCTIONS =====
        function toggleAssessmentSection(sectionNum) {
            const content = document.getElementById('assessment-content-' + sectionNum);
            const chevron = document.getElementById('assessment-chevron-' + sectionNum);
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                chevron.style.transform = 'rotate(0deg)';
            } else {
                content.style.display = 'none';
                chevron.style.transform = 'rotate(-90deg)';
            }
        }

        function configureAssessmentTab(scenario) {
            // scenario: 'associate-edit', 'member-voting', 'chair-rating', 'completed'
            
            // Reset all states
            document.getElementById('associate-principles-view').style.display = 'block';
            document.getElementById('associate-principles-form').style.display = 'none';
            document.getElementById('member-vote-form').style.display = 'block';
            document.getElementById('chair-locked-state').style.display = 'block';
            document.getElementById('chair-active-state').style.display = 'none';
            
            // Progress indicators
            const step1 = document.getElementById('progress-step-1');
            const step2 = document.getElementById('progress-step-2');
            const step3 = document.getElementById('progress-step-3');
            const line1 = document.getElementById('progress-line-1');
            const line2 = document.getElementById('progress-line-2');
            
            // Status badges
            const associateBadge = document.getElementById('associate-status-badge');
            const votingBadge = document.getElementById('voting-status-badge');
            const chairBadge = document.getElementById('chair-status-badge');
            
            if (scenario === 'associate-edit') {
                // CPC Associate is editing their recommendation
                document.getElementById('associate-principles-view').style.display = 'none';
                document.getElementById('associate-principles-form').style.display = 'block';
                document.getElementById('member-vote-form').style.display = 'none';
                
                step1.innerHTML = '1';
                step1.style.background = 'var(--primary-500)';
                step2.style.background = 'var(--surface-300)';
                step2.style.color = 'var(--text-muted)';
                line1.style.background = 'var(--surface-300)';
                
                associateBadge.textContent = 'Draft';
                associateBadge.style.background = 'var(--warning-100)';
                associateBadge.style.color = 'var(--warning-700)';
                votingBadge.textContent = 'Pending';
                votingBadge.style.background = 'var(--surface-100)';
                votingBadge.style.color = 'var(--text-muted)';
                chairBadge.textContent = 'Pending';
                
            } else if (scenario === 'member-voting') {
                // Members are voting (default scenario)
                step1.innerHTML = '‚úì';
                step1.style.background = 'var(--success-500)';
                step2.style.background = 'var(--primary-500)';
                step2.style.color = 'white';
                line1.style.background = 'var(--success-500)';
                
                associateBadge.textContent = 'Completed';
                associateBadge.style.background = 'var(--success-100)';
                associateBadge.style.color = 'var(--success-700)';
                votingBadge.textContent = 'In Progress';
                votingBadge.style.background = 'var(--primary-100)';
                votingBadge.style.color = 'var(--primary-700)';
                chairBadge.textContent = 'Pending';
                chairBadge.style.background = 'var(--surface-100)';
                chairBadge.style.color = 'var(--text-muted)';
                
            } else if (scenario === 'chair-rating') {
                // Chair is doing quality rating
                document.getElementById('member-vote-form').style.display = 'none';
                document.getElementById('chair-locked-state').style.display = 'none';
                document.getElementById('chair-active-state').style.display = 'block';
                
                step1.innerHTML = '‚úì';
                step1.style.background = 'var(--success-500)';
                step2.innerHTML = '‚úì';
                step2.style.background = 'var(--success-500)';
                step3.style.background = 'var(--primary-500)';
                step3.style.color = 'white';
                line1.style.background = 'var(--success-500)';
                line2.style.background = 'var(--success-500)';
                
                // Update voting grid to show all voted
                document.getElementById('voting-progress-bar').style.width = '100%';
                document.getElementById('voting-progress-text').textContent = '4/4 Votes';
                
                associateBadge.textContent = 'Completed';
                associateBadge.style.background = 'var(--success-100)';
                associateBadge.style.color = 'var(--success-700)';
                votingBadge.textContent = 'Completed';
                votingBadge.style.background = 'var(--success-100)';
                votingBadge.style.color = 'var(--success-700)';
                chairBadge.textContent = 'In Progress';
                chairBadge.style.background = 'var(--primary-100)';
                chairBadge.style.color = 'var(--primary-700)';
                
            } else if (scenario === 'completed') {
                // All done
                document.getElementById('member-vote-form').style.display = 'none';
                document.getElementById('chair-locked-state').style.display = 'none';
                document.getElementById('chair-active-state').style.display = 'block';
                
                step1.innerHTML = '‚úì';
                step1.style.background = 'var(--success-500)';
                step2.innerHTML = '‚úì';
                step2.style.background = 'var(--success-500)';
                step3.innerHTML = '‚úì';
                step3.style.background = 'var(--success-500)';
                line1.style.background = 'var(--success-500)';
                line2.style.background = 'var(--success-500)';
                
                document.getElementById('voting-progress-bar').style.width = '100%';
                document.getElementById('voting-progress-text').textContent = '4/4 Votes';
                
                associateBadge.textContent = 'Completed';
                associateBadge.style.background = 'var(--success-100)';
                associateBadge.style.color = 'var(--success-700)';
                votingBadge.textContent = 'Completed';
                votingBadge.style.background = 'var(--success-100)';
                votingBadge.style.color = 'var(--success-700)';
                chairBadge.textContent = 'Completed';
                chairBadge.style.background = 'var(--success-100)';
                chairBadge.style.color = 'var(--success-700)';
                
            } else if (scenario === 'fresh') {
                // Fresh case - Only Associate Recommendation is active, rest empty
                document.getElementById('associate-principles-view').style.display = 'none';
                document.getElementById('associate-principles-form').style.display = 'block';
                document.getElementById('member-vote-form').style.display = 'none';
                document.getElementById('chair-locked-state').style.display = 'block';
                document.getElementById('chair-active-state').style.display = 'none';
                
                // Step 1 is active (not completed), rest are pending
                step1.innerHTML = '1';
                step1.style.background = 'var(--primary-500)';
                step1.style.color = 'white';
                step2.innerHTML = '2';
                step2.style.background = 'var(--surface-300)';
                step2.style.color = 'var(--text-muted)';
                step3.innerHTML = '3';
                step3.style.background = 'var(--surface-300)';
                step3.style.color = 'var(--text-muted)';
                line1.style.background = 'var(--surface-300)';
                line2.style.background = 'var(--surface-300)';
                
                associateBadge.textContent = 'Not Started';
                associateBadge.style.background = 'var(--info-100)';
                associateBadge.style.color = 'var(--info-700)';
                votingBadge.textContent = 'Pending';
                votingBadge.style.background = 'var(--surface-100)';
                votingBadge.style.color = 'var(--text-muted)';
                chairBadge.textContent = 'Pending';
                chairBadge.style.background = 'var(--surface-100)';
                chairBadge.style.color = 'var(--text-muted)';
                
                // Reset voting progress
                const votingProgressBar = document.getElementById('voting-progress-bar');
                const votingProgressText = document.getElementById('voting-progress-text');
                if (votingProgressBar) votingProgressBar.style.width = '0%';
                if (votingProgressText) votingProgressText.textContent = '0/4 Votes';
            }
        }

        function submitMemberVote(vote) {
            if (vote === 'agree') {
                showToast('‚úÖ Your vote (Agree) has been recorded', 'success');
            } else {
                showToast('‚ùå Your vote (Disagree) has been recorded', 'warning');
            }
        }

        function submitChairVote(vote) {
            if (vote === 'agree') {
                showToast('‚úÖ Chair vote (Agree) recorded', 'success');
            } else {
                showToast('‚ùå Chair vote (Disagree) recorded', 'warning');
            }
        }

        function submitChairRating() {
            showToast('‚≠ê Quality rating and vote submitted successfully', 'success');
        }

        function submitAssociateRecommendation() {
            showToast('üìã Recommendation submitted for member voting', 'success');
        }

        // ===== POOL MANAGEMENT FUNCTIONS =====
        function switchPoolTab(tabName) {
            // Hide all pool tab contents
            document.querySelectorAll('.pool-tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Remove active from all pool tabs
            document.querySelectorAll('#poolManagementTabs .tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            const tabContent = document.getElementById('pool-tab-' + tabName);
            if (tabContent) {
                tabContent.style.display = 'block';
            }
            
            // Mark clicked tab as active
            event.target.classList.add('active');
        }

        function selectQuarter(quarter) {
            // Remove active from all quarter buttons
            document.querySelectorAll('.quarter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active to clicked button
            event.target.classList.add('active');
            
            showToast('üìÖ Viewing Q' + quarter + ' assignments', 'info');
        }

        function updatePoolAssignments() {
            const year = document.getElementById('poolYear').value;
            showToast('üìÖ Viewing ' + year + ' assignments', 'info');
        }

        function autoAssignRegions() {
            showToast('üîÑ Auto-assigning members based on rules...', 'info');
            setTimeout(() => {
                document.getElementById('autoAssignModal').classList.add('active');
            }, 1000);
        }

        function closeAutoAssignModal() {
            document.getElementById('autoAssignModal').classList.remove('active');
        }

        function acceptAutoAssignment() {
            closeAutoAssignModal();
            showToast('‚úì Auto-assignment saved. Ready to publish.', 'success');
        }

        function publishAssignments() {
            showToast('üìß Sending invitations to all assigned members...', 'success');
            setTimeout(() => {
                showToast('‚úì 18 invitations sent successfully', 'success');
            }, 1500);
        }

        // Region data for assignments
        const regionData = {
            'europe': {
                name: 'Europe & CIS',
                icon: 'üá™üá∫',
                assigned: [
                    { id: 'MG', name: 'Maria Garcia', role: 'Chair', practice: 'Procurement', attendance: '95%', status: 'confirmed', consecutive: false },
                    { id: 'JS', name: 'John Smith', role: 'Member', practice: 'ICA', attendance: '88%', status: 'confirmed', consecutive: false },
                    { id: 'AK', name: 'Anna Kowalski', role: 'Member', practice: 'Finance', attendance: '92%', status: 'pending', consecutive: false },
                    { id: 'PM', name: 'Peter Mueller', role: 'Associate', practice: 'Procurement', attendance: '90%', status: 'invited', consecutive: false }
                ],
                previousCount: 3
            },
            'asia': {
                name: 'Asia Pacific',
                icon: 'üåè',
                assigned: [
                    { id: 'DC', name: 'David Chen', role: 'Chair', practice: 'Procurement', attendance: '97%', status: 'confirmed', consecutive: false },
                    { id: 'LC', name: 'Luis Chen', role: 'Member', practice: 'ICA', attendance: '85%', status: 'confirmed', consecutive: false },
                    { id: 'YT', name: 'Yuki Tanaka', role: 'Member', practice: 'Finance', attendance: '90%', status: 'pending', consecutive: false }
                ],
                previousCount: 4
            },
            'africa': {
                name: 'Africa',
                icon: 'üåç',
                assigned: [
                    { id: 'AH', name: 'Ahmed Hassan', role: 'Chair', practice: 'Procurement', attendance: '93%', status: 'confirmed', consecutive: false },
                    { id: 'FK', name: 'Fatima Khalil', role: 'Member', practice: 'ICA', attendance: '91%', status: 'confirmed', consecutive: false },
                    { id: 'KO', name: 'Kofi Osei', role: 'Member', practice: 'Finance', attendance: '87%', status: 'declined', consecutive: false }
                ],
                previousCount: 3
            },
            'americas': {
                name: 'Americas',
                icon: 'üåé',
                assigned: [
                    { id: 'SJ', name: 'Sarah Johnson', role: 'Chair', practice: 'Procurement', attendance: '94%', status: 'confirmed', consecutive: false },
                    { id: 'MR', name: 'Miguel Rodriguez', role: 'Member', practice: 'ICA', attendance: '89%', status: 'pending', consecutive: false },
                    { id: 'CP', name: 'Carlos Perez', role: 'Member', practice: 'Finance', attendance: '86%', status: 'confirmed', consecutive: false }
                ],
                previousCount: 3
            },
            'middleeast': {
                name: 'Middle East',
                icon: 'üèúÔ∏è',
                assigned: [
                    { id: 'NA', name: 'Nadia Al-Rashid', role: 'Chair', practice: 'Procurement', attendance: '96%', status: 'confirmed', consecutive: false },
                    { id: 'OB', name: 'Omar Bakri', role: 'Member', practice: 'ICA', attendance: '84%', status: 'confirmed', consecutive: false },
                    { id: 'LS', name: 'Layla Said', role: 'Member', practice: 'Finance', attendance: '91%', status: 'pending', consecutive: false }
                ],
                previousCount: 2
            },
            'hq': {
                name: 'HQ / Global',
                icon: 'üè¢',
                assigned: [
                    { id: 'EW', name: 'Emma Wilson', role: 'Chair', practice: 'Procurement', attendance: '98%', status: 'confirmed', consecutive: false },
                    { id: 'RK', name: 'Robert Kim', role: 'Member', practice: 'ICA', attendance: '92%', status: 'confirmed', consecutive: false }
                ],
                previousCount: 2
            }
        };

        const availableMembers = [
            { id: 'TN', name: 'Thomas Nielsen', role: 'Member', practice: 'Procurement', attendance: '89%' },
            { id: 'HM', name: 'Helena M√ºller', role: 'Member', practice: 'ICA', attendance: '91%' },
            { id: 'JL', name: 'Jean Leclerc', role: 'Chair', practice: 'Finance', attendance: '94%' },
            { id: 'AS', name: 'Aisha Saeed', role: 'Member', practice: 'Procurement', attendance: '87%' },
            { id: 'PK', name: 'Pavel Kozlov', role: 'Member', practice: 'ICA', attendance: '90%' },
            { id: 'MB', name: 'Maria Bianchi', role: 'Member', practice: 'Finance', attendance: '93%' },
            { id: 'KW', name: 'Kenji Watanabe', role: 'Member', practice: 'Procurement', attendance: '88%' },
            { id: 'LV', name: 'Laura Vargas', role: 'Chair', practice: 'ICA', attendance: '95%' }
        ];

        let currentRegion = null;

        function openRegionAssignmentModal(region) {
            currentRegion = region;
            const data = regionData[region];
            
            if (!data) {
                showToast('Region not found', 'error');
                return;
            }
            
            // Update modal header
            document.getElementById('regionModalIcon').textContent = data.icon;
            document.getElementById('regionModalName').textContent = data.name;
            document.getElementById('regionPreviousMembers').textContent = data.previousCount + ' members';
            
            // Render assigned members
            renderAssignedMembers(data.assigned);
            
            // Render available members
            renderAvailableMembers();
            
            // Update balance info
            updateBalanceInfo(data.assigned);
            
            // Show modal
            document.getElementById('regionAssignmentModal').classList.add('active');
        }

        function closeRegionAssignmentModal() {
            document.getElementById('regionAssignmentModal').classList.remove('active');
            currentRegion = null;
        }

        function renderAssignedMembers(members) {
            const container = document.getElementById('regionAssignedMembers');
            document.getElementById('regionAssignedCount').textContent = members.length;
            
            if (members.length === 0) {
                container.innerHTML = '<div style="padding: var(--spacing-lg); text-align: center; color: var(--text-muted); background: var(--surface-50); border-radius: var(--radius-md);">No members assigned. Add members from the available pool below.</div>';
                return;
            }
            
            container.innerHTML = members.map(member => {
                const statusColors = {
                    'confirmed': { bg: 'var(--success-100)', color: 'var(--success-700)', text: 'Confirmed' },
                    'pending': { bg: 'var(--warning-100)', color: 'var(--warning-700)', text: 'Pending' },
                    'invited': { bg: 'var(--surface-200)', color: 'var(--text-muted)', text: 'Invited' },
                    'declined': { bg: 'var(--danger-100)', color: 'var(--danger-700)', text: 'Declined' }
                };
                const status = statusColors[member.status] || statusColors['pending'];
                
                return `
                    <div class="assigned-member-card" style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm) var(--spacing-md); background: var(--surface-0); border: 1px solid var(--surface-200); border-radius: var(--radius-md);">
                        <div class="member-avatar" style="width: 36px; height: 36px; font-size: 12px;">${member.id}</div>
                        <div style="flex: 1;">
                            <div style="font-weight: 500; font-size: 13px;">${member.name} ${member.consecutive ? '‚ö†Ô∏è' : ''}</div>
                            <div style="font-size: 11px; color: var(--text-muted);">${member.role} ‚Ä¢ ${member.practice} ‚Ä¢ ${member.attendance} att.</div>
                        </div>
                        <span style="padding: 2px 8px; background: ${status.bg}; color: ${status.color}; border-radius: var(--radius-sm); font-size: 10px; font-weight: 500;">${status.text}</span>
                        <button class="btn btn-sm" style="padding: 4px 8px; background: var(--surface-100); border: none;" onclick="removeMemberFromRegion('${member.id}')" title="Remove">
                            <i class="pi pi-times" style="font-size: 12px; color: var(--text-muted);"></i>
                        </button>
                    </div>
                `;
            }).join('');
        }

        function renderAvailableMembers() {
            const container = document.getElementById('regionAvailableMembers');
            const practiceFilter = document.getElementById('regionFilterPractice').value;
            const roleFilter = document.getElementById('regionFilterRole').value;
            const searchTerm = document.getElementById('regionSearchInput').value.toLowerCase();
            
            // Get assigned member IDs for current region
            const assignedIds = currentRegion ? regionData[currentRegion].assigned.map(m => m.id) : [];
            
            // Filter available members
            let filtered = availableMembers.filter(m => !assignedIds.includes(m.id));
            
            if (practiceFilter !== 'all') {
                filtered = filtered.filter(m => m.practice.toLowerCase() === practiceFilter);
            }
            if (roleFilter !== 'all') {
                filtered = filtered.filter(m => m.role.toLowerCase() === roleFilter);
            }
            if (searchTerm) {
                filtered = filtered.filter(m => m.name.toLowerCase().includes(searchTerm));
            }
            
            if (filtered.length === 0) {
                container.innerHTML = '<div style="grid-column: 1/-1; padding: var(--spacing-md); text-align: center; color: var(--text-muted);">No available members match the filters</div>';
                return;
            }
            
            container.innerHTML = filtered.map(member => `
                <div class="available-member-card" style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm); background: var(--surface-50); border: 1px dashed var(--surface-300); border-radius: var(--radius-sm); cursor: pointer; transition: all 0.2s;" onclick="addMemberToRegion('${member.id}')" onmouseover="this.style.borderColor='var(--primary-400)'; this.style.background='var(--primary-50)'" onmouseout="this.style.borderColor='var(--surface-300)'; this.style.background='var(--surface-50)'">
                    <div class="member-avatar" style="width: 28px; height: 28px; font-size: 10px;">${member.id}</div>
                    <div style="flex: 1; min-width: 0;">
                        <div style="font-weight: 500; font-size: 12px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${member.name}</div>
                        <div style="font-size: 10px; color: var(--text-muted);">${member.role} ‚Ä¢ ${member.practice}</div>
                    </div>
                    <span style="font-size: 10px; color: var(--text-muted);">${member.attendance}</span>
                    <i class="pi pi-plus" style="font-size: 10px; color: var(--primary-500);"></i>
                </div>
            `).join('');
        }

        function filterAvailableMembers() {
            renderAvailableMembers();
        }

        function addMemberToRegion(memberId) {
            if (!currentRegion) return;
            
            // Find member in available members
            const member = availableMembers.find(m => m.id === memberId);
            if (!member) return;
            
            // Add to region
            regionData[currentRegion].assigned.push({
                ...member,
                status: 'pending',
                consecutive: false
            });
            
            // Re-render
            renderAssignedMembers(regionData[currentRegion].assigned);
            renderAvailableMembers();
            updateBalanceInfo(regionData[currentRegion].assigned);
            
            showToast(`‚úì ${member.name} added to ${regionData[currentRegion].name}`, 'success');
        }

        function removeMemberFromRegion(memberId) {
            if (!currentRegion) return;
            
            const member = regionData[currentRegion].assigned.find(m => m.id === memberId);
            if (!member) return;
            
            // Remove from region
            regionData[currentRegion].assigned = regionData[currentRegion].assigned.filter(m => m.id !== memberId);
            
            // Re-render
            renderAssignedMembers(regionData[currentRegion].assigned);
            renderAvailableMembers();
            updateBalanceInfo(regionData[currentRegion].assigned);
            
            showToast(`${member.name} removed from assignment`, 'info');
        }

        function updateBalanceInfo(members) {
            const practices = { Procurement: 0, ICA: 0, Finance: 0 };
            members.forEach(m => {
                if (practices[m.practice] !== undefined) {
                    practices[m.practice]++;
                }
            });
            document.getElementById('regionBalanceInfo').textContent = 
                `Practice balance: ${practices.Procurement} Procurement, ${practices.ICA} ICA, ${practices.Finance} Finance`;
        }

        function saveRegionAssignment() {
            if (!currentRegion) return;
            
            const data = regionData[currentRegion];
            closeRegionAssignmentModal();
            showToast(`‚úì ${data.name} assignment saved (${data.assigned.length} members)`, 'success');
        }

        // ===== MEETINGS FUNCTIONS =====
        const meetingsData = {
            'MTG-2025-001': {
                id: 'MTG-2025-001', title: 'Europe & CIS Regional Review',
                date: 'Dec 16, 2025', time: '10:00 CET', region: 'Europe & CIS', regionIcon: 'üåç',
                practice: 'Procurement', location: 'MS Teams', status: 'confirmed',
                attendees: [
                    { id: 'MG', name: 'Maria Garcia', role: 'CPC Chair', status: 'confirmed' },
                    { id: 'JS', name: 'John Smith', role: 'CPC Member', status: 'confirmed' },
                    { id: 'AK', name: 'Anna Kowalski', role: 'CPC Member', status: 'confirmed' },
                    { id: 'PM', name: 'Peter Mueller', role: 'CPC Associate', status: 'pending' }
                ],
                cases: ['CPC-2025-0042', 'CPC-2025-0041', 'CPC-2025-0043'],
                notes: [
                    { author: 'Maria Garcia', initials: 'MG', date: 'Dec 13 at 14:30', type: 'Pre-meeting', content: 'Initial review completed. Evaluation methodology follows guidelines.' },
                    { author: 'John Smith', initials: 'JS', date: 'Dec 13 at 15:45', type: 'Pre-meeting', content: 'Reviewed vendor qualifications. MediSupply Global has strong track record.' }
                ]
            },
            'MTG-2025-002': {
                id: 'MTG-2025-002', title: 'Asia Pacific Regional Review',
                date: 'Dec 18, 2025', time: '14:00 CET', region: 'Asia Pacific', regionIcon: 'üåè',
                practice: 'ICA', location: 'Zoom', status: 'pending',
                attendees: [
                    { id: 'DC', name: 'David Chen', role: 'CPC Chair', status: 'confirmed' },
                    { id: 'LC', name: 'Luis Chen', role: 'CPC Member', status: 'pending' },
                    { id: 'YT', name: 'Yuki Tanaka', role: 'CPC Member', status: 'pending' }
                ],
                cases: ['CPC-2025-0039', 'CPC-2025-0038'], notes: []
            },
            'MTG-2025-003': {
                id: 'MTG-2025-003', title: 'Africa Regional Review',
                date: 'Dec 20, 2025', time: '09:00 CET', region: 'Africa', regionIcon: 'üåç',
                practice: 'Finance', location: 'Hybrid', status: 'invited',
                attendees: [
                    { id: 'AH', name: 'Ahmed Hassan', role: 'CPC Chair', status: 'pending' },
                    { id: 'FK', name: 'Fatima Khalil', role: 'CPC Member', status: 'pending' }
                ],
                cases: ['CPC-2025-0040'], notes: []
            }
        };

        let currentMeetingId = null;
        let selectedMeetingAttendees = [];

        function switchMeetingTab(tabName) {
            document.querySelectorAll('.meetings-tab-content').forEach(t => t.style.display = 'none');
            document.getElementById('meetings-tab-' + tabName).style.display = 'block';
            const tabs = document.querySelector('#view-meetings .tabs');
            tabs.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
        }

        function openCreateMeetingModal() {
            document.getElementById('meetingModalTitle').textContent = 'Create New Meeting';
            document.getElementById('meetingTitle').value = '';
            document.getElementById('meetingRegion').value = '';
            document.getElementById('meetingDate').value = '';
            document.getElementById('meetingTime').value = '';
            document.getElementById('meetingPractice').value = '';
            document.getElementById('meetingLinkedCases').innerHTML = '';
            document.getElementById('meetingAvailableMembers').innerHTML = '<div style="padding: var(--spacing-md); text-align: center; color: var(--text-muted); font-size: 13px;"><i class="pi pi-info-circle"></i> Select region, date & practice</div>';
            selectedMeetingAttendees = [];
            document.getElementById('createMeetingModal').classList.add('active');
        }

        function closeCreateMeetingModal() {
            document.getElementById('createMeetingModal').classList.remove('active');
        }

        function updateAvailableMembers() {
            const region = document.getElementById('meetingRegion').value;
            const date = document.getElementById('meetingDate').value;
            const practice = document.getElementById('meetingPractice').value;
            if (!region || !date || !practice) return;
            
            const members = [
                { id: 'MG', name: 'Maria Garcia', role: 'Chair', available: true },
                { id: 'JS', name: 'John Smith', role: 'Member', available: true },
                { id: 'AK', name: 'Anna Kowalski', role: 'Member', available: true },
                { id: 'PM', name: 'Peter Mueller', role: 'Associate', available: false }
            ];
            
            document.getElementById('meetingAvailableMembers').innerHTML = members.map(m => `
                <div style="display: flex; align-items: center; gap: var(--spacing-sm); padding: var(--spacing-sm) var(--spacing-md); border-bottom: 1px solid var(--surface-100); ${!m.available ? 'opacity: 0.5;' : ''}">
                    <input type="checkbox" ${selectedMeetingAttendees.includes(m.id) ? 'checked' : ''} ${!m.available ? 'disabled' : ''} onchange="toggleAttendee('${m.id}')">
                    <div class="member-avatar" style="width: 26px; height: 26px; font-size: 9px;">${m.id}</div>
                    <div style="flex: 1;"><div style="font-weight: 500; font-size: 13px;">${m.name}</div><div style="font-size: 11px; color: var(--text-muted);">${m.role}</div></div>
                    ${m.available ? '<span style="font-size: 10px; color: var(--success-600);">‚úì Available</span>' : '<span style="font-size: 10px; color: var(--text-muted);">Unavailable</span>'}
                </div>
            `).join('');
        }

        function toggleAttendee(id) {
            const i = selectedMeetingAttendees.indexOf(id);
            if (i > -1) selectedMeetingAttendees.splice(i, 1);
            else selectedMeetingAttendees.push(id);
            document.getElementById('selectedAttendeesCount').textContent = selectedMeetingAttendees.length;
        }

        function createMeeting() {
            const region = document.getElementById('meetingRegion').value;
            const date = document.getElementById('meetingDate').value;
            const time = document.getElementById('meetingTime').value;
            const practice = document.getElementById('meetingPractice').value;
            if (!region || !date || !time || !practice) { showToast('Fill required fields', 'warning'); return; }
            closeCreateMeetingModal();
            showToast('‚úì Meeting created!', 'success');
        }

        function saveMeetingDraft() { closeCreateMeetingModal(); showToast('üìù Draft saved', 'info'); }

        function editMeeting(id) {
            document.getElementById('meetingModalTitle').textContent = 'Edit Meeting';
            document.getElementById('createMeetingModal').classList.add('active');
            showToast('Editing meeting...', 'info');
        }

        function openMeetingDetail(id) {
            const m = meetingsData[id];
            currentMeetingId = id;
            if (!m) { showToast('Meeting not found', 'error'); return; }
            
            document.getElementById('meetingDetailId').textContent = m.id;
            document.getElementById('meetingDetailTitle').textContent = m.title;
            document.getElementById('meetingDetailDate').textContent = m.date;
            document.getElementById('meetingDetailTime').textContent = m.time;
            document.getElementById('meetingDetailRegion').textContent = m.regionIcon + ' ' + m.region;
            document.getElementById('meetingDetailPractice').textContent = 'üìã ' + m.practice;
            
            const statusMap = { 'confirmed': { c: 'success', t: 'Confirmed' }, 'pending': { c: 'warning', t: 'Pending' }, 'invited': { c: '', t: 'Invited' } };
            const s = statusMap[m.status] || statusMap['pending'];
            document.getElementById('meetingDetailStatus').className = 'status-badge ' + s.c;
            document.getElementById('meetingDetailStatus').textContent = s.t;
            
            renderMeetingAttendees(m.attendees);
            renderMeetingCases(m.cases);
            renderMeetingNotes(m.notes);
            
            document.querySelectorAll('.meeting-detail-tab').forEach(t => t.style.display = 'none');
            document.getElementById('meeting-detail-attendees').style.display = 'block';
            document.querySelectorAll('#meetingDetailModal .tabs .tab').forEach((t, i) => t.classList.toggle('active', i === 0));
            
            document.getElementById('meetingDetailModal').classList.add('active');
        }

        function closeMeetingDetailModal() { document.getElementById('meetingDetailModal').classList.remove('active'); currentMeetingId = null; }

        function renderMeetingAttendees(attendees) {
            document.getElementById('meetingDetailAttendees').innerHTML = attendees.map(a => `
                <div style="display: flex; align-items: center; gap: var(--spacing-md); padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md);">
                    <div class="member-avatar" style="width: 36px; height: 36px;">${a.id}</div>
                    <div style="flex: 1;"><div style="font-weight: 600;">${a.name}</div><div style="font-size: 12px; color: var(--text-muted);">${a.role}</div></div>
                    <span class="status-badge ${a.status === 'confirmed' ? 'success' : 'warning'}" style="font-size: 10px;">${a.status === 'confirmed' ? '‚úì Confirmed' : '‚è≥ Pending'}</span>
                </div>
            `).join('');
        }

        function renderMeetingCases(cases) {
            const titles = { 'CPC-2025-0042': 'Medical Supplies', 'CPC-2025-0041': 'IT Infrastructure', 'CPC-2025-0043': 'Office Equipment', 'CPC-2025-0039': 'Construction', 'CPC-2025-0038': 'Consulting', 'CPC-2025-0040': 'Water & Sanitation' };
            document.getElementById('meetingDetailCases').innerHTML = cases.map(c => `
                <div style="display: flex; align-items: center; justify-content: space-between; padding: var(--spacing-md); background: var(--surface-50); border-radius: var(--radius-md);">
                    <div><div style="font-weight: 600; color: var(--primary-600);">${c}</div><div style="font-size: 12px; color: var(--text-muted);">${titles[c] || 'Case'}</div></div>
                    <div style="display: flex; gap: var(--spacing-xs);"><button class="btn btn-sm btn-secondary" onclick="openCase('${c}'); closeMeetingDetailModal();"><i class="pi pi-eye"></i></button><button class="btn btn-sm btn-secondary" onclick="unlinkCase('${c}')"><i class="pi pi-times"></i></button></div>
                </div>
            `).join('');
        }

        function renderMeetingNotes(notes) {
            if (!notes.length) { document.getElementById('meetingDetailNotes').innerHTML = '<div style="text-align: center; padding: var(--spacing-lg); color: var(--text-muted);">No notes yet</div>'; return; }
            document.getElementById('meetingDetailNotes').innerHTML = notes.map(n => `
                <div style="background: var(--surface-50); border-radius: var(--radius-md); padding: var(--spacing-md); margin-bottom: var(--spacing-md);">
                    <div style="display: flex; justify-content: space-between; margin-bottom: var(--spacing-sm);">
                        <div style="display: flex; align-items: center; gap: var(--spacing-sm);"><div class="member-avatar" style="width: 26px; height: 26px; font-size: 9px;">${n.initials}</div><span style="font-weight: 600; font-size: 13px;">${n.author}</span><span style="font-size: 11px; color: var(--text-muted);">‚Ä¢ ${n.date}</span></div>
                        <span style="padding: 2px 8px; background: var(--info-100); color: var(--info-700); border-radius: var(--radius-sm); font-size: 10px;">${n.type}</span>
                    </div>
                    <p style="margin: 0; font-size: 13px; color: var(--text-secondary);">${n.content}</p>
                </div>
            `).join('');
        }

        function switchMeetingDetailTab(tab) {
            document.querySelectorAll('.meeting-detail-tab').forEach(t => t.style.display = 'none');
            document.getElementById('meeting-detail-' + tab).style.display = 'block';
            document.querySelectorAll('#meetingDetailModal .tabs .tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
        }

        function sendMeetingReminder(id) { showToast('üìß Reminders sent!', 'success'); }
        function deleteDraftMeeting(id) { showToast('üóëÔ∏è Draft deleted', 'info'); }
        function viewMeetingMinutes(id) { showToast('üìÑ Opening minutes...', 'info'); }
        function generateMeetingMinutes() { showToast('üìÑ Generating minutes...', 'info'); setTimeout(() => showToast('‚úì Minutes ready', 'success'), 1500); }
        function exportMeetingCalendar() { showToast('üìÖ Calendar exported', 'success'); }
        function duplicateMeeting() { showToast('üìã Duplicated', 'info'); openCreateMeetingModal(); }
        function cancelMeeting() { if (confirm('Cancel this meeting?')) { showToast('‚ùå Meeting cancelled', 'info'); closeMeetingDetailModal(); } }
        function addCaseToMeeting() { showToast('Search and add cases', 'info'); }
        function unlinkCase(id) { showToast(`${id} unlinked`, 'info'); }
        function unlinkMeetingFromCase(meetingId) {
            if (confirm('Are you sure you want to unlink this meeting from the case?')) {
                showToast(`Meeting ${meetingId} unlinked from case`, 'info');
            }
        }
        function downloadMeetingMinutes(meetingId) {
            showToast(`üì• Downloading minutes for ${meetingId}...`, 'info');
        }
        function addMeetingNote() { openAddNotesModal(); }

        function openLinkMeetingModal() { document.getElementById('linkMeetingSelect').value = ''; document.getElementById('selectedMeetingPreview').style.display = 'none'; document.getElementById('linkMeetingModal').classList.add('active'); }
        function closeLinkMeetingModal() { document.getElementById('linkMeetingModal').classList.remove('active'); }
        function previewSelectedMeeting() {
            const v = document.getElementById('linkMeetingSelect').value;
            if (v === 'new') { closeLinkMeetingModal(); openCreateMeetingModal(); return; }
            if (v && meetingsData[v]) {
                document.getElementById('previewMeetingTitle').textContent = meetingsData[v].title;
                document.getElementById('previewMeetingDate').textContent = meetingsData[v].date + ' at ' + meetingsData[v].time;
                document.getElementById('selectedMeetingPreview').style.display = 'block';
            } else { document.getElementById('selectedMeetingPreview').style.display = 'none'; }
        }
        function linkCaseToMeeting() { if (!document.getElementById('linkMeetingSelect').value) { showToast('Select a meeting', 'warning'); return; } closeLinkMeetingModal(); showToast('‚úì Case linked!', 'success'); }

        function openAddNotesModal() { document.getElementById('noteType').value = 'pre'; document.getElementById('noteContent').value = ''; document.getElementById('addNotesModal').classList.add('active'); }
        function closeAddNotesModal() { document.getElementById('addNotesModal').classList.remove('active'); }
        function saveMeetingNote() { if (!document.getElementById('noteContent').value.trim()) { showToast('Enter note', 'warning'); return; } closeAddNotesModal(); showToast('‚úì Note saved!', 'success'); }

        function searchCasesForMeeting() {
            const term = document.getElementById('meetingCaseSearch').value;
            const container = document.getElementById('meetingCaseResults');
            if (term.length < 2) { container.style.display = 'none'; return; }
            container.innerHTML = `
                <div style="padding: var(--spacing-sm); border-bottom: 1px solid var(--surface-100); cursor: pointer;" onclick="addCaseTag('CPC-2025-0042')" onmouseover="this.style.background='var(--surface-50)'" onmouseout="this.style.background=''"><div style="font-weight: 600; font-size: 13px;">CPC-2025-0042</div><div style="font-size: 11px; color: var(--text-muted);">Medical Supplies</div></div>
                <div style="padding: var(--spacing-sm); cursor: pointer;" onclick="addCaseTag('CPC-2025-0041')" onmouseover="this.style.background='var(--surface-50)'" onmouseout="this.style.background=''"><div style="font-weight: 600; font-size: 13px;">CPC-2025-0041</div><div style="font-size: 11px; color: var(--text-muted);">IT Infrastructure</div></div>
            `;
            container.style.display = 'block';
        }

        function addCaseTag(id) {
            const c = document.getElementById('meetingLinkedCases');
            if (c.querySelector(`[data-id="${id}"]`)) { showToast('Already added', 'warning'); return; }
            const tag = document.createElement('span');
            tag.setAttribute('data-id', id);
            tag.style.cssText = 'display: inline-flex; align-items: center; gap: 4px; padding: 4px 8px; background: var(--primary-100); color: var(--primary-700); border-radius: var(--radius-sm); font-size: 12px;';
            tag.innerHTML = `${id} <i class="pi pi-times" style="cursor: pointer; font-size: 10px;" onclick="this.parentElement.remove()"></i>`;
            c.appendChild(tag);
            document.getElementById('meetingCaseSearch').value = '';
            document.getElementById('meetingCaseResults').style.display = 'none';
        }

        function requestAvailabilityUpdate() {
            showToast('üìß Availability update requests sent to all members', 'success');
        }

        function sendReminders() {
            showToast('üìß Reminder sent to 5 members with pending responses', 'success');
        }

        // Member Management Modal Functions
        const memberData = {
            'MG': { name: 'Maria Garcia', initials: 'MG', role: 'CPC Chair | Europe & CIS', practice: 'Procurement', attendance: '95%' },
            'JS': { name: 'John Smith', initials: 'JS', role: 'CPC Member | Europe & CIS', practice: 'ICA', attendance: '88%' },
            'DC': { name: 'David Chen', initials: 'DC', role: 'CPC Chair | Asia Pacific', practice: 'Procurement', attendance: '97%' },
            'AH': { name: 'Ahmed Hassan', initials: 'AH', role: 'CPC Chair | Africa', practice: 'Procurement', attendance: '93%' },
            'SJ': { name: 'Sarah Johnson', initials: 'SJ', role: 'CPC Chair | Americas', practice: 'Procurement', attendance: '94%' }
        };

        function openMemberModal(memberId) {
            const member = memberData[memberId] || memberData['MG'];
            document.getElementById('memberModalAvatar').textContent = member.initials;
            document.getElementById('memberModalName').textContent = member.name;
            document.getElementById('memberModalRole').textContent = member.role;
            document.getElementById('memberModalPractice').textContent = member.practice;
            document.getElementById('memberModalAttendance').textContent = member.attendance;
            
            // Reset to overview tab
            switchMemberModalTab('overview');
            
            document.getElementById('memberManagementModal').classList.add('active');
        }

        function closeMemberModal() {
            document.getElementById('memberManagementModal').classList.remove('active');
        }

        function switchMemberModalTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.member-modal-tab').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // Remove active from all tab buttons
            document.querySelectorAll('#memberModalTabs .tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            const selectedTab = document.getElementById('member-tab-' + tabName);
            if (selectedTab) {
                selectedTab.style.display = 'block';
            }
            
            // Mark clicked tab as active (for onclick handler)
            if (event && event.target) {
                event.target.classList.add('active');
            }
        }

        function editMemberAvailability() {
            closeMemberModal();
            switchPoolTab('availability');
            showToast('üìÖ Edit availability in the table below', 'info');
        }

        // ===== Q&A FUNCTIONS =====
        function openNewQuestionModal() {
            showToast('New Question form would open here', 'info');
        }

        function sendQAReply(threadId) {
            const textarea = document.getElementById('qa-reply-' + threadId);
            if (textarea && textarea.value.trim()) {
                showToast('Reply sent successfully', 'success');
                textarea.value = '';
            } else {
                showToast('Please enter a reply message', 'warning');
            }
        }

        function markQAResolved(threadId) {
            const thread = document.getElementById('case-qa-thread-' + threadId);
            if (thread) {
                const badge = thread.querySelector('.status-badge');
                if (badge) {
                    badge.className = 'status-badge success';
                    badge.textContent = 'Resolved';
                }
                showToast('Question marked as resolved', 'success');
            }
        }

        // ===== TOAST NOTIFICATIONS =====
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast ' + type + ' show';
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // ===== TAB HANDLING =====
        document.querySelectorAll('.tabs').forEach(tabContainer => {
            tabContainer.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const parent = this.closest('.tabs');
                parent.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                });
            });
        });

        // ===== CASES VIEW TABS =====
        document.querySelectorAll('#casesViewTabs .tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const filter = this.dataset.filter;
                const rows = document.querySelectorAll('#allCasesTable tbody tr');
                
                rows.forEach(row => {
                    if (filter === 'all' || row.dataset.status === filter) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });
        });

        // ===== INITIALIZE =====
        document.addEventListener('DOMContentLoaded', function() {
            // Set default tab content visible
            const defaultTab = document.getElementById('tab-evaluation-report');
            if (defaultTab) {
                defaultTab.style.display = 'block';
            }
            
            // Collapse all Evaluation Report sections by default
            const evalSections = ['tender-summary', 'evaluation-method', 'bidder-info', 'price-comparison', 
                                'tech-evaluation', 'recommendation', 'approval-chain'];
            evalSections.forEach(sectionName => {
                const content = document.getElementById('content-' + sectionName);
                const icon = document.getElementById('icon-' + sectionName);
                if (content) {
                    content.classList.add('collapsed');
                    if (icon) icon.style.transform = 'rotate(180deg)';
                }
            });
            evalSectionsCollapsed = true;
            const evalIcon = document.getElementById('evalToggleIcon');
            const evalText = document.getElementById('evalToggleText');
            if (evalIcon) evalIcon.className = 'pi pi-chevron-down';
            if (evalText) evalText.textContent = 'Expand All';
            
            // Collapse all Assessment sections by default
            const assessCards = document.querySelectorAll('#tab-assessment .card');
            assessCards.forEach(card => {
                const collapseContent = card.querySelector('.collapse-content, .card-body');
                const icon = card.querySelector('.pi-chevron-down, .pi-chevron-up');
                if (collapseContent && collapseContent.style) {
                    collapseContent.style.display = 'none';
                }
                if (icon) {
                    icon.className = 'pi pi-chevron-down';
                }
            });
            assessSectionsCollapsed = true;
            const assessIcon = document.getElementById('assessToggleIcon');
            const assessText = document.getElementById('assessToggleText');
            if (assessIcon) assessIcon.className = 'pi pi-chevron-down';
            if (assessText) assessText.textContent = 'Expand All';
            
            console.log('Award & Review Dashboard loaded');
        });
    </script>
</body>
</html>
