<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Section III: Returnable Bidding Forms - Interactive Mockup</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* UNOPS Brand Colors from preset */
            --unops-blue2-400: #00669a;
            --unops-blue2-500: #005783;
            --unops-blue2-600: #00476c;
            --unops-blue-400: #0092d1;
            --unops-blue-0: #F1F5F9;
            --unops-ocean-400: #4ec3e0;
            --unops-red-500: #da291c;
            --unops-red-600: #991d14;
            --unops-green-500: #4c9f38;
            --unops-n-cold-0: #ffffff;
            --unops-n-cold-50: #F5F8FB;
            --unops-n-cold-100: #EBF1F8;
            --unops-n-cold-200: #DDE8F2;
            --unops-n-cold-300: #CFDFEC;
            --unops-n-cold-900: #3B3E4A;
            --unops-n-cold-950: #2B2D37;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif;
            background: var(--unops-n-cold-50);
            color: var(--unops-n-cold-900);
            line-height: 1.6;
            font-size: 14px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--unops-blue2-400) 0%, var(--unops-blue2-600) 100%);
            color: white;
            padding: 30px;
            border-radius: 6px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .unops-logo {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        /* View Toggle */
        .view-toggle {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .toggle-btn {
            padding: 14px 32px;
            border: 2px solid var(--unops-blue2-500);
            background: white;
            color: var(--unops-blue2-600);
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.25s ease;
            font-size: 14px;
            letter-spacing: 0.01em;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .toggle-btn.active {
            background: linear-gradient(135deg, var(--unops-blue2-500) 0%, var(--unops-blue2-600) 100%);
            color: white;
            border-color: var(--unops-blue2-600);
            box-shadow: 0 3px 8px rgba(0, 118, 189, 0.25);
        }

        .toggle-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 118, 189, 0.2);
            border-color: var(--unops-blue2-600);
        }

        .toggle-btn:active {
            transform: translateY(0);
        }

        /* Authoring View */
        .authoring-view {
            display: block;
        }

        .authoring-view.hidden {
            display: none;
        }

        .authoring-panel {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
        }

        .authoring-panel h2 {
            color: #004a99;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #0066cc;
            font-size: 1.4em;
        }

        .tender-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-field {
            margin-bottom: 15px;
        }

        .info-field label {
            display: block;
            font-weight: 600;
            color: var(--unops-n-cold-900);
            margin-bottom: 8px;
            font-size: 13.5px;
            letter-spacing: 0.01em;
        }

        .info-field input,
        .info-field select,
        .info-field textarea {
            width: 100%;
            padding: 11px 14px;
            border: 1.5px solid var(--unops-n-cold-300);
            border-radius: 8px;
            font-size: 13.5px;
            font-family: inherit;
            transition: all 0.2s ease;
            background: white;
        }

        .info-field input:focus,
        .info-field select:focus,
        .info-field textarea:focus {
            outline: none;
            border-color: var(--unops-blue2-500);
            box-shadow: 0 0 0 3px rgba(0, 118, 189, 0.1);
        }

        .info-field select {
            cursor: pointer;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23333' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 14px center;
            padding-right: 40px;
            appearance: none;
        }

        .form-selector {
            margin-top: 20px;
        }

        .form-selector-item {
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 12px;
            background: #f9f9f9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .form-selector-item.selected {
            background: #e6f2ff;
            border-color: #0066cc;
        }

        .form-selector-info h4 {
            color: #004a99;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .form-selector-info p {
            font-size: 12px;
            color: #666;
        }

        .form-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .switch {
            position: relative;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.3s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #0066cc;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }

        .badge-mandatory {
            background: #d9534f;
            color: white;
        }

        .badge-optional {
            background: #5bc0de;
            color: white;
        }

        .badge-conditional {
            background: #f0ad4e;
            color: white;
        }

        /* Supplier View */
        .supplier-view {
            display: none;
        }

        .supplier-view.active {
            display: block;
        }

        .form-document {
            background: white;
            border-radius: 8px;
            padding: 50px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }

        .form-title-page {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 3px solid #0066cc;
        }

        .form-title-page h1 {
            color: #004a99;
            font-size: 2em;
            margin-bottom: 20px;
        }

        .form-title-page .tender-ref {
            font-size: 1.2em;
            color: #666;
            margin: 10px 0;
        }

        .form-note {
            background: #fff3cd;
            border-left: 4px solid #f0ad4e;
            padding: 15px;
            margin: 20px 0;
            font-size: 12px;
            line-height: 1.6;
        }

        .form-note.info {
            background: var(--unops-blue-0);
            border-left: 4px solid var(--unops-blue-400);
            color: var(--unops-n-cold-900);
        }

        .help-text {
            font-size: 0.85em;
            color: var(--unops-n-cold-500);
            margin-top: 4px;
            font-style: italic;
        }

        /* Pre-filled/Auto-populated Fields Styling */
        .prefilled-field {
            background: var(--unops-blue-0) !important;
            border: 2px solid var(--unops-blue-300) !important;
            color: var(--unops-n-cold-900) !important;
            font-weight: 600;
            cursor: not-allowed;
            padding: 4px 8px;
        }

        .prefilled-field-inline {
            background: var(--unops-blue-0);
            border: none;
            border-bottom: 2px solid var(--unops-blue-400) !important;
            color: var(--unops-n-cold-900);
            font-weight: 600;
            cursor: not-allowed;
            padding: 2px 8px;
            width: 80px;
            text-align: center;
        }

        .prefilled-inline {
            background: var(--unops-blue-0);
            padding: 4px 10px;
            border-radius: 4px;
            border: 2px solid var(--unops-blue-300);
            color: var(--unops-n-cold-900);
            font-weight: 600;
            display: inline-block;
        }

        .prefilled-box {
            background: var(--unops-blue-0);
            padding: 12px;
            border-radius: 6px;
            border: 2px solid var(--unops-blue-300);
            color: var(--unops-n-cold-900);
        }

        .form-section {
            margin-bottom: 48px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04), 0 4px 12px rgba(0, 0, 0, 0.03);
            border: 1px solid var(--unops-n-cold-200);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .form-section:hover {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06), 0 6px 20px rgba(0, 0, 0, 0.04);
        }

        .form-section-header {
            background: linear-gradient(135deg, var(--unops-blue2-600) 0%, var(--unops-blue2-700) 100%);
            color: white !important;
            padding: 20px 28px;
            border-bottom: 3px solid var(--unops-blue2-800);
            font-size: 1.35em;
            font-weight: 600;
            letter-spacing: 0.01em;
        }

        .supplier-view .form-section-header {
            color: white !important;
            background: linear-gradient(135deg, var(--unops-blue2-600) 0%, var(--unops-blue2-700) 100%) !important;
        }

        .supplier-view .itb-table th {
            color: white !important;
            background: linear-gradient(180deg, var(--unops-blue2-600) 0%, var(--unops-blue2-700) 100%) !important;
        }

        .supplier-view .comparative-table th {
            color: white !important;
            background: #004a99 !important;
        }

        .form-section-body {
            padding: 28px;
        }

        /* Collapsible Forms */
        .supplier-view .form-section-header {
            cursor: pointer;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .supplier-view .form-section-header::after {
            content: '‚ñº';
            font-size: 0.8em;
            transition: transform 0.3s ease;
        }

        .supplier-view .form-document.collapsed .form-section-header::after {
            transform: rotate(-90deg);
        }

        .supplier-view .form-document.collapsed .form-section-body {
            display: none;
        }


        /* Partner Card Styling */
        .partner-card {
            background: white;
            border: 1.5px solid var(--unops-n-cold-200);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            transition: all 0.25s ease;
            position: relative;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
        }

        .partner-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transform: translateY(-1px);
        }

        .partner-card.lead-partner {
            border-color: var(--unops-blue2-500);
            border-width: 2px;
            box-shadow: 0 4px 16px rgba(0, 118, 189, 0.15);
            background: linear-gradient(135deg, rgba(0, 118, 189, 0.02) 0%, rgba(0, 118, 189, 0.05) 100%);
        }

        .partner-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--unops-n-cold-100);
        }

        .partner-number {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--unops-blue2-500);
        }

        .lead-badge {
            background: var(--unops-blue2-400);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .partner-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .partner-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }

        .partner-grid.full-width {
            grid-template-columns: 1fr;
        }

        .partner-field {
            display: flex;
            flex-direction: column;
        }

        .partner-field label {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 13.5px;
            color: var(--unops-n-cold-900);
            letter-spacing: 0.01em;
        }

        .partner-field input,
        .partner-field textarea {
            padding: 11px 14px;
            border: 1.5px solid var(--unops-n-cold-300);
            border-radius: 8px;
            font-size: 13.5px;
            font-family: inherit;
            transition: all 0.2s ease;
            background: white;
        }

        .partner-field input:focus,
        .partner-field textarea:focus {
            outline: none;
            border-color: var(--unops-blue2-500);
            box-shadow: 0 0 0 3px rgba(0, 118, 189, 0.1);
        }

        .partner-field textarea {
            resize: vertical;
            min-height: 80px;
            line-height: 1.5;
        }

        .partner-field textarea {
            min-height: 80px;
            resize: vertical;
        }

        .percentage-field {
            position: relative;
        }

        .percentage-field input {
            padding-right: 35px;
        }

        .percentage-symbol {
            position: absolute;
            right: 12px;
            top: 36px;
            color: var(--unops-n-cold-900);
            font-weight: 600;
        }

        .partner-controls {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--unops-n-cold-100);
        }

        .btn-icon {
            background: transparent;
            border: 1px solid var(--unops-n-cold-300);
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn-icon:hover {
            background: var(--unops-n-cold-100);
        }

        .btn-icon.btn-lead {
            color: var(--unops-blue2-500);
            border-color: var(--unops-blue2-400);
        }

        .btn-icon.btn-lead:hover {
            background: var(--unops-blue-0);
        }

        .btn-icon.btn-lead.active {
            background: var(--unops-blue2-400);
            color: white;
        }

        .btn-icon.btn-remove {
            color: var(--unops-red-600);
            border-color: var(--unops-red-500);
        }

        .btn-icon.btn-remove:hover {
            background: rgba(218, 41, 28, 0.1);
        }

        .percentage-summary {
            background: var(--unops-n-cold-100);
            border: 1px solid var(--unops-n-cold-200);
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .percentage-summary.valid {
            border-color: var(--unops-green-500);
            background: rgba(76, 159, 56, 0.1);
        }

        .percentage-summary.invalid {
            border-color: var(--unops-red-500);
            background: rgba(218, 41, 28, 0.1);
        }

        .percentage-summary-text {
            font-weight: 600;
            font-size: 1.05em;
        }

        .percentage-summary.valid .percentage-summary-text {
            color: var(--unops-green-500);
        }

        .percentage-summary.invalid .percentage-summary-text {
            color: var(--unops-red-600);
        }

        .form-field-group {
            margin-bottom: 25px;
        }

        .form-label {
            font-weight: 600;
            color: var(--unops-n-cold-900);
            margin-bottom: 8px;
            display: block;
            font-size: 13.5px;
            letter-spacing: 0.01em;
        }

        .required {
            color: #dc3545;
            font-weight: 700;
        }

        .form-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #999;
            border-radius: 3px;
            font-size: 13px;
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--unops-blue2-400);
            box-shadow: 0 0 0 2px rgba(0, 102, 154, 0.1);
        }

        .form-input[readonly] {
            background: #f5f5f5;
            color: #666;
        }

        textarea.form-input {
            min-height: 80px;
            resize: vertical;
        }

        /* Tables - Official ITB Style */
        .itb-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 24px 0;
            font-size: 13px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--unops-n-cold-200);
        }

        .itb-table th {
            background: linear-gradient(180deg, var(--unops-blue2-600) 0%, var(--unops-blue2-700) 100%);
            color: white;
            padding: 14px 16px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            letter-spacing: 0.01em;
            border-bottom: 2px solid var(--unops-blue2-800);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .itb-table th:last-child {
            border-right: none;
        }

        .itb-table td {
            padding: 14px 16px;
            border-bottom: 1px solid var(--unops-n-cold-200);
            border-right: 1px solid var(--unops-n-cold-200);
            vertical-align: middle;
            background: white;
            transition: background-color 0.15s ease;
        }

        .itb-table td:last-child {
            border-right: none;
        }

        .itb-table tbody tr:hover td {
            background: var(--unops-n-cold-50);
        }

        .itb-table tbody tr:last-child td {
            border-bottom: none;
        }

        .itb-table tr:nth-child(even) td {
            background: var(--unops-n-cold-25);
        }

        .itb-table tr:nth-child(even):hover td {
            background: var(--unops-n-cold-75);
        }

        .itb-table input[type="text"],
        .itb-table input[type="number"],
        .itb-table input[type="email"],
        .itb-table input[type="date"],
        .itb-table select,
        .itb-table textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1.5px solid var(--unops-n-cold-300);
            border-radius: 8px;
            font-size: 13px;
            font-family: inherit;
            transition: all 0.2s ease;
            background: white;
        }

        .itb-table input[type="text"]:focus,
        .itb-table input[type="number"]:focus,
        .itb-table input[type="email"]:focus,
        .itb-table input[type="date"]:focus,
        .itb-table select:focus,
        .itb-table textarea:focus {
            outline: none;
            border-color: var(--unops-blue2-500);
            box-shadow: 0 0 0 3px rgba(0, 118, 189, 0.1);
        }

        .itb-table select {
            cursor: pointer;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23333' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 36px;
            appearance: none;
        }

        .itb-table textarea {
            min-height: 80px;
            resize: vertical;
            line-height: 1.5;
        }

        .itb-table .editable-cell {
            background: linear-gradient(135deg, #fffef0 0%, #fffbeb 100%);
        }

        .itb-table tr:hover .editable-cell {
            background: linear-gradient(135deg, #fffce0 0%, #fff9db 100%);
        }

        .itb-table .readonly-cell {
            background: var(--unops-n-cold-100);
        }

        .itb-table tr:hover .readonly-cell {
            background: var(--unops-n-cold-150);
        }

        .checkbox-options {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .checkbox-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-option input[type="checkbox"],
        .checkbox-option input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--unops-blue2-600);
        }

        .declaration-box {
            background: linear-gradient(135deg, var(--unops-n-cold-50) 0%, var(--unops-n-cold-100) 100%);
            border: 2px solid var(--unops-blue2-500);
            padding: 24px;
            margin: 32px 0;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 118, 189, 0.08);
        }

        .declaration-box ol {
            margin-left: 20px;
            line-height: 1.8;
        }

        .declaration-box li {
            margin-bottom: 15px;
        }

        .signature-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #ccc;
        }

        .signature-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }

        .signature-field {
            margin-bottom: 15px;
        }

        .signature-field label {
            font-weight: 600;
            display: block;
            margin-bottom: 5px;
        }

        .signature-line {
            border-bottom: 1px solid #333;
            min-height: 40px;
            padding: 5px;
        }

        .stamp-box {
            border: 2px dashed #999;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-style: italic;
            margin-top: 20px;
        }

        .file-upload-area, .file-upload {
            border: 2px dashed var(--unops-blue2-400);
            border-radius: 6px;
            padding: 30px;
            text-align: center;
            background: var(--unops-n-cold-50);
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-upload-area:hover, .file-upload:hover {
            background: var(--unops-blue-0);
            border-color: var(--unops-blue2-500);
        }

        .file-upload-area input[type="file"], .file-upload input[type="file"] {
            display: none;
        }

        .file-upload-icon {
            font-size: 3em;
            color: var(--unops-blue2-400);
            margin-bottom: 15px;
        }

        .action-bar {
            position: sticky;
            bottom: 0;
            background: white;
            padding: 20px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 15px;
            justify-content: center;
            z-index: 100;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--unops-blue2-400);
            color: white;
        }

        .btn-primary:hover {
            background: var(--unops-blue2-500);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .btn-success {
            background: var(--unops-green-500);
            color: white;
        }

        .btn-success:hover {
            background: #418730;
        }

        .add-partner-btn {
            background: var(--unops-blue-400);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 0.95em;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .add-partner-btn:hover {
            background: var(--unops-blue2-400);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 146, 209, 0.3);
        }

        /* Download PDF Button */
        .download-pdf-btn {
            background: var(--unops-green-500);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 1em;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0, 128, 96, 0.2);
        }

        .download-pdf-btn:hover {
            background: var(--unops-green-600);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 128, 96, 0.3);
        }

        /* Final Signature Document */
        .final-signature-document {
            margin-top: 40px;
            border: 3px solid var(--unops-blue-400);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .signature-upload-area {
            margin-top: 10px;
        }

        .signature-canvas-placeholder {
            border: 2px dashed var(--unops-n-cold-300);
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            background: var(--unops-n-cold-50);
            transition: all 0.3s;
            cursor: pointer;
        }

        .signature-canvas-placeholder:hover {
            border-color: var(--unops-blue-400);
            background: var(--unops-blue-0);
        }

        .signature-canvas-placeholder p {
            margin: 0;
            color: var(--unops-n-cold-600);
            font-size: 0.95em;
        }

        /* Tender Details Hero Section */
        .tender-details-hero {
            background: linear-gradient(135deg, var(--unops-blue-400) 0%, var(--unops-blue2-400) 100%);
            color: white;
            padding: 40px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 146, 209, 0.2);
        }

        .supplier-hero {
            /* Uses same gradient as authoring view */
            background: linear-gradient(135deg, var(--unops-blue-400) 0%, var(--unops-blue2-400) 100%);
        }

        .tender-hero-header {
            margin-bottom: 30px;
        }

        .tender-hero-title {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .tender-hero-title h1 {
            font-size: 1.8em;
            font-weight: 700;
            margin: 0;
            color: white;
        }

        .tender-ref-badge {
            background: rgba(255, 255, 255, 0.25);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.95em;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
        }

        .tender-hero-meta {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
            font-size: 0.95em;
            color: white;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
        }

        .meta-item.urgent {
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 14px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
        }

        .meta-item strong {
            color: white;
        }

        .meta-icon {
            font-size: 1.2em;
        }

        .tender-details-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            color: var(--unops-n-cold-900);
        }

        .detail-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            display: flex;
            gap: 15px;
            align-items: flex-start;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            color: var(--unops-n-cold-900);
        }

        .detail-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .detail-card.highlight {
            border: 2px solid var(--unops-yellow-300);
            background: linear-gradient(to bottom right, white, #fffef0);
        }

        .detail-card-icon {
            font-size: 2em;
            opacity: 0.9;
            filter: none;
        }

        .detail-card-content {
            flex: 1;
        }

        .detail-card-label {
            font-size: 0.8em;
            color: var(--unops-n-cold-500);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .detail-card-value {
            font-size: 1em;
            color: var(--unops-n-cold-900);
            font-weight: 600;
        }

        .tender-requirements-summary {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            color: var(--unops-n-cold-900);
        }

        .tender-requirements-summary h3 {
            margin: 0 0 20px 0;
            color: var(--unops-n-cold-900);
            font-size: 1.1em;
        }

        .requirements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 12px;
            margin-bottom: 15px;
            color: var(--unops-n-cold-900);
        }

        .requirement-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--unops-n-cold-50);
            border-radius: 6px;
            border-left: 4px solid var(--unops-blue-400);
            transition: all 0.2s;
            color: var(--unops-n-cold-900);
        }

        .requirement-item:hover {
            background: var(--unops-blue-0);
            border-left-color: var(--unops-blue2-400);
            transform: translateX(2px);
        }

        .req-code {
            font-family: 'Courier New', monospace;
            font-weight: 700;
            color: var(--unops-blue-500);
            font-size: 0.9em;
            background: white;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid var(--unops-n-cold-200);
        }

        .req-description {
            flex: 1;
            color: var(--unops-n-cold-900);
            font-size: 0.9em;
        }

        .req-qty {
            font-weight: 600;
            color: var(--unops-n-cold-700);
            font-size: 0.85em;
            white-space: nowrap;
        }

        .auto-populated-note {
            font-size: 0.85em;
            color: var(--unops-n-cold-500);
            font-style: italic;
            margin-top: 15px;
            padding: 10px;
            background: var(--unops-n-cold-50);
            border-radius: 6px;
            text-align: center;
        }

        .checkbox-option {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px;
            background: var(--unops-n-cold-50);
            border-radius: 6px;
            border: 2px solid var(--unops-n-cold-200);
            transition: all 0.2s;
        }

        .checkbox-option:hover {
            background: var(--unops-n-cold-100);
            border-color: var(--unops-blue-300);
        }

        .checkbox-option input[type="checkbox"] {
            margin-top: 2px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-option label {
            cursor: pointer;
            user-select: none;
            line-height: 1.5;
        }

        .form-navigation {
            position: sticky;
            top: 20px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
        }

        .form-navigation h3 {
            color: #004a99;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .form-navigation ul {
            list-style: none;
        }

        .form-navigation li {
            padding: 10px;
            margin-bottom: 5px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 13px;
        }

        .form-navigation li:hover {
            background: #e6f2ff;
        }

        .form-navigation li.active {
            background: #0066cc;
            color: white;
        }

        .form-navigation li.complete {
            background: #d4edda;
            border-left: 3px solid #28a745;
        }

        .form-navigation li.incomplete {
            border-left: 3px solid #dc3545;
        }

        .two-col-layout {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
        }

        .progress-indicator {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0066cc 0%, #004a99 100%);
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            font-size: 13px;
            color: #666;
            font-weight: 600;
        }

        .comparative-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 24px 0;
            font-size: 13px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--unops-n-cold-200);
        }

        .comparative-table th {
            background: linear-gradient(180deg, var(--unops-blue2-600) 0%, var(--unops-blue2-700) 100%);
            color: white;
            padding: 14px 16px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            letter-spacing: 0.01em;
            border-bottom: 2px solid var(--unops-blue2-800);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .comparative-table th:last-child {
            border-right: none;
        }

        .comparative-table td {
            padding: 14px 16px;
            border-bottom: 1px solid var(--unops-n-cold-200);
            border-right: 1px solid var(--unops-n-cold-200);
            vertical-align: middle;
            font-size: 13px;
            background: white;
            transition: background-color 0.15s ease;
        }

        .comparative-table td:last-child {
            border-right: none;
        }

        .comparative-table tbody tr:hover td {
            background: var(--unops-n-cold-50);
        }

        .comparative-table tbody tr:last-child td {
            border-bottom: none;
        }

        .comparative-table .item-number {
            width: 50px;
            text-align: center;
            font-weight: 600;
            background: var(--unops-n-cold-100);
        }

        .comparative-table tr:hover .item-number {
            background: var(--unops-n-cold-150);
        }

        .comparative-table .spec-text {
            background: var(--unops-n-cold-50);
        }

        .comparative-table tr:hover .spec-text {
            background: var(--unops-n-cold-100);
        }

        .comparative-table .compliance-col {
            width: 120px;
            background: linear-gradient(135deg, #fffef0 0%, #fffbeb 100%);
        }

        .comparative-table tr:hover .compliance-col {
            background: linear-gradient(135deg, #fffce0 0%, #fff9db 100%);
        }

        .comparative-table .details-col {
            background: linear-gradient(135deg, #fffef0 0%, #fffbeb 100%);
            min-width: 300px;
        }

        .comparative-table tr:hover .details-col {
            background: linear-gradient(135deg, #fffce0 0%, #fff9db 100%);
        }

        @media print {
            .header, .view-toggle, .action-bar, .form-navigation, .progress-indicator {
                display: none;
            }
            
            .form-document {
                box-shadow: none;
                padding: 20px;
            }
        }

        @media (max-width: 1024px) {
            .two-col-layout {
                grid-template-columns: 1fr;
            }
            
            .form-navigation {
                position: relative;
            }
        }

        .inline-fields {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .inline-fields {
                grid-template-columns: 1fr;
            }
            
            .signature-grid {
                grid-template-columns: 1fr;
            }
        }

        .section-header-text {
            background: linear-gradient(135deg, var(--unops-n-cold-100) 0%, var(--unops-n-cold-150) 100%);
            padding: 18px 24px;
            margin: 28px 0;
            border-left: 4px solid var(--unops-blue2-600);
            border-radius: 8px;
            font-weight: 600;
            font-size: 15px;
            color: var(--unops-n-cold-900);
            letter-spacing: 0.01em;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .add-row-btn {
            background: linear-gradient(135deg, var(--unops-blue2-500) 0%, var(--unops-blue2-600) 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            margin-top: 12px;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 118, 189, 0.2);
        }

        .add-row-btn:hover {
            background: linear-gradient(135deg, var(--unops-blue2-600) 0%, var(--unops-blue2-700) 100%);
            box-shadow: 0 4px 8px rgba(0, 118, 189, 0.3);
            transform: translateY(-1px);
        }

        .add-row-btn:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0, 118, 189, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="unops-logo">UNOPS - United Nations Office for Project Services</div>
            <h1>Section III: Returnable Bidding Forms</h1>
            <p>eSourcing Reference: <span id="esourcingRef">ITB/2025/60187</span></p>
        </div>

        <!-- View Toggle -->
        <div class="view-toggle">
            <strong>View Mode:</strong>
            <button class="toggle-btn active" onclick="switchView('authoring')">
                üõ†Ô∏è Tender Authoring Configuration
            </button>
            <button class="toggle-btn" onclick="switchView('supplier')">
                üë§ Supplier Submission View
            </button>
        </div>

        <!-- Authoring View -->
        <div class="authoring-view" id="authoringView">
            
            <!-- Tender Details Header -->
            <div class="tender-details-hero">
                <div class="tender-hero-header">
                    <div class="tender-hero-title">
                        <h1>Supply of Medical Equipment and Laboratory Supplies</h1>
                        <div class="tender-ref-badge">ITB/2025/60187</div>
                    </div>
                    <div class="tender-hero-meta">
                        <span class="meta-item">
                            <span class="meta-icon">üìç</span>
                            <span>Tashkent, Uzbekistan</span>
                        </span>
                        <span class="meta-item">
                            <span class="meta-icon">üì¶</span>
                            <span>Goods Only</span>
                        </span>
                        <span class="meta-item">
                            <span class="meta-icon">‚è±Ô∏è</span>
                            <span>Deadline: Dec 31, 2025</span>
                        </span>
                    </div>
                </div>

                <div class="tender-details-cards">
                    <div class="detail-card">
                        <div class="detail-card-icon">üéØ</div>
                        <div class="detail-card-content">
                            <div class="detail-card-label">Evaluation Method</div>
                            <div class="detail-card-value">Lowest evaluated bid</div>
                        </div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-card-icon">‚è≥</div>
                        <div class="detail-card-content">
                            <div class="detail-card-label">Bid Validity Period</div>
                            <div class="detail-card-value">90 days</div>
                        </div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-card-icon">üí±</div>
                        <div class="detail-card-content">
                            <div class="detail-card-label">Permitted Currencies</div>
                            <div class="detail-card-value">USD, EUR</div>
                        </div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-card-icon">üöö</div>
                        <div class="detail-card-content">
                            <div class="detail-card-label">Permitted Incoterms</div>
                            <div class="detail-card-value">FCA, CPT, DPU</div>
                        </div>
                    </div>
                </div>

                <div class="tender-requirements-summary">
                    <h3>üìã Schedule of Requirements</h3>
                    <div class="requirements-grid">
                        <div class="requirement-item">
                            <div class="req-code">43211500</div>
                            <div class="req-description">Desktop computers</div>
                            <div class="req-qty">Qty: 50</div>
                        </div>
                        <div class="requirement-item">
                            <div class="req-code">43211503</div>
                            <div class="req-description">Laptop computers</div>
                            <div class="req-qty">Qty: 30</div>
                        </div>
                        <div class="requirement-item">
                            <div class="req-code">43212104</div>
                            <div class="req-description">Computer monitors</div>
                            <div class="req-qty">Qty: 80</div>
                        </div>
                        <div class="requirement-item">
                            <div class="req-code">43222604</div>
                            <div class="req-description">Computer printers</div>
                            <div class="req-qty">Qty: 20</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="authoring-panel">
                <h2>üìã Configure Returnable Bidding Forms</h2>
                
                <div class="form-note info">
                    <strong>Note to Procurement Officer:</strong> Not all Returnable Bidding Forms may be applicable for this tender. Select which forms are required below. Forms A-H are standard for ITBs. Ensure numbering is consistent across all sections including the Document Checklist in the eSourcing system.
                </div>

                <h3 style="color: #004a99; margin: 30px 0 15px 0;">Select Forms to Include in Tender</h3>

                <div class="form-selector">
                    <!-- Form A -->
                    <div class="form-selector-item selected">
                        <div class="form-selector-info">
                            <h4>Form A: Joint Venture Partner Information Form <span class="badge badge-optional">OPTIONAL</span></h4>
                            <p>To be completed if bidding as JV/Consortium/Association. Digital form with signatures required from all partners.</p>
                        </div>
                        <div class="form-toggle">
                            <span>Include</span>
                            <label class="switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Form B -->
                    <div class="form-selector-item selected">
                        <div class="form-selector-info">
                            <h4>Form B: Bid Submission Form <span class="badge badge-mandatory">MANDATORY</span></h4>
                            <p>Main bid submission declaration with 13 standard declarations. Required for all ITBs. Cannot be removed.</p>
                        </div>
                        <div class="form-toggle">
                            <span>Include</span>
                            <label class="switch">
                                <input type="checkbox" checked disabled>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Form C -->
                    <div class="form-selector-item selected">
                        <div class="form-selector-info">
                            <h4>Form C: Price Schedule Form <span class="badge badge-mandatory">MANDATORY</span></h4>
                            <p>Pricing tables including goods, related services, and delivery data. Tables adapt based on incoterms and requirement type.</p>
                            
                            <div class="form-config-section" style="margin-top: 15px; padding: 15px; background: var(--unops-n-cold-50); border-radius: 6px; border-left: 4px solid var(--unops-blue-400);">
                                <h5 style="margin: 0 0 12px 0; color: var(--unops-blue-500);">‚öôÔ∏è Form C Configuration</h5>
                                
                                <div style="margin-bottom: 15px;">
                                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">Incoterms to Include</label>
                                    <div class="help-text" style="margin-bottom: 10px;">Prepopulated Incoterms of the Tender. Bid Summary and Prices table will show only selected Incoterms.</div>
                                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                        <label style="display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="incoterm-toggle-fca" checked onchange="toggleIncotermColumns()">
                                            <span>FCA (Free Carrier)</span>
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="incoterm-toggle-cpt" checked onchange="toggleIncotermColumns()">
                                            <span>CPT (Carriage Paid To)</span>
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="incoterm-toggle-dpu" checked onchange="toggleIncotermColumns()">
                                            <span>DPU (Delivered at Place Unloaded)</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div style="margin-bottom: 15px;">
                                    <label style="display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" id="toggle-related-services" checked onchange="toggleRelatedServices()">
                                        <span><strong>Include Related Services Table</strong></span>
                                    </label>
                                    <div class="help-text" style="margin-left: 28px;">Related services (Installation, Training, Warranty, etc.) are pre-populated from Schedule of Requirements</div>
                                </div>

                                <div style="margin-bottom: 20px; padding: 15px; background: var(--unops-n-cold-50); border-radius: 8px; border: 1px solid var(--unops-n-cold-200);">
                                    <div style="margin-bottom: 15px;">
                                        <label style="display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="toggle-shipment-delivery" checked onchange="toggleShipmentDelivery()">
                                            <span><strong>Include Shipment & Delivery Information Table</strong></span>
                                        </label>
                                        <div class="help-text" style="margin-left: 28px; margin-top: 5px;">Configure which columns to include in the Shipment & Delivery table</div>
                                    </div>
                                    
                                    <div id="shipment-columns-config" style="margin-left: 28px;">
                                        <label style="font-weight: 600; display: block; margin-bottom: 8px; font-size: 13px;">Select Columns to Include:</label>
                                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;" id="shipment-columns-list">
                                            <label style="display: flex; align-items: center; gap: 6px;">
                                                <input type="checkbox" class="shipment-col-toggle" data-col="item" checked disabled>
                                                <span>Item <span style="color: var(--unops-n-cold-500); font-size: 11px;">(Required)</span></span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 6px;">
                                                <input type="checkbox" class="shipment-col-toggle" data-col="fca-delivery" checked onchange="updateShipmentColumns()">
                                                <span>FCA Point(s) of Delivery</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 6px;">
                                                <input type="checkbox" class="shipment-col-toggle" data-col="dimensions" checked onchange="updateShipmentColumns()">
                                                <span>Shipment Dimensions</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 6px;">
                                                <input type="checkbox" class="shipment-col-toggle" data-col="weight" checked onchange="updateShipmentColumns()">
                                                <span>Gross Weight</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 6px;">
                                                <input type="checkbox" class="shipment-col-toggle" data-col="volume" checked onchange="updateShipmentColumns()">
                                                <span>Total Volume</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 6px;">
                                                <input type="checkbox" class="shipment-col-toggle" data-col="container-num" checked onchange="updateShipmentColumns()">
                                                <span>Container Number</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 6px;">
                                                <input type="checkbox" class="shipment-col-toggle" data-col="container-size" checked onchange="updateShipmentColumns()">
                                                <span>Container Size</span>
                                            </label>
                                        </div>
                                        
                                        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--unops-n-cold-200);">
                                            <label style="font-weight: 600; display: block; margin-bottom: 8px; font-size: 13px;">Add Custom Column:</label>
                                            <div style="display: flex; gap: 10px; align-items: center;">
                                                <input type="text" id="custom-column-name" placeholder="Enter column name" style="flex: 1; padding: 8px 12px; border: 1.5px solid var(--unops-n-cold-300); border-radius: 6px; font-size: 13px;">
                                                <button type="button" class="add-row-btn" onclick="addCustomShipmentColumn()" style="margin: 0; white-space: nowrap;">‚ûï Add Column</button>
                                            </div>
                                            <div id="custom-columns-list" style="margin-top: 10px;"></div>
                                        </div>
                                    </div>
                                </div>

                                <div style="margin-bottom: 15px;">
                                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">Optional Cost Fields:</label>
                                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                        <label style="display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" checked>
                                            <span>Freight Cost per 20/40 ft. container</span>
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" checked>
                                            <span>Customs clearance costs</span>
                                        </label>
                                    </div>
                                    <div class="help-text">Optional fields will only appear for suppliers if checked</div>
                                </div>
                                
                                <div>
                                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">Permitted Currencies (from tender configuration):</label>
                                    <div style="padding: 8px 12px; background: white; border-radius: 4px; border: 1px solid var(--unops-n-cold-300);">
                                        <strong>USD, EUR</strong>
                                    </div>
                                    <div class="help-text">Suppliers will only be able to select these currencies</div>
                                </div>
                            </div>
                        </div>
                        <div class="form-toggle">
                            <span>Include</span>
                            <label class="switch">
                                <input type="checkbox" checked disabled>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Form D -->
                    <div class="form-selector-item selected">
                        <div class="form-selector-info">
                            <h4>Form D: Technical Bid Form <span class="badge badge-mandatory">MANDATORY</span></h4>
                            <p>Comparative data tables for technical specifications, delivery requirements, and related services. Bidders complete compliance columns only.</p>
                            
                            <div style="margin-top: 15px; padding: 15px; background: var(--unops-n-cold-50); border-radius: 8px; border: 1px solid var(--unops-n-cold-200);">
                                <div style="font-weight: 600; margin-bottom: 12px; color: var(--unops-blue2-700);">Technical Specifications Submission Options</div>
                                <div style="display: flex; flex-direction: column; gap: 10px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="checkbox" id="formDOnline" checked onchange="toggleFormDSubmission()">
                                        <span>Allow online form submission</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="checkbox" id="formDSpreadsheet" onchange="toggleFormDSubmission()">
                                        <span>Allow spreadsheet download and upload</span>
                                    </label>
                                </div>
                                <div class="help-text" style="margin-top: 10px;">
                                    Select how suppliers should submit technical specifications. You can enable one or both options.
                                </div>
                            </div>
                        </div>
                        <div class="form-toggle">
                            <span>Include</span>
                            <label class="switch">
                                <input type="checkbox" checked disabled>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Form E -->
                    <div class="form-selector-item">
                        <div class="form-selector-info">
                            <h4>Form E: Bid Security Form (Bank Guarantee) <span class="badge badge-conditional">CONDITIONAL</span></h4>
                            <p>Bank guarantee template for bid security. Only include if bid security is required per Tender Particulars.</p>
                        </div>
                        <div class="form-toggle">
                            <span>Include</span>
                            <label class="switch">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Form F -->
                    <div class="form-selector-item">
                        <div class="form-selector-info">
                            <h4>Form F: Manufacturer's Authorization Form <span class="badge badge-conditional">CONDITIONAL</span></h4>
                            <p>Letter from manufacturer authorizing bidder. Required when bidder is not the manufacturer. Only for goods procurement.</p>
                        </div>
                        <div class="form-toggle">
                            <span>Include</span>
                            <label class="switch">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Form G -->
                    <div class="form-selector-item selected">
                        <div class="form-selector-info">
                            <h4>Form G: Performance Statement Form <span class="badge badge-mandatory">MANDATORY</span></h4>
                            <p>Past performance references table. Normally mandatory in all ITBs unless specifically removed.</p>
                        </div>
                        <div class="form-toggle">
                            <span>Include</span>
                            <label class="switch">
                                <input type="checkbox" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Form H -->
                    <div class="form-selector-item selected">
                        <div class="form-selector-info">
                            <h4>Form H: Self Disclosure Form <span class="badge badge-mandatory">MANDATORY</span></h4>
                            <p>10-question self-disclosure covering eligibility, compliance, and ethical requirements. Required for all ITBs.</p>
                        </div>
                        <div class="form-toggle">
                            <span>Include</span>
                            <label class="switch">
                                <input type="checkbox" checked disabled>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 30px; display: flex; gap: 15px; justify-content: center;">
                    <button class="btn btn-secondary">üíæ Save Configuration</button>
                    <button class="btn btn-primary" onclick="alert('Generating form templates...')">üìÑ Generate Forms Package</button>
                    <button class="btn btn-success" onclick="switchView('supplier')">üëÅÔ∏è Preview Supplier View</button>
                </div>
            </div>
        </div>

        <!-- Supplier View -->
        <div class="supplier-view" id="supplierView">
            
            <!-- Tender Details Header -->
            <div class="tender-details-hero supplier-hero">
                <div class="tender-hero-header">
                    <div class="tender-hero-title">
                        <h1>Supply of Medical Equipment and Laboratory Supplies</h1>
                        <div class="tender-ref-badge">ITB/2025/60187</div>
                    </div>
                    <div class="tender-hero-meta">
                        <span class="meta-item">
                            <span class="meta-icon">üìç</span>
                            <span>Tashkent, Uzbekistan</span>
                        </span>
                        <span class="meta-item">
                            <span class="meta-icon">üì¶</span>
                            <span>Goods Only</span>
                        </span>
                        <span class="meta-item urgent">
                            <span class="meta-icon">‚è±Ô∏è</span>
                            <span><strong>Deadline:</strong> Dec 31, 2025 23:59 UTC</span>
                        </span>
                    </div>
                </div>

                <div class="tender-details-cards">
                    <div class="detail-card highlight">
                        <div class="detail-card-icon">‚è≥</div>
                        <div class="detail-card-content">
                            <div class="detail-card-label">Bid Validity Period</div>
                            <div class="detail-card-value">90 days</div>
                        </div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-card-icon">üí±</div>
                        <div class="detail-card-content">
                            <div class="detail-card-label">Permitted Currencies</div>
                            <div class="detail-card-value">USD, EUR</div>
                        </div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-card-icon">üöö</div>
                        <div class="detail-card-content">
                            <div class="detail-card-label">Permitted Incoterms</div>
                            <div class="detail-card-value">FCA, CPT, DPU</div>
                        </div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-card-icon">üéØ</div>
                        <div class="detail-card-content">
                            <div class="detail-card-label">Evaluation Method</div>
                            <div class="detail-card-value">Lowest evaluated bid</div>
                        </div>
                    </div>
                </div>

                <div class="tender-requirements-summary">
                    <h3>üìã Schedule of Requirements</h3>
                    <div class="requirements-grid">
                        <div class="requirement-item">
                            <div class="req-code">43211500</div>
                            <div class="req-description">Desktop computers</div>
                            <div class="req-qty">Qty: 50</div>
                        </div>
                        <div class="requirement-item">
                            <div class="req-code">43211503</div>
                            <div class="req-description">Laptop computers</div>
                            <div class="req-qty">Qty: 30</div>
                        </div>
                        <div class="requirement-item">
                            <div class="req-code">43212104</div>
                            <div class="req-description">Computer monitors</div>
                            <div class="req-qty">Qty: 80</div>
                        </div>
                        <div class="requirement-item">
                            <div class="req-code">43222604</div>
                            <div class="req-description">Computer printers</div>
                            <div class="req-qty">Qty: 20</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="progress-indicator">
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 0%" id="progressBar"></div>
                </div>
                <div class="progress-text" id="progressText">0% Complete - 0 of 6 forms submitted</div>
            </div>

            <div class="two-col-layout">
                <div class="form-navigation">
                    <h3>üìã Forms</h3>
                    <ul>
                        <li class="active incomplete" onclick="scrollToForm('formA')">Form A - JV Partner Info</li>
                        <li class="incomplete" onclick="scrollToForm('formB')">Form B - Bid Submission</li>
                        <li class="incomplete" onclick="scrollToForm('formC')">Form C - Price Schedule</li>
                        <li class="incomplete" onclick="scrollToForm('formD')">Form D - Technical Bid</li>
                        <li class="incomplete" onclick="scrollToForm('formG')">Form G - Performance Statement</li>
                        <li class="incomplete" onclick="scrollToForm('formH')">Form H - Self Disclosure</li>
                    </ul>
                </div>

                <div>
                    <!-- FORM A: Joint Venture Partner Information -->
                    <div class="form-document" id="formA">
                        <div class="form-section-header" style="color: #ffffff !important; background: linear-gradient(135deg, #00476c 0%, #003c5d 100%) !important;">Form A: Joint Venture Partner Information Form</div>
                        <div class="form-section-body">
                        <div class="form-note">
                            <strong>Instructions:</strong> The Bidder shall fill in this Form in accordance with the instructions indicated below. To be completed and returned with your Bid if the Bid is submitted as a Joint Venture/Consortium/Association.
                        </div>

                        <div class="section-header-text">JV / Consortium / Association Information</div>

                        <div class="form-field-group">
                            <label class="form-label">JV / Consortium / Association Name: <span class="required">*</span></label>
                            <input type="text" class="form-input" placeholder="Complete" id="jvNameSupplier">
                            <div class="help-text">Enter the name of the Joint Venture, Consortium, or Association</div>
                        </div>

                        <div class="form-note info">
                            <p>Add all partners in the Joint Venture/Consortium/Association below. For each partner, provide complete contact information and specify their share of responsibility. One partner must be designated as the <strong>Leading Partner</strong> who will have authority to bind the JV during the bidding process and contract execution.</p>
                        </div>

                        <div id="partnersContainerSupplier"></div>

                        <div class="percentage-summary" id="percentageSummarySupplier">
                            <span class="percentage-summary-text">Total Share: <span id="totalPercentageSupplier">0</span>%</span>
                            <span id="percentageStatusSupplier">Must equal 100%</span>
                        </div>

                        <button class="add-partner-btn" onclick="addJVPartnerSupplier()">
                            <span>‚ûï</span> Add Partner
                        </button>

                        <div class="form-note" style="margin-top: 30px;">
                            We hereby confirm that if the contract is awarded, all parties of the Joint Venture/Consortium/Association shall be jointly and severally liable to UNOPS for the fulfillment of the provisions of the Contract.
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                            <div>
                                <button class="download-pdf-btn" onclick="downloadFormAPDF()" style="width: 100%;">
                                    <span>üì•</span> Download Form A as PDF for Signatures
                                </button>
                            </div>
                            <div style="border: 2px dashed var(--unops-n-cold-300); border-radius: 12px; padding: 20px; background: var(--unops-n-cold-50); text-align: center; transition: all 0.3s;">
                                <label for="form-a-upload" style="cursor: pointer; display: block;">
                                    <div style="color: var(--unops-blue2-600); font-size: 2em; margin-bottom: 8px;">üì§</div>
                                    <div style="font-weight: 600; color: var(--unops-n-cold-900); margin-bottom: 5px;">Upload Signed Document</div>
                                    <div style="font-size: 12px; color: var(--unops-n-cold-600);">Click or drag file here</div>
                                    <input type="file" id="form-a-upload" accept=".pdf,.jpg,.png" style="display: none;" onchange="handleFormAUpload(this)">
                                </label>
                                <div id="upload-status" style="margin-top: 10px; font-size: 12px; color: var(--unops-green-600);"></div>
                            </div>
                        </div>

                        <div class="form-note info" style="margin-top: 15px;">
                            <p><strong>Next steps:</strong> After completing all partner information, download this form as PDF, obtain signatures from all partners, and upload the signed document back to the system.</p>
                        </div>
                        </div>
                    </div>

                    <!-- FORM B: Bid Submission Form -->
                    <div class="form-document" id="formB">
                        <div class="form-section-header" style="color: #ffffff !important; background: linear-gradient(135deg, #00476c 0%, #003c5d 100%) !important;">Form B: Bid Submission Form</div>
                        <div class="form-section-body">
                        <div class="form-note">
                            <strong>Instructions:</strong> Bidders are requested to complete this form, sign it and return it as part of their bid submission. The bidder shall fill in this form in accordance with the instructions indicated. No alterations to its format shall be permitted and no substitutions shall be accepted.
                        </div>

                        <div class="form-note info">
                            <p>‚ÑπÔ∏è Fields highlighted in blue are <strong>pre-populated</strong> from previous steps and tender configuration. Please review for accuracy.</p>
                        </div>

                        <div class="declaration-box">
                            <p style="font-weight: 600; margin-bottom: 15px;">We, the undersigned, declare that:</p>
                            
                            <ol>
                                <li>We have examined and have no reservations to the bidding documents, including amendments: 
                                    <div style="display: inline-flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
                                        <span class="prefilled-inline">No. 01 - Dec 5, 2025</span>
                                        <span class="prefilled-inline">No. 02 - Dec 12, 2025</span>
                                        <span class="prefilled-inline">No. 03 - Dec 18, 2025</span>
                                    </div>
                                ;</li>
                                
                                <li>We offer to supply in conformity with the bidding documents, including the UNOPS General Conditions of Contract, and in accordance with the delivery schedules specified in the Schedule of Requirements;</li>
                                
                                <li>The total price of our bid, excluding any discounts offered in item (d) below, is: 
                                    <span class="prefilled-inline" style="display: inline-block; padding: 6px 12px; margin: 0 5px;">USD 125,450.00</span> 
                                    (One hundred twenty-five thousand, four hundred fifty US Dollars);</li>
                                
                                <li>The discounts offered and the methodology for their application are:
                                    <ul style="list-style: none; margin-top: 10px;">
                                        <li><strong>Discounts:</strong> If our bid is accepted, the following discounts shall apply:
                                            <div class="prefilled-box" style="margin-top: 8px;">
                                                <div style="margin-bottom: 6px;">‚Ä¢ <strong>Volume Discount:</strong> 3% discount for total order value exceeding $100,000</div>
                                                <div style="margin-bottom: 6px;">‚Ä¢ <strong>Early Payment Discount:</strong> 2% discount if payment is made within 15 days of invoice date</div>
                                                <div>‚Ä¢ <strong>Multi-year Contract:</strong> 5% discount for contracts extending beyond 24 months</div>
                                            </div>
                                        </li>
                                        <li style="margin-top: 15px;"><strong>Methodology of application of the discounts:</strong> The discounts shall be applied using the following method:
                                            <div class="prefilled-box" style="margin-top: 8px;">
                                                Volume discount will be calculated on the total bid price (excluding taxes and delivery costs). Early payment discount will be applied to the net invoice amount after volume discount. Multi-year discount applies to the annual value and is calculated before other discounts. Discounts are cumulative and applied in the order listed above.
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                
                                <li>Our bid shall be valid for the period of time of <input type="number" class="prefilled-field-inline" value="90" readonly> days from the date fixed for the bid submission deadline as set out in the ITB, and it shall remain binding upon us and may be accepted at any time before the expiration of that period;</li>
                                
                                <li>If our bid is accepted, and if so requested in the Tender Particulars section, we commit to obtain a performance security in accordance with Instructions to Bidders Article 34 and the General Conditions of Contract;</li>
                                
                                <li>We have no conflict of interest in any activity that would put it, if selected for this assignment, in a conflict of interest with UNOPS;</li>
                                
                                <li>We have not declared bankruptcy, are not involved in bankruptcy or receivership proceedings, and there is no judgment or pending legal action against them that could impair their operations in the foreseeable future;</li>
                                
                                <li>Our firm confirms that the Bidder and sub-contractors have not been associated, or had been involved in any way, directly or indirectly, with the preparation of the design, terms of references and/or other documents used as a part of this solicitation;</li>
                                
                                <li>We embrace the principles of the United Nations Supplier Code of Conduct and adhere to the principles of the United Nations Global Compact;</li>
                                
                                <li>Our firm, its affiliates or subsidiaries ‚Äì including any subcontractors or suppliers for any part of the contract ‚Äì has not been declared ineligible by UNOPS, nor is included in the suspended/ineligibility list of the UN/PD, other UN Agencies, the UN Security Council, and the World Bank, in accordance with Instructions to Bidders Article 4, Eligibility;</li>
                                
                                <li>We have not offered and will not offer fees, gifts and/or favours of kind in exchange for this ITB and will not engage in any such activity during the performance of any contract awarded;</li>
                                
                                <li>We understand that you are not bound to accept the lowest evaluated bid or any other bid that you may receive.</li>
                            </ol>
                        </div>
                        </div>
                    </div>

                    <!-- FORM C: Price Schedule Form -->
                    <div class="form-document" id="formC">
                        <div class="form-section-header" style="color: #ffffff !important; background: linear-gradient(135deg, #00476c 0%, #003c5d 100%) !important;">Form C: Price Schedule Form</div>
                        <div class="form-section-body">
                        
                        <div class="form-note">
                            <strong>Note to Bidders:</strong> Bidders shall fill in these Price Schedule Forms in accordance with the instructions indicated. Procurement officials ensure tables are adapted according to the Schedule of Requirements and applicable Incoterms rules.
                        </div>

                        <div class="section-header-text">Bid Summary</div>
                        
                        <div class="form-note info">
                            <p>üí° <strong>Calculated fields</strong> are automatically computed from the pricing tables below. Currency is restricted to: <strong>USD, EUR</strong></p>
                        </div>

                        <table class="itb-table">
                            <!-- Dynamic Incoterm rows based on tender configuration -->
                            <tr class="incoterm-row-fca">
                                <td style="font-weight: 600; width: 60%;">Bidder's Total prices <strong>FCA</strong> (Price of goods FCA + Related Services if applicable)</td>
                                <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select class="prefilled-field" style="width: 100px;" disabled>
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                        <input type="text" class="prefilled-field" value="125,450.00" readonly style="flex: 1;">
                                    </div>
                                    <div class="help-text">Auto-calculated from prices table</div>
                                </td>
                            </tr>
                            <tr class="incoterm-row-cpt">
                                <td style="font-weight: 600;">Bidder's Total prices <strong>CPT</strong> (Price of goods CPT + Related Services if applicable)</td>
                                <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select class="prefilled-field" style="width: 100px;" disabled>
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                        <input type="text" class="prefilled-field" value="132,780.00" readonly style="flex: 1;">
                                    </div>
                                    <div class="help-text">Auto-calculated from prices table</div>
                                </td>
                            </tr>
                            <tr class="incoterm-row-dpu">
                                <td style="font-weight: 600;">Bidder's Total prices <strong>DPU</strong> (Price of goods DPU + Related Services if applicable)</td>
                                <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select class="prefilled-field" style="width: 100px;" disabled>
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                        <input type="text" class="prefilled-field" value="138,215.00" readonly style="flex: 1;">
                                    </div>
                                    <div class="help-text">Auto-calculated from prices table</div>
                                </td>
                            </tr>
                            <tr style="border-top: 2px solid var(--unops-n-cold-300);" class="incoterm-row-fca">
                                <td style="font-weight: 600;">Total Price of Goods <strong>FCA</strong></td>
                                <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select class="prefilled-field" style="width: 100px;" disabled>
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                        <input type="text" class="prefilled-field" value="120,000.00" readonly style="flex: 1;">
                                    </div>
                                    <div class="help-text">Auto-calculated from prices table</div>
                                </td>
                            </tr>
                            <tr class="incoterm-row-cpt">
                                <td style="font-weight: 600;">Total Price of Goods <strong>CPT</strong></td>
                                <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select class="prefilled-field" style="width: 100px;" disabled>
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                        <input type="text" class="prefilled-field" value="127,330.00" readonly style="flex: 1;">
                                    </div>
                                    <div class="help-text">Auto-calculated from prices table</div>
                                </td>
                            </tr>
                            <tr class="incoterm-row-dpu">
                                <td style="font-weight: 600;">Total Price of Goods <strong>DPU</strong></td>
                                <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select class="prefilled-field" style="width: 100px;" disabled>
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                        <input type="text" class="prefilled-field" value="132,765.00" readonly style="flex: 1;">
                                    </div>
                                    <div class="help-text">Auto-calculated from prices table</div>
                                </td>
                            </tr>
                            <tr style="border-top: 2px solid var(--unops-n-cold-300);">
                                <td style="font-weight: 600;">Total Price of Related Services</td>
                                <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select class="prefilled-field" style="width: 100px;" disabled>
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                        <input type="text" class="prefilled-field" value="5,450.00" readonly style="flex: 1;">
                                    </div>
                                    <div class="help-text">Auto-calculated from related services table</div>
                                </td>
                            </tr>
                            <!-- Optional customizable rows (configurable by tender author) -->
                            <tr style="border-top: 2px solid var(--unops-yellow-300); background: var(--unops-yellow-0);">
                                <td style="font-weight: 600;">
                                    Freight Cost per 20/40 ft. container
                                    <span class="badge" style="background: var(--unops-yellow-400); color: white; font-size: 0.75em; padding: 2px 6px; border-radius: 3px; margin-left: 8px;">OPTIONAL</span>
                                </td>
                                <td class="editable-cell">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select style="width: 100px;">
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                        <input type="number" placeholder="0.00" style="flex: 1;">
                                    </div>
                                    <div class="help-text">Visible only if enabled by tender author</div>
                                </td>
                            </tr>
                            <tr style="background: var(--unops-yellow-0);">
                                <td style="font-weight: 600;">
                                    Customs clearance costs
                                    <span class="badge" style="background: var(--unops-yellow-400); color: white; font-size: 0.75em; padding: 2px 6px; border-radius: 3px; margin-left: 8px;">OPTIONAL</span>
                                </td>
                                <td class="editable-cell">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select style="width: 100px;">
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                        <input type="number" placeholder="0.00" style="flex: 1;">
                                    </div>
                                    <div class="help-text">Visible only if enabled by tender author</div>
                                </td>
                            </tr>
                        </table>

                        <div class="section-header-text">Prices for Goods</div>
                        
                        <div class="form-note info">
                            <p>üí° Price columns shown based on selected Incoterms. Total prices auto-calculated. Currency dropdown limited to: <strong>USD, EUR</strong></p>
                        </div>

                        <table class="itb-table">
                            <thead>
                                <tr>
                                    <th style="width: 5%; color: #ffffff !important; background: #00476c !important;">Item</th>
                                    <th style="width: 25%; color: #ffffff !important; background: #00476c !important;">Description</th>
                                    <th style="width: 8%; color: #ffffff !important; background: #00476c !important;">Qty (a)</th>
                                    <th style="width: 8%; color: #ffffff !important; background: #00476c !important;">Currency</th>
                                    <th class="incoterm-fca" style="width: 12%; color: #ffffff !important; background: #00476c !important;">Unit price FCA (b)</th>
                                    <th class="incoterm-cpt" style="width: 12%; color: #ffffff !important; background: #00476c !important;">Unit price CPT (c)</th>
                                    <th class="incoterm-dpu" style="width: 12%; color: #ffffff !important; background: #00476c !important;">Unit price DPU (d)</th>
                                    <th class="incoterm-fca" style="width: 12%; color: #ffffff !important; background: #00476c !important;">Total FCA (a)√ó(b)</th>
                                    <th class="incoterm-cpt" style="width: 12%; color: #ffffff !important; background: #00476c !important;">Total CPT (a)√ó(c)</th>
                                    <th class="incoterm-dpu" style="width: 12%; color: #ffffff !important; background: #00476c !important;">Total DPU (a)√ó(d)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1.</td>
                                    <td>Desktop computers (UNSPSC: 43211500)</td>
                                    <td style="text-align: center;">50</td>
                                    <td>
                                        <select style="width: 100%;">
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell incoterm-fca"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="editable-cell incoterm-cpt"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="editable-cell incoterm-dpu"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="readonly-cell incoterm-fca" style="background: var(--unops-blue-0) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%;"></td>
                                    <td class="readonly-cell incoterm-cpt" style="background: var(--unops-blue-0) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%;"></td>
                                    <td class="readonly-cell incoterm-dpu" style="background: var(--unops-blue-0) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%;"></td>
                                </tr>
                                <tr>
                                    <td>2.</td>
                                    <td>Laptop computers (UNSPSC: 43211503)</td>
                                    <td style="text-align: center;">30</td>
                                    <td>
                                        <select style="width: 100%;">
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell incoterm-fca"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="editable-cell incoterm-cpt"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="editable-cell incoterm-dpu"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="readonly-cell incoterm-fca" style="background: var(--unops-blue-0) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%;"></td>
                                    <td class="readonly-cell incoterm-cpt" style="background: var(--unops-blue-0) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%;"></td>
                                    <td class="readonly-cell incoterm-dpu" style="background: var(--unops-blue-0) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%;"></td>
                                </tr>
                                <tr>
                                    <td>3.</td>
                                    <td>Computer monitors (UNSPSC: 43212104)</td>
                                    <td style="text-align: center;">80</td>
                                    <td>
                                        <select style="width: 100%;">
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell incoterm-fca"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="editable-cell incoterm-cpt"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="editable-cell incoterm-dpu"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="readonly-cell incoterm-fca" style="background: var(--unops-blue-0) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%;"></td>
                                    <td class="readonly-cell incoterm-cpt" style="background: var(--unops-blue-0) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%;"></td>
                                    <td class="readonly-cell incoterm-dpu" style="background: var(--unops-blue-0) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%;"></td>
                                </tr>
                                <tr>
                                    <td>4.</td>
                                    <td>Computer printers (UNSPSC: 43222604)</td>
                                    <td style="text-align: center;">20</td>
                                    <td>
                                        <select style="width: 100%;">
                                            <option>USD</option>
                                            <option>EUR</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell incoterm-fca"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="editable-cell incoterm-cpt"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="editable-cell incoterm-dpu"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="readonly-cell incoterm-fca" style="background: var(--unops-blue-0) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%;"></td>
                                    <td class="readonly-cell incoterm-cpt" style="background: var(--unops-blue-0) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%;"></td>
                                    <td class="readonly-cell incoterm-dpu" style="background: var(--unops-blue-0) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%;"></td>
                                </tr>
                                <tr style="font-weight: 600; background: var(--unops-n-cold-100);">
                                    <td colspan="7" style="text-align: right; padding-right: 15px;">Total Price of Goods ‚Üí</td>
                                    <td class="readonly-cell incoterm-fca" style="background: var(--unops-blue-100) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%; font-weight: 700;"></td>
                                    <td class="readonly-cell incoterm-cpt" style="background: var(--unops-blue-100) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%; font-weight: 700;"></td>
                                    <td class="readonly-cell incoterm-dpu" style="background: var(--unops-blue-100) !important;"><input type="text" readonly value="0.00" class="prefilled-field" style="width: 100%; font-weight: 700;"></td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="section-header-text related-services-section">Prices for Related Services</div>
                        
                        <div class="form-note info related-services-section">
                            <p>üí° Service descriptions and quantities are <strong>pre-populated</strong> from the Schedule of Requirements. Only unit prices need to be entered. Total prices are auto-calculated.</p>
                        </div>

                        <table class="itb-table related-services-section">
                            <thead>
                                <tr>
                                    <th style="color: #ffffff !important; background: #00476c !important;">Item</th>
                                    <th style="color: #ffffff !important; background: #00476c !important;">Description of the services</th>
                                    <th style="color: #ffffff !important; background: #00476c !important;">Quantity and physical unit (a) if applicable</th>
                                    <th style="color: #ffffff !important; background: #00476c !important;">Unit price (b) if applicable</th>
                                    <th style="color: #ffffff !important; background: #00476c !important;">Total price per service (a)√ó(b)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1.</td>
                                    <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                        <input type="text" class="prefilled-field" value="Installation and Configuration" readonly style="width: 100%;">
                                        <div class="help-text">Pre-populated from tender requirements</div>
                                    </td>
                                    <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                        <input type="text" class="prefilled-field" value="1 service" readonly style="width: 100%;">
                                        <div class="help-text">From Schedule of Requirements</div>
                                    </td>
                                    <td class="editable-cell"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="readonly-cell" style="background: var(--unops-blue-0) !important;"><input type="text" class="prefilled-field" readonly value="0.00" style="width: 100%;"></td>
                                </tr>
                                <tr>
                                    <td>2.</td>
                                    <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                        <input type="text" class="prefilled-field" value="Training (3 days)" readonly style="width: 100%;">
                                        <div class="help-text">Pre-populated from tender requirements</div>
                                    </td>
                                    <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                        <input type="text" class="prefilled-field" value="10 persons" readonly style="width: 100%;">
                                        <div class="help-text">From Schedule of Requirements</div>
                                    </td>
                                    <td class="editable-cell"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="readonly-cell" style="background: var(--unops-blue-0) !important;"><input type="text" class="prefilled-field" readonly value="0.00" style="width: 100%;"></td>
                                </tr>
                                <tr>
                                    <td>3.</td>
                                    <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                        <input type="text" class="prefilled-field" value="Extended Warranty (2 years)" readonly style="width: 100%;">
                                        <div class="help-text">Pre-populated from tender requirements</div>
                                    </td>
                                    <td class="readonly-cell" style="background: var(--unops-blue-0) !important;">
                                        <input type="text" class="prefilled-field" value="All items" readonly style="width: 100%;">
                                        <div class="help-text">From Schedule of Requirements</div>
                                    </td>
                                    <td class="editable-cell"><input type="number" step="0.01" placeholder="0.00" style="width: 100%;"></td>
                                    <td class="readonly-cell" style="background: var(--unops-blue-0) !important;"><input type="text" class="prefilled-field" readonly value="0.00" style="width: 100%;"></td>
                                </tr>
                                <tr style="font-weight: 600; background: var(--unops-n-cold-100);">
                                    <td colspan="4" style="text-align: right; padding-right: 15px;">Total Price of Related Services ‚Üí</td>
                                    <td class="readonly-cell" style="background: var(--unops-blue-100) !important;"><input type="text" class="prefilled-field" readonly value="0.00" style="width: 100%; font-weight: 700;"></td>
                                </tr>
                            </tbody>
                        </table>

                        <div id="shipment-delivery-section">
                        <div class="section-header-text">Shipment & Delivery Information</div>

                        <table class="itb-table" id="shipment-delivery-table">
                            <thead>
                                <tr id="shipment-header-row-1">
                                    <th rowspan="2" data-col="item" style="color: #ffffff !important; background: #00476c !important;">Item</th>
                                    <th rowspan="2" data-col="fca-delivery" class="shipment-col-fca-delivery" style="color: #ffffff !important; background: #00476c !important;">FCA Point(s) of Delivery</th>
                                    <th rowspan="2" data-col="dimensions" class="shipment-col-dimensions" style="color: #ffffff !important; background: #00476c !important;">Shipment dimensions<br>(Including package)</th>
                                    <th rowspan="2" data-col="weight" class="shipment-col-weight" style="color: #ffffff !important; background: #00476c !important;">Gross weight</th>
                                    <th rowspan="2" data-col="volume" class="shipment-col-volume" style="color: #ffffff !important; background: #00476c !important;">Total volume</th>
                                    <th colspan="2" data-col="containers" class="shipment-col-containers" style="color: #ffffff !important; background: #00476c !important;">Containers (if applicable)</th>
                                </tr>
                                <tr id="shipment-header-row-2">
                                    <th data-col="container-num" class="shipment-col-container-num" style="color: #ffffff !important; background: #00476c !important;">Number</th>
                                    <th data-col="container-size" class="shipment-col-container-size" style="color: #ffffff !important; background: #00476c !important;">Size</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td data-col="item" style="font-weight: 600;">Desktop computers (UNSPSC: 43211500)</td>
                                    <td data-col="fca-delivery" class="editable-cell shipment-col-fca-delivery"><input type="text" placeholder="City, Country" style="width: 100%;"></td>
                                    <td data-col="dimensions" class="editable-cell shipment-col-dimensions"><input type="text" placeholder="L√óW√óH cm" style="width: 100%;"></td>
                                    <td data-col="weight" class="editable-cell shipment-col-weight"><input type="text" placeholder="kg" style="width: 100%;"></td>
                                    <td data-col="volume" class="editable-cell shipment-col-volume"><input type="text" placeholder="m¬≥" style="width: 100%;"></td>
                                    <td data-col="container-num" class="editable-cell shipment-col-container-num"><input type="text" placeholder="0" style="width: 100%;"></td>
                                    <td data-col="container-size" class="editable-cell shipment-col-container-size"><input type="text" placeholder="20/40 ft" style="width: 100%;"></td>
                                </tr>
                                <tr>
                                    <td data-col="item" style="font-weight: 600;">Laptop computers (UNSPSC: 43211503)</td>
                                    <td data-col="fca-delivery" class="editable-cell shipment-col-fca-delivery"><input type="text" placeholder="City, Country" style="width: 100%;"></td>
                                    <td data-col="dimensions" class="editable-cell shipment-col-dimensions"><input type="text" placeholder="L√óW√óH cm" style="width: 100%;"></td>
                                    <td data-col="weight" class="editable-cell shipment-col-weight"><input type="text" placeholder="kg" style="width: 100%;"></td>
                                    <td data-col="volume" class="editable-cell shipment-col-volume"><input type="text" placeholder="m¬≥" style="width: 100%;"></td>
                                    <td data-col="container-num" class="editable-cell shipment-col-container-num"><input type="text" placeholder="0" style="width: 100%;"></td>
                                    <td data-col="container-size" class="editable-cell shipment-col-container-size"><input type="text" placeholder="20/40 ft" style="width: 100%;"></td>
                                </tr>
                                <tr>
                                    <td data-col="item" style="font-weight: 600;">Computer monitors (UNSPSC: 43212104)</td>
                                    <td data-col="fca-delivery" class="editable-cell shipment-col-fca-delivery"><input type="text" placeholder="City, Country" style="width: 100%;"></td>
                                    <td data-col="dimensions" class="editable-cell shipment-col-dimensions"><input type="text" placeholder="L√óW√óH cm" style="width: 100%;"></td>
                                    <td data-col="weight" class="editable-cell shipment-col-weight"><input type="text" placeholder="kg" style="width: 100%;"></td>
                                    <td data-col="volume" class="editable-cell shipment-col-volume"><input type="text" placeholder="m¬≥" style="width: 100%;"></td>
                                    <td data-col="container-num" class="editable-cell shipment-col-container-num"><input type="text" placeholder="0" style="width: 100%;"></td>
                                    <td data-col="container-size" class="editable-cell shipment-col-container-size"><input type="text" placeholder="20/40 ft" style="width: 100%;"></td>
                                </tr>
                                <tr>
                                    <td data-col="item" style="font-weight: 600;">Computer printers (UNSPSC: 43222604)</td>
                                    <td data-col="fca-delivery" class="editable-cell shipment-col-fca-delivery"><input type="text" placeholder="City, Country" style="width: 100%;"></td>
                                    <td data-col="dimensions" class="editable-cell shipment-col-dimensions"><input type="text" placeholder="L√óW√óH cm" style="width: 100%;"></td>
                                    <td data-col="weight" class="editable-cell shipment-col-weight"><input type="text" placeholder="kg" style="width: 100%;"></td>
                                    <td data-col="volume" class="editable-cell shipment-col-volume"><input type="text" placeholder="m¬≥" style="width: 100%;"></td>
                                    <td data-col="container-num" class="editable-cell shipment-col-container-num"><input type="text" placeholder="0" style="width: 100%;"></td>
                                    <td data-col="container-size" class="editable-cell shipment-col-container-size"><input type="text" placeholder="20/40 ft" style="width: 100%;"></td>
                                </tr>
                                <tr style="font-weight: 600; background: var(--unops-n-cold-100);">
                                    <td colspan="7" style="text-align: center; padding: 15px; color: var(--unops-n-cold-600);">
                                        <em>Total values calculated from individual entries above</em>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        </div>
                        </div>
                    </div>

                    <!-- FORM D: Technical Bid Form -->
                    <div class="form-document" id="formD">
                        <div class="form-section-header" style="color: #ffffff !important; background: linear-gradient(135deg, #00476c 0%, #003c5d 100%) !important;">Form D: Technical Bid Form</div>
                        <div class="form-section-body">
                        
                        <div class="form-note">
                            <strong>Instructions:</strong> Bidders are required to complete the <strong>Comparative Data Tables</strong> included in Section II: Schedule of Requirements to demonstrate compliance with UNOPS requirements and insert them below. Bidders are NOT allowed to make any change in the "UNOPS requirements" columns of the Comparative Data Tables. Such changes might disqualify your bid.
                        </div>

                        <div class="form-note">
                            Bidders shall fill in all coloured cells in the Comparative Data Tables below to demonstrate compliance with UNOPS requirements. Bidders are NOT allowed to make any changes in the "UNOPS requirements" columns of the Comparative Data Tables. Such changes might disqualify your quotation.
                        </div>

                        <div class="section-header-text">Technical specifications for goods ‚Äì Comparative Data Table</div>
                        
                        <!-- Submission Options (Spreadsheet Download/Upload) -->
                        <div id="formDSpreadsheetOptions" style="display: none; margin: 20px 0;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                <div>
                                    <button class="download-pdf-btn" onclick="downloadTechnicalSpecsSpreadsheet()" style="width: 100%;">
                                        <span>üì•</span> Download Technical Specifications Spreadsheet
                                    </button>
                                    <div class="help-text" style="margin-top: 8px;">
                                        Download the technical specifications template, fill it out with your data, and upload below.
                                    </div>
                                </div>
                                <div style="border: 2px dashed var(--unops-n-cold-300); border-radius: 12px; padding: 20px; background: var(--unops-n-cold-50); text-align: center; transition: all 0.3s;">
                                    <label for="tech-specs-upload" style="cursor: pointer; display: block;">
                                        <div style="color: var(--unops-blue2-600); font-size: 2em; margin-bottom: 8px;">üì§</div>
                                        <div style="font-weight: 600; color: var(--unops-n-cold-900); margin-bottom: 5px;">Upload Completed Spreadsheet</div>
                                        <div style="font-size: 12px; color: var(--unops-n-cold-600);">Click or drag file here (Excel format)</div>
                                        <input type="file" id="tech-specs-upload" accept=".xlsx,.xls" style="display: none;" onchange="handleTechSpecsUpload(this)">
                                    </label>
                                    <div id="tech-specs-upload-status" style="margin-top: 10px; font-size: 12px; color: var(--unops-green-600);"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Online Form Section -->
                        <div id="formDOnlineForm">
                        <div style="font-weight: 600; margin: 15px 0; color: var(--unops-blue2-700);">UNSPSC Code: 43211500 - Desktop computers</div>

                        <table class="itb-table" style="margin-bottom: 15px;">
                            <tr>
                                <td style="font-weight: 600; width: 30%;">Model (full name)</td>
                                <td class="editable-cell"><input type="text" placeholder="Insert Details"></td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600;">Manufacturer</td>
                                <td class="editable-cell">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <input type="text" placeholder="Full legal name" style="flex: 1;">
                                        <input type="text" placeholder="UNGM ID (optional)" style="width: 150px;">
                                        <button type="button" class="add-row-btn" style="margin: 0; padding: 8px 16px; font-size: 12px;">üîç Search UNGM</button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600;">Manufacturer Address</td>
                                <td class="editable-cell"><textarea placeholder="Full address" rows="2"></textarea></td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600;">Subcontractor (if applicable)</td>
                                <td class="editable-cell">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <input type="text" placeholder="Full legal name" style="flex: 1;">
                                        <input type="text" placeholder="UNGM ID (optional)" style="width: 150px;">
                                        <button type="button" class="add-row-btn" style="margin: 0; padding: 8px 16px; font-size: 12px;">üîç Search UNGM</button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600;">Country of Origin</td>
                                <td class="editable-cell"><input type="text" placeholder="Insert Details"></td>
                            </tr>
                        </table>

                        <table class="comparative-table">
                            <thead>
                                <tr>
                                    <th style="width: 40px; color: white;">#</th>
                                    <th style="width: 40%; color: white;">Item Specification</th>
                                    <th style="width: 15%; color: white;">Is quotation compliant?<br>Bidder to complete</th>
                                    <th style="color: white;">Details of goods offered.<br>Bidder to complete</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="item-number">1</td>
                                    <td class="spec-text">PCR cabinet, tabletop</td>
                                    <td class="compliance-col">
                                        <div class="checkbox-options">
                                            <div class="checkbox-option"><input type="checkbox"> Yes</div>
                                            <div class="checkbox-option"><input type="checkbox"> No</div>
                                        </div>
                                    </td>
                                    <td class="details-col"><textarea placeholder="Insert details of goods offered, including relevant specifications and references to manuals"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="item-number">2</td>
                                    <td class="spec-text">Link to the proposed model: The participant must provide a link to the proposed model on the Manufacturer's website in English.</td>
                                    <td class="compliance-col">
                                        <div class="checkbox-options">
                                            <div class="checkbox-option"><input type="checkbox"> Yes</div>
                                            <div class="checkbox-option"><input type="checkbox"> No</div>
                                        </div>
                                    </td>
                                    <td class="details-col"><textarea placeholder="Insert details of goods offered, including relevant specifications and references to manuals"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="item-number">3</td>
                                    <td class="spec-text">Tabletop PCR cabinet with UV lamp.</td>
                                    <td class="compliance-col">
                                        <div class="checkbox-options">
                                            <div class="checkbox-option"><input type="checkbox"> Yes</div>
                                            <div class="checkbox-option"><input type="checkbox"> No</div>
                                        </div>
                                    </td>
                                    <td class="details-col"><textarea placeholder="Insert details of goods offered, including relevant specifications and references to manuals"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="item-number">4</td>
                                    <td class="spec-text">Controlled by microprocessor.</td>
                                    <td class="compliance-col">
                                        <div class="checkbox-options">
                                            <div class="checkbox-option"><input type="checkbox"> Yes</div>
                                            <div class="checkbox-option"><input type="checkbox"> No</div>
                                        </div>
                                    </td>
                                    <td class="details-col"><textarea placeholder="Insert details of goods offered"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="item-number">5</td>
                                    <td class="spec-text">Work surface made of Stainless Steel AISI 304, polypropylene or better quality material.</td>
                                    <td class="compliance-col">
                                        <div class="checkbox-options">
                                            <div class="checkbox-option"><input type="checkbox"> Yes</div>
                                            <div class="checkbox-option"><input type="checkbox"> No</div>
                                        </div>
                                    </td>
                                    <td class="details-col"><textarea placeholder="Insert details of goods offered"></textarea></td>
                                </tr>
                            </tbody>
                        </table>

                        <div style="margin: 20px 0;">
                            <strong>ANY DEVIATION MUST BE LISTED BELOW:</strong>
                            <textarea class="form-input" rows="5" placeholder="List any deviations from requirements for Desktop computers"></textarea>
                        </div>

                        <!-- Second UNSPSC Table -->
                        <div style="font-weight: 600; margin: 40px 0 15px 0; color: var(--unops-blue2-700);">UNSPSC Code: 43211503 - Laptop computers</div>

                        <table class="itb-table" style="margin-bottom: 15px;">
                            <tr>
                                <td style="font-weight: 600; width: 30%;">Model (full name)</td>
                                <td class="editable-cell"><input type="text" placeholder="Insert Details"></td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600;">Manufacturer</td>
                                <td class="editable-cell">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <input type="text" placeholder="Full legal name" style="flex: 1;">
                                        <input type="text" placeholder="UNGM ID (optional)" style="width: 150px;">
                                        <button type="button" class="add-row-btn" style="margin: 0; padding: 8px 16px; font-size: 12px;">üîç Search UNGM</button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600;">Manufacturer Address</td>
                                <td class="editable-cell"><textarea placeholder="Full address" rows="2"></textarea></td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600;">Subcontractor (if applicable)</td>
                                <td class="editable-cell">
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <input type="text" placeholder="Full legal name" style="flex: 1;">
                                        <input type="text" placeholder="UNGM ID (optional)" style="width: 150px;">
                                        <button type="button" class="add-row-btn" style="margin: 0; padding: 8px 16px; font-size: 12px;">üîç Search UNGM</button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="font-weight: 600;">Country of Origin</td>
                                <td class="editable-cell"><input type="text" placeholder="Insert Details"></td>
                            </tr>
                        </table>

                        <table class="comparative-table">
                            <thead>
                                <tr>
                                    <th style="width: 40px; color: white;">#</th>
                                    <th style="width: 40%; color: white;">Item Specification</th>
                                    <th style="width: 15%; color: white;">Is quotation compliant?<br>Bidder to complete</th>
                                    <th style="color: white;">Details of goods offered.<br>Bidder to complete</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="item-number">1</td>
                                    <td class="spec-text">
                                        <div>‚Ä¢ Laptop computer with minimum 15" display</div>
                                        <div>‚Ä¢ Processor: Intel Core i7 or equivalent</div>
                                        <div>‚Ä¢ RAM: Minimum 16GB DDR4</div>
                                    </td>
                                    <td class="compliance-col">
                                        <div class="checkbox-options">
                                            <div class="checkbox-option"><input type="checkbox"> Yes</div>
                                            <div class="checkbox-option"><input type="checkbox"> No</div>
                                        </div>
                                    </td>
                                    <td class="details-col"><textarea placeholder="Insert details of goods offered" rows="4"></textarea></td>
                                </tr>
                            </tbody>
                        </table>

                        <div style="margin: 20px 0;">
                            <strong>ANY DEVIATION MUST BE LISTED BELOW:</strong>
                            <textarea class="form-input" rows="5" placeholder="List any deviations from requirements for Laptop computers"></textarea>
                        </div>

                        <div class="section-header-text">Delivery requirements ‚Äì‚Äì Comparative Data Table</div>

                        <table class="comparative-table">
                            <thead>
                                <tr>
                                    <th style="width: 40%; color: #ffffff !important; background: #004a99 !important;">Delivery Requirement</th>
                                    <th style="width: 15%; color: #ffffff !important; background: #004a99 !important;">Is quotation compliant?<br>Bidder to complete</th>
                                    <th style="color: #ffffff !important; background: #004a99 !important;">Details<br>Bidder to complete</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="spec-text"><strong>Delivery time for the goods</strong><br>
                                    Bidder shall make the goods available at FCA (Incoterms2020) preferably within 60 days available after receipt of confirmation from UNOPS to start the production process. Bidder shall deliver the goods to DPU (Incoterms2020) Tashkent, Uzbekistan within 90 days after Contract signature.</td>
                                    <td class="compliance-col">
                                        <div class="checkbox-options">
                                            <div class="checkbox-option"><input type="checkbox"> Yes</div>
                                            <div class="checkbox-option"><input type="checkbox"> No</div>
                                        </div>
                                    </td>
                                    <td class="details-col"><textarea placeholder="Insert details"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="spec-text"><strong>Delivery place and Incoterms rules</strong><br>
                                    Bidder's quoted FCA point ‚Äì FCA (Incoterms2020)<br>
                                    Tashkent, Uzbekistan ‚Äì DPU (Incoterms2020)</td>
                                    <td class="compliance-col">
                                        <div class="checkbox-options">
                                            <div class="checkbox-option"><input type="checkbox"> Yes</div>
                                            <div class="checkbox-option"><input type="checkbox"> No</div>
                                        </div>
                                    </td>
                                    <td class="details-col"><textarea placeholder="Insert details"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="spec-text"><strong>Consignee details</strong><br>
                                    United Nations Office for Project Services (UNOPS)<br>
                                    AUMCO Uzbekistan Office.<br>
                                    Address: Grand Inter Building, Business center, 4 a Afrosiab Street, Tashkent, Uzbekistan</td>
                                    <td class="compliance-col">
                                        <div class="checkbox-options">
                                            <div class="checkbox-option"><input type="checkbox"> Yes</div>
                                            <div class="checkbox-option"><input type="checkbox"> No</div>
                                        </div>
                                    </td>
                                    <td class="details-col"><textarea placeholder="Insert details"></textarea></td>
                                </tr>
                            </tbody>
                        </table>
                        
                        </div><!-- End formDOnlineForm -->

                        </div>
                    </div>

                    <!-- FORM G: Performance Statement Form -->
                    <div class="form-document" id="formG">
                        <div class="form-section-header" style="color: #ffffff !important; background: linear-gradient(135deg, #00476c 0%, #003c5d 100%) !important;">Form G: Performance Statement Form</div>
                        <div class="form-section-body">
                        
                        <table class="itb-table">
                            <thead>
                                <tr>
                                    <th style="width: 18%; color: #ffffff !important; background: #00476c !important;">Order placed by<br>(Full address of purchaser)</th>
                                    <th style="width: 12%; color: #ffffff !important; background: #00476c !important;">Order no & date</th>
                                    <th style="width: 18%; color: #ffffff !important; background: #00476c !important;">Description & quantity of ordered items</th>
                                    <th style="width: 10%; color: #ffffff !important; background: #00476c !important;">Value of Order</th>
                                    <th colspan="2" style="width: 18%; color: #ffffff !important; background: #00476c !important;">Date of completion of Delivery</th>
                                    <th style="width: 12%; color: #ffffff !important; background: #00476c !important;">Remarks indicating reasons of late delivery, if any</th>
                                    <th style="width: 12%; color: #ffffff !important; background: #00476c !important;">Was the supplies of goods satisfactory?</th>
                                </tr>
                                <tr>
                                    <th colspan="4" style="color: #ffffff !important; background: #00476c !important;"></th>
                                    <th style="color: #ffffff !important; background: #00476c !important;">As per Contract</th>
                                    <th style="color: #ffffff !important; background: #00476c !important;">Actual</th>
                                    <th colspan="2" style="color: #ffffff !important; background: #00476c !important;"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="editable-cell"><textarea rows="3"></textarea></td>
                                    <td class="editable-cell"><input type="text"></td>
                                    <td class="editable-cell"><textarea rows="3"></textarea></td>
                                    <td class="editable-cell"><input type="text"></td>
                                    <td class="editable-cell"><input type="date"></td>
                                    <td class="editable-cell"><input type="date"></td>
                                    <td class="editable-cell"><textarea rows="3"></textarea></td>
                                    <td class="editable-cell"><textarea rows="3"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="editable-cell"><textarea rows="3"></textarea></td>
                                    <td class="editable-cell"><input type="text"></td>
                                    <td class="editable-cell"><textarea rows="3"></textarea></td>
                                    <td class="editable-cell"><input type="text"></td>
                                    <td class="editable-cell"><input type="date"></td>
                                    <td class="editable-cell"><input type="date"></td>
                                    <td class="editable-cell"><textarea rows="3"></textarea></td>
                                    <td class="editable-cell"><textarea rows="3"></textarea></td>
                                </tr>
                                <tr>
                                    <td class="editable-cell"><textarea rows="3"></textarea></td>
                                    <td class="editable-cell"><input type="text"></td>
                                    <td class="editable-cell"><textarea rows="3"></textarea></td>
                                    <td class="editable-cell"><input type="text"></td>
                                    <td class="editable-cell"><input type="date"></td>
                                    <td class="editable-cell"><input type="date"></td>
                                    <td class="editable-cell"><textarea rows="3"></textarea></td>
                                    <td class="editable-cell"><textarea rows="3"></textarea></td>
                                </tr>
                            </tbody>
                        </table>

                        <button class="add-row-btn">+ Add Another Reference</button>
                        </div>
                    </div>

                    <!-- FORM H: Self Disclosure Form -->
                    <div class="form-document" id="formH">
                        <div class="form-section-header" style="color: #ffffff !important; background: linear-gradient(135deg, #00476c 0%, #003c5d 100%) !important;">Form H: Self Disclosure Form</div>
                        <div class="form-section-body">
                        
                        <table class="itb-table">
                            <thead>
                                <tr>
                                    <th style="width: 5%; color: #ffffff !important; background: #00476c !important;">Ref.</th>
                                    <th style="width: 60%; color: #ffffff !important; background: #00476c !important;">Critical area</th>
                                    <th style="width: 10%; color: #ffffff !important; background: #00476c !important;">Response</th>
                                    <th style="width: 25%; color: #ffffff !important; background: #00476c !important;">Comments</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="text-align: center; font-weight: 600;">1</td>
                                    <td>Has the entity or individual declared bankruptcy, or been involved in bankruptcy or receivership proceedings, or is there any judgment or pending legal action against them, which could impair operations in the foreseeable future;</td>
                                    <td class="editable-cell">
                                        <select>
                                            <option>Select</option>
                                            <option>Yes</option>
                                            <option>No</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell"><textarea placeholder="If the response is 'Yes', provide an explanation here."></textarea></td>
                                </tr>
                                <tr>
                                    <td style="text-align: center; font-weight: 600;">2</td>
                                    <td>Has the entity or individual been found (or is awaiting a judgment or administrative decision) in breach of their obligations relating to the payment of taxes or social security contributions?</td>
                                    <td class="editable-cell">
                                        <select>
                                            <option>Select</option>
                                            <option>Yes</option>
                                            <option>No</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell"><textarea placeholder="If the response is 'Yes', provide an explanation here."></textarea></td>
                                </tr>
                                <tr>
                                    <td style="text-align: center; font-weight: 600;">3</td>
                                    <td>Has the entity or individual been found (or is awaiting a judgment or administrative decision) guilty of misconduct for the violation of applicable laws, regulations or ethical standards of the profession to which they belong?</td>
                                    <td class="editable-cell">
                                        <select>
                                            <option>Select</option>
                                            <option>Yes</option>
                                            <option>No</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell"><textarea placeholder="If the response is 'Yes', provide an explanation here."></textarea></td>
                                </tr>
                                <tr>
                                    <td style="text-align: center; font-weight: 600;">4</td>
                                    <td>Has the entity or individual engaged, or attempted to engage, in any Proscribed Practices in the past? For the purposes of this provision, "Proscribed Practices" are defined in the UNOPS Operational Instruction on Vendor Sanctions and include: corrupt practice, fraudulent practice, coercive practice, collusive practice, unethical practice, and obstruction.</td>
                                    <td class="editable-cell">
                                        <select>
                                            <option>Select</option>
                                            <option>Yes</option>
                                            <option>No</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell"><textarea placeholder="If the response is 'Yes', provide an explanation here."></textarea></td>
                                </tr>
                                <tr>
                                    <td style="text-align: center; font-weight: 600;">5</td>
                                    <td>Has the entity or individual unduly obtained, or attempted to unduly obtain, any confidential information in connection with this procurement process and any agreement that may be awarded as a result of this process?</td>
                                    <td class="editable-cell">
                                        <select>
                                            <option>Select</option>
                                            <option>Yes</option>
                                            <option>No</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell"><textarea placeholder="If the response is 'Yes', provide an explanation here."></textarea></td>
                                </tr>
                                <tr>
                                    <td style="text-align: center; font-weight: 600;">6</td>
                                    <td>Does the entity or individual have a conflict of interest, as provided in the Instructions to bidders, Article 4 "Bidder eligibility", that may prevent them from entering into an agreement with UNOPS, or that may in any way jeopardize their performance in carrying out their obligations under the agreement?</td>
                                    <td class="editable-cell">
                                        <select>
                                            <option>Select</option>
                                            <option>Yes</option>
                                            <option>No</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell"><textarea placeholder="If the response is 'Yes', provide an explanation here."></textarea></td>
                                </tr>
                                <tr>
                                    <td style="text-align: center; font-weight: 600;">7</td>
                                    <td>Has the entity or individual been found (or is awaiting a judgment or administrative decision) to be involved in any of the following: Fraudulent practice; Corrupt practice; Affiliation with a criminal organization; Money laundering; Terrorist financing; Child labour; or Human trafficking?</td>
                                    <td class="editable-cell">
                                        <select>
                                            <option>Select</option>
                                            <option>Yes</option>
                                            <option>No</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell"><textarea placeholder="If the response is 'Yes', provide an explanation here."></textarea></td>
                                </tr>
                                <tr>
                                    <td style="text-align: center; font-weight: 600;">8</td>
                                    <td>Has the entity or individual had significant performance issues in the past that led to the early termination of a legal commitment or the application of damages or other contractual penalties, or that were discovered following inspections, audits or investigations?</td>
                                    <td class="editable-cell">
                                        <select>
                                            <option>Select</option>
                                            <option>Yes</option>
                                            <option>No</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell"><textarea placeholder="If the response is 'Yes', provide an explanation here."></textarea></td>
                                </tr>
                                <tr>
                                    <td style="text-align: center; font-weight: 600;">9</td>
                                    <td>Has the entity or individual committed any financial irregularity, resulting from an act or omission or the inclusion of an unjustified item of expenditure outside a contractual engagement that had the effect of prejudicing their use of public funds?</td>
                                    <td class="editable-cell">
                                        <select>
                                            <option>Select</option>
                                            <option>Yes</option>
                                            <option>No</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell"><textarea placeholder="If the response is 'Yes', provide an explanation here."></textarea></td>
                                </tr>
                                <tr>
                                    <td style="text-align: center; font-weight: 600;">10</td>
                                    <td>Has the entity or individual been found (or is awaiting a judgment or administrative decision) to have created an entity in a different jurisdiction with the intent of circumventing fiscal, social or any other legal obligations in the jurisdiction of their registered office, central administration or principal place of business?</td>
                                    <td class="editable-cell">
                                        <select>
                                            <option>Select</option>
                                            <option>Yes</option>
                                            <option>No</option>
                                        </select>
                                    </td>
                                    <td class="editable-cell"><textarea placeholder="If the response is 'Yes', provide an explanation here."></textarea></td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="declaration-box">
                            <p style="font-weight: 600;">I, the undersigned, hereby declare that the information provided is true and correct. I also understand that any willful dishonesty may result in the refusal of this submission. I understand that engagement in any of the above critical areas may, at the discretion of UNOPS, automatically result in the exclusion from this procurement process.</p>
                        </div>
                        </div>
                    </div>

                    <!-- FINAL SIGNATURE SECTION FOR ALL FORMS -->
                    <div class="form-document final-signature-document">
                        <div class="form-section-header" style="color: #ffffff !important; background: linear-gradient(135deg, #00476c 0%, #003c5d 100%) !important;">
                            ‚úçÔ∏è Final Signature and Declaration
                        </div>
                        <div class="form-section-body">
                        <div class="form-note info">
                            <strong>Important:</strong> By signing below, you certify that all information provided in the above Returnable Bidding Forms (A through H) is accurate, complete, and true to the best of your knowledge. This signature binds your organization to the declarations made in all submitted forms.
                        </div>

                        <div class="declaration-box" style="background: var(--unops-yellow-0); border-left: 4px solid var(--unops-yellow-400);">
                            <p style="font-weight: 600; margin-bottom: 15px;">I, the undersigned, certify that:</p>
                            <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                                <li>I am duly authorized by <strong><input type="text" class="prefilled-field" readonly style="width: 300px; border: none; border-bottom: 2px solid var(--unops-blue2-400); padding: 2px 8px; background: var(--unops-blue-0); margin: 0 5px; font-weight: 600;" value="Global Tech Solutions Ltd."></strong> to sign this bid</li>
                                <li>I have the authority to bind <strong><input type="text" class="prefilled-field" readonly style="width: 300px; border: none; border-bottom: 2px solid var(--unops-blue2-400); padding: 2px 8px; background: var(--unops-blue-0); margin: 0 5px; font-weight: 600;" value="Global Tech Solutions Ltd."></strong> should UNOPS accept this bid</li>
                                <li>All information provided in Forms A through H is accurate and complete</li>
                                <li>I accept all terms and conditions outlined in the ITB documents</li>
                            </ul>
                        </div>

                        <div class="signature-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 30px;">
                            <div class="signature-field">
                                <label style="font-weight: 600; margin-bottom: 8px; display: block;">Full Name: <span class="required">*</span></label>
                                <input type="text" class="form-input" placeholder="Enter your full name">
                            </div>
                            
                            <div class="signature-field">
                                <label style="font-weight: 600; margin-bottom: 8px; display: block;">Title/Position: <span class="required">*</span></label>
                                <input type="text" class="form-input" placeholder="Enter your title">
                            </div>
                            
                            <div class="signature-field">
                                <label style="font-weight: 600; margin-bottom: 8px; display: block;">Date: <span class="required">*</span></label>
                                <input type="date" class="form-input">
                            </div>
                            
                            <div class="signature-field">
                                <label style="font-weight: 600; margin-bottom: 8px; display: block;">Contact Email: <span class="required">*</span></label>
                                <input type="email" class="form-input" placeholder="your.email@company.com">
                            </div>
                        </div>

                        <div class="signature-field" style="margin-top: 30px;">
                            <label style="font-weight: 600; margin-bottom: 8px; display: block;">Digital Signature / Upload Signed Document: <span class="required">*</span></label>
                            <div class="signature-upload-area">
                                <div class="signature-canvas-placeholder">
                                    <p>üìù Click here to sign digitally or upload scanned signature</p>
                                    <input type="file" accept=".pdf,.jpg,.png" style="margin-top: 10px;">
                                </div>
                            </div>
                        </div>
                        
                        <div class="stamp-box" style="margin-top: 30px; text-align: center; padding: 40px; border: 3px dashed var(--unops-n-cold-300); background: var(--unops-n-cold-50);">
                            <strong>Official Company Stamp / Seal</strong>
                            <p style="margin: 10px 0 0 0; color: var(--unops-n-cold-600);">[Affix official stamp or seal of the bidder here]</p>
                        </div>

                        <div class="form-note" style="margin-top: 30px; background: var(--unops-n-cold-50); border-left: 4px solid var(--unops-n-cold-400);">
                            <p><strong>Note:</strong> This signature and stamp validates all Returnable Bidding Forms submitted as part of your bid. Ensure all forms are complete before signing. Once submitted, amendments may not be accepted unless specifically requested by UNOPS.</p>
                        </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Action Bar (appears in supplier view) -->
    <div class="action-bar" id="actionBar" style="display: none;">
        <button class="btn btn-secondary" onclick="alert('Draft saved')">üíæ Save Draft</button>
        <button class="btn btn-primary" onclick="alert('Validating forms...')">‚úì Validate Forms</button>
        <button class="btn btn-success" onclick="alert('Submit confirmation...')">üì§ Submit Bid</button>
    </div>

    <script>
        function switchView(view) {
            const authoringView = document.getElementById('authoringView');
            const supplierView = document.getElementById('supplierView');
            const actionBar = document.getElementById('actionBar');
            const buttons = document.querySelectorAll('.toggle-btn');

            buttons.forEach(btn => btn.classList.remove('active'));

            if (view === 'authoring') {
                authoringView.classList.remove('hidden');
                supplierView.classList.remove('active');
                actionBar.style.display = 'none';
                buttons[0].classList.add('active');
            } else {
                authoringView.classList.add('hidden');
                supplierView.classList.add('active');
                actionBar.style.display = 'flex';
                buttons[1].classList.add('active');
                
                // Attach collapse handlers to form headers in supplier view
                document.querySelectorAll('.supplier-view .form-section-header').forEach(header => {
                    header.style.cursor = 'pointer';
                    header.onclick = function() {
                        const formDoc = this.closest('.form-document');
                        formDoc.classList.toggle('collapsed');
                    };
                });
            }
        }
        
        // Toggle individual form in supplier view
        function toggleForm(formElement) {
            formElement.classList.toggle('collapsed');
        }

        function scrollToForm(formId) {
            document.getElementById(formId).scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Update navigation active state
            document.querySelectorAll('.form-navigation li').forEach(li => li.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Auto-calculate totals in price schedule
        document.addEventListener('input', function(e) {
            if (e.target.matches('.itb-table input[type="number"]')) {
                const row = e.target.closest('tr');
                if (row) {
                    const qty = parseFloat(row.cells[2]?.textContent) || 0;
                    const unitPrice = parseFloat(e.target.value) || 0;
                    const totalCell = row.querySelector('.readonly-cell input');
                    if (totalCell && qty) {
                        totalCell.value = (qty * unitPrice).toFixed(2);
                    }
                }
            }
        });

        // JV Partner Management (for Authoring view - if needed later)
        let partnerCount = 0;
        let leadPartnerIndex = null;

        // Supplier View Partner Management
        let supplierPartnerCount = 0;
        let supplierLeadPartnerIndex = null;

        function toggleJVFields() {
            const isJV = document.querySelector('input[name="isJV"]:checked')?.value === 'yes';
            const jvFields = document.getElementById('jvFields');
            if (jvFields) {
                jvFields.style.display = isJV ? 'block' : 'none';
                
                // Initialize with one partner if showing for first time
                if (isJV && partnerCount === 0) {
                    addJVPartner();
                }
            }
        }

        function addJVPartner() {
            partnerCount++;
            const container = document.getElementById('partnersContainer');
            if (!container) return;
            
            const isFirstPartner = partnerCount === 1;
            
            const partnerCard = document.createElement('div');
            partnerCard.className = 'partner-card' + (isFirstPartner ? ' lead-partner' : '');
            partnerCard.id = `partner-${partnerCount}`;
            partnerCard.setAttribute('data-partner-id', partnerCount);
            
            if (isFirstPartner) {
                leadPartnerIndex = partnerCount;
            }
            
            partnerCard.innerHTML = `
                <div class="partner-card-header">
                    <span class="partner-number">Partner ${partnerCount}</span>
                    ${isFirstPartner ? '<span class="lead-badge">LEAD PARTNER</span>' : ''}
                </div>
                
                <div class="partner-grid">
                    <div class="partner-field">
                        <label>Company Name <span class="required">*</span></label>
                        <input type="text" class="partner-name" placeholder="Enter company name" 
                               onchange="updatePartnerData(${partnerCount})">
                    </div>
                    
                    <div class="partner-field">
                        <label>UNGM ID (Optional)</label>
                        <input type="text" placeholder="UNGM-XXXXXX">
                    </div>
                </div>
                
                <div class="partner-grid full-width">
                    <div class="partner-field">
                        <label>Full Address <span class="required">*</span></label>
                        <textarea placeholder="Street address, City, State/Province, Postal Code, Country"></textarea>
                    </div>
                </div>
                
                <div class="partner-grid">
                    <div class="partner-field">
                        <label>Telephone Number <span class="required">*</span></label>
                        <input type="tel" placeholder="+1-XXX-XXX-XXXX">
                    </div>
                    
                    <div class="partner-field">
                        <label>Fax Number</label>
                        <input type="tel" placeholder="+1-XXX-XXX-XXXX">
                    </div>
                </div>
                
                <div class="partner-grid">
                    <div class="partner-field">
                        <label>Email Address <span class="required">*</span></label>
                        <input type="email" placeholder="email@company.com">
                    </div>
                    
                    <div class="partner-field percentage-field">
                        <label>Share of Responsibility (%) <span class="required">*</span></label>
                        <input type="number" min="0" max="100" value="${isFirstPartner ? 100 : 0}" 
                               class="percentage-input" 
                               onchange="updatePercentages()"
                               placeholder="0">
                        <span class="percentage-symbol">%</span>
                    </div>
                </div>
                
                <div class="partner-grid full-width">
                    <div class="partner-field">
                        <label>Type of Goods/Services to be Delivered</label>
                        <textarea placeholder="Describe the specific goods or services this partner will provide" rows="2"></textarea>
                    </div>
                </div>
                
                <div class="partner-controls">
                    <button type="button" class="btn-icon btn-lead ${isFirstPartner ? 'active' : ''}" 
                            onclick="setLeadPartner(${partnerCount})">
                        ${isFirstPartner ? '‚òÖ' : '‚òÜ'} ${isFirstPartner ? 'Lead Partner' : 'Make Lead'}
                    </button>
                    ${!isFirstPartner ? `<button type="button" class="btn-icon btn-remove" 
                            onclick="removePartner(${partnerCount})">
                        üóëÔ∏è Remove
                    </button>` : ''}
                </div>
            `;
            
            container.appendChild(partnerCard);
            updatePercentages();
        }

        function addJVPartnerSupplier() {
            supplierPartnerCount++;
            const container = document.getElementById('partnersContainerSupplier');
            const signatureContainer = document.getElementById('signatureBlocksSupplier');
            if (!container) return;
            
            const isFirstPartner = supplierPartnerCount === 1;
            
            const partnerCard = document.createElement('div');
            partnerCard.className = 'partner-card' + (isFirstPartner ? ' lead-partner' : '');
            partnerCard.id = `supplier-partner-${supplierPartnerCount}`;
            partnerCard.setAttribute('data-partner-id', supplierPartnerCount);
            
            if (isFirstPartner) {
                supplierLeadPartnerIndex = supplierPartnerCount;
            }
            
            partnerCard.innerHTML = `
                <div class="partner-card-header">
                    <span class="partner-number">Partner ${supplierPartnerCount}</span>
                    ${isFirstPartner ? '<span class="lead-badge">LEAD PARTNER</span>' : ''}
                </div>
                
                <div class="partner-grid">
                    <div class="partner-field">
                        <label>Name <span class="required">*</span></label>
                        <input type="text" class="partner-name-supplier" placeholder="Enter partner company name" 
                               data-partner-id="${supplierPartnerCount}"
                               onchange="updateSupplierPartnerData(${supplierPartnerCount})">
                    </div>
                    
                    <div class="partner-field">
                        <label>UNGM ID (if registered)</label>
                        <input type="text" placeholder="UNGM-XXXXXX" class="ungm-id-supplier">
                    </div>
                </div>
                
                <div class="partner-grid full-width">
                    <div class="partner-field">
                        <label>Address <span class="required">*</span></label>
                        <textarea placeholder="Complete address: Street, City, State/Province, Postal Code, Country" rows="2"></textarea>
                    </div>
                </div>
                
                <div class="partner-grid">
                    <div class="partner-field">
                        <label>Telephone Number <span class="required">*</span></label>
                        <input type="tel" placeholder="+X-XXX-XXX-XXXX">
                    </div>
                    
                    <div class="partner-field">
                        <label>Fax Number</label>
                        <input type="tel" placeholder="+X-XXX-XXX-XXXX">
                    </div>
                </div>
                
                <div class="partner-grid">
                    <div class="partner-field">
                        <label>E-mail Address <span class="required">*</span></label>
                        <input type="email" placeholder="contact@company.com">
                    </div>
                    
                    <div class="partner-field percentage-field">
                        <label>Proposed Proportion of Responsibilities (%) <span class="required">*</span></label>
                        <input type="number" min="0" max="100" value="${isFirstPartner ? 100 : 0}" 
                               class="percentage-input-supplier" 
                               onchange="updateSupplierPercentages()"
                               placeholder="0">
                        <span class="percentage-symbol">%</span>
                    </div>
                </div>
                
                <div class="partner-grid full-width">
                    <div class="partner-field">
                        <label>Type of Goods/Services to be Delivered by this Partner</label>
                        <textarea placeholder="Indicate the type of goods/services to be delivered by this partner" rows="2"></textarea>
                    </div>
                </div>
                
                <div class="partner-grid full-width">
                    <div class="partner-field">
                        <div class="checkbox-option" style="margin-top: 10px;">
                            <input type="checkbox" id="lead-${supplierPartnerCount}" 
                                   ${isFirstPartner ? 'checked' : ''}
                                   onchange="setSupplierLeadPartner(${supplierPartnerCount})">
                            <label for="lead-${supplierPartnerCount}" style="font-weight: normal; margin: 0;">
                                <strong>Leading Partner</strong> (with authority to bind the JV, Consortium, Association during the Bidding process and, in the event a Contract is awarded, during contract execution)
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="partner-controls">
                    ${!isFirstPartner ? `<button type="button" class="btn-icon btn-remove" 
                            onclick="removeSupplierPartner(${supplierPartnerCount})">
                        üóëÔ∏è Remove Partner
                    </button>` : ''}
                </div>
            `;
            
            container.appendChild(partnerCard);
            updateSupplierPercentages();
            updateSupplierSignatureBlocks();
        }

        function setSupplierLeadPartner(partnerIndex) {
            // Uncheck all other lead checkboxes
            document.querySelectorAll('input[id^="lead-"]').forEach(checkbox => {
                if (checkbox.id !== `lead-${partnerIndex}`) {
                    checkbox.checked = false;
                }
            });
            
            // Remove lead styling from all cards
            document.querySelectorAll('.partner-card').forEach(card => {
                card.classList.remove('lead-partner');
                const badge = card.querySelector('.lead-badge');
                if (badge) badge.remove();
            });
            
            // Add lead styling to selected card
            const currentCard = document.getElementById(`supplier-partner-${partnerIndex}`);
            if (currentCard && document.getElementById(`lead-${partnerIndex}`).checked) {
                currentCard.classList.add('lead-partner');
                const header = currentCard.querySelector('.partner-card-header');
                if (!header.querySelector('.lead-badge')) {
                    const badge = document.createElement('span');
                    badge.className = 'lead-badge';
                    badge.textContent = 'LEAD PARTNER';
                    header.appendChild(badge);
                }
                supplierLeadPartnerIndex = partnerIndex;
            }
        }

        function removeSupplierPartner(partnerIndex) {
            const card = document.getElementById(`supplier-partner-${partnerIndex}`);
            if (card) {
                card.remove();
                updateSupplierPercentages();
                updateSupplierSignatureBlocks();
            }
        }

        function updateSupplierPercentages() {
            const percentageInputs = document.querySelectorAll('.percentage-input-supplier');
            let total = 0;
            
            percentageInputs.forEach(input => {
                total += parseFloat(input.value) || 0;
            });
            
            const totalSpan = document.getElementById('totalPercentageSupplier');
            const statusSpan = document.getElementById('percentageStatusSupplier');
            const summary = document.getElementById('percentageSummarySupplier');
            
            if (!totalSpan || !statusSpan || !summary) return;
            
            totalSpan.textContent = total.toFixed(0);
            
            summary.classList.remove('valid', 'invalid');
            
            if (total === 100) {
                summary.classList.add('valid');
                statusSpan.textContent = '‚úì Valid';
                statusSpan.style.color = 'var(--unops-green-500)';
            } else {
                summary.classList.add('invalid');
                statusSpan.textContent = total > 100 ? '‚ö† Exceeds 100%' : '‚ö† Must equal 100%';
                statusSpan.style.color = 'var(--unops-red-600)';
            }
        }

        function updateSupplierSignatureBlocks() {
            // Signature blocks no longer used in Form A - signatures collected at the end
            // Keeping function for backward compatibility
        }

        function updateSupplierPartnerData(partnerIndex) {
            // Partner data updated - no signature blocks to update
        }

        function setLeadPartner(partnerIndex) {
            // Remove lead status from previous lead
            if (leadPartnerIndex) {
                const prevLeadCard = document.getElementById(`partner-${leadPartnerIndex}`);
                if (prevLeadCard) {
                    prevLeadCard.classList.remove('lead-partner');
                    const prevBadge = prevLeadCard.querySelector('.lead-badge');
                    if (prevBadge) prevBadge.remove();
                    
                    const prevBtn = prevLeadCard.querySelector('.btn-lead');
                    if (prevBtn) {
                        prevBtn.classList.remove('active');
                        prevBtn.innerHTML = '‚òÜ Make Lead';
                    }
                }
            }
            
            // Set new lead
            leadPartnerIndex = partnerIndex;
            const newLeadCard = document.getElementById(`partner-${partnerIndex}`);
            newLeadCard.classList.add('lead-partner');
            
            const header = newLeadCard.querySelector('.partner-card-header');
            if (!header.querySelector('.lead-badge')) {
                const badge = document.createElement('span');
                badge.className = 'lead-badge';
                badge.textContent = 'LEAD PARTNER';
                header.appendChild(badge);
            }
            
            const btn = newLeadCard.querySelector('.btn-lead');
            btn.classList.add('active');
            btn.innerHTML = '‚òÖ Lead Partner';
        }

        function removePartner(partnerIndex) {
            const card = document.getElementById(`partner-${partnerIndex}`);
            if (card) {
                card.remove();
                updatePercentages();
            }
        }

        function updatePercentages() {
            const percentageInputs = document.querySelectorAll('.percentage-input');
            let total = 0;
            
            percentageInputs.forEach(input => {
                total += parseFloat(input.value) || 0;
            });
            
            const totalSpan = document.getElementById('totalPercentage');
            const statusSpan = document.getElementById('percentageStatus');
            const summary = document.getElementById('percentageSummary');
            
            if (!totalSpan || !statusSpan || !summary) return;
            
            totalSpan.textContent = total.toFixed(0);
            
            summary.classList.remove('valid', 'invalid');
            
            if (total === 100) {
                summary.classList.add('valid');
                statusSpan.textContent = '‚úì Valid';
                statusSpan.style.color = 'var(--unops-green-500)';
            } else {
                summary.classList.add('invalid');
                statusSpan.textContent = total > 100 ? '‚ö† Exceeds 100%' : '‚ö† Must equal 100%';
                statusSpan.style.color = 'var(--unops-red-600)';
            }
        }

        function updatePartnerData(partnerIndex) {
            // Placeholder for data validation/update logic
            console.log('Partner data updated:', partnerIndex);
        }

        // Toggle Incoterm columns visibility in Form C
        function toggleIncotermColumns() {
            const fcaChecked = document.getElementById('incoterm-toggle-fca')?.checked ?? true;
            const cptChecked = document.getElementById('incoterm-toggle-cpt')?.checked ?? true;
            const dpuChecked = document.getElementById('incoterm-toggle-dpu')?.checked ?? true;

            // Hide/show Bid Summary rows
            document.querySelectorAll('.incoterm-row-fca').forEach(el => {
                el.style.display = fcaChecked ? '' : 'none';
            });
            document.querySelectorAll('.incoterm-row-cpt').forEach(el => {
                el.style.display = cptChecked ? '' : 'none';
            });
            document.querySelectorAll('.incoterm-row-dpu').forEach(el => {
                el.style.display = dpuChecked ? '' : 'none';
            });

            // Hide/show Prices for Goods columns
            document.querySelectorAll('.incoterm-fca').forEach(el => {
                el.style.display = fcaChecked ? '' : 'none';
            });
            document.querySelectorAll('.incoterm-cpt').forEach(el => {
                el.style.display = cptChecked ? '' : 'none';
            });
            document.querySelectorAll('.incoterm-dpu').forEach(el => {
                el.style.display = dpuChecked ? '' : 'none';
            });

            // Update colspan in total row
            const totalRow = document.querySelector('#formC tbody tr[style*="font-weight: 600"]');
            if (totalRow) {
                const visibleIncoterms = (fcaChecked ? 1 : 0) + (cptChecked ? 1 : 0) + (dpuChecked ? 1 : 0);
                const baseColumns = 4; // Item, Description, Qty, Currency
                const unitPriceColumns = visibleIncoterms;
                const totalColumns = baseColumns + unitPriceColumns;
                
                totalRow.cells[0].setAttribute('colspan', totalColumns);
            }
        }

        // Toggle Related Services section visibility in Form C
        function toggleRelatedServices() {
            const checked = document.getElementById('toggle-related-services')?.checked ?? true;
            
            // Hide/show all elements with related-services-section class
            document.querySelectorAll('.related-services-section').forEach(el => {
                el.style.display = checked ? '' : 'none';
            });
        }

        function toggleShipmentDelivery() {
            const checked = document.getElementById('toggle-shipment-delivery')?.checked ?? true;
            const columnsConfig = document.getElementById('shipment-columns-config');
            
            if (columnsConfig) {
                columnsConfig.style.display = checked ? '' : 'none';
            }
            
            // Hide/show the entire Shipment & Delivery section using the wrapper div
            const shipmentSection = document.getElementById('shipment-delivery-section');
            if (shipmentSection) {
                shipmentSection.style.display = checked ? '' : 'none';
            }
        }

        function updateShipmentColumns() {
            // Get all column checkboxes
            const checkboxes = document.querySelectorAll('.shipment-col-toggle');
            
            checkboxes.forEach(checkbox => {
                const colName = checkbox.dataset.col;
                const isChecked = checkbox.checked;
                const className = `.shipment-col-${colName}`;
                
                // Hide/show all elements with this column class
                document.querySelectorAll(className).forEach(el => {
                    el.style.display = isChecked ? '' : 'none';
                });
                
                // Also handle th elements with data-col attribute
                document.querySelectorAll(`[data-col="${colName}"]`).forEach(el => {
                    if (el.tagName === 'TH' || el.tagName === 'TD') {
                        el.style.display = isChecked ? '' : 'none';
                    }
                });
            });
            
            // Handle Containers colspan header
            const containerNumCheckbox = document.querySelector('.shipment-col-toggle[data-col="container-num"]');
            const containerSizeCheckbox = document.querySelector('.shipment-col-toggle[data-col="container-size"]');
            const containerNumChecked = containerNumCheckbox ? containerNumCheckbox.checked : true;
            const containerSizeChecked = containerSizeCheckbox ? containerSizeCheckbox.checked : true;
            const containersHeader = document.querySelector('[data-col="containers"]');
            
            if (containersHeader) {
                if (!containerNumChecked && !containerSizeChecked) {
                    containersHeader.style.display = 'none';
                } else if (containerNumChecked && containerSizeChecked) {
                    containersHeader.style.display = '';
                    containersHeader.setAttribute('colspan', '2');
                } else {
                    containersHeader.style.display = '';
                    containersHeader.setAttribute('colspan', '1');
                }
            }
            
            // Update colspan for totals row
            updateShipmentColspan();
        }

        function updateShipmentColspan() {
            const totalRow = document.querySelector('#shipment-delivery-table tbody tr:last-child');
            if (totalRow) {
                const firstCell = totalRow.cells[0];
                if (firstCell) {
                    // Count visible columns in the first header row and second header row
                    let visibleCols = 0;
                    document.querySelectorAll('#shipment-header-row-1 th').forEach(th => {
                        if (th.style.display !== 'none') {
                            const colspan = parseInt(th.getAttribute('colspan') || '1');
                            visibleCols += colspan;
                        }
                    });
                    firstCell.setAttribute('colspan', visibleCols);
                }
            }
        }

        let customColumnCounter = 0;
        function addCustomShipmentColumn() {
            const input = document.getElementById('custom-column-name');
            const columnName = input.value.trim();
            
            if (!columnName) {
                alert('Please enter a column name');
                return;
            }
            
            customColumnCounter++;
            const colId = `custom-col-${customColumnCounter}`;
            
            // Add to column list in authoring view
            const customList = document.getElementById('custom-columns-list');
            const colDiv = document.createElement('div');
            colDiv.style.cssText = 'display: flex; align-items: center; gap: 8px; margin-top: 8px; padding: 8px; background: white; border-radius: 6px; border: 1px solid var(--unops-n-cold-200);';
            colDiv.innerHTML = `
                <label style="display: flex; align-items: center; gap: 6px; flex: 1;">
                    <input type="checkbox" class="shipment-col-toggle" data-col="${colId}" checked onchange="updateShipmentColumns()">
                    <span>${columnName}</span>
                </label>
                <button type="button" onclick="this.parentElement.remove(); removeCustomColumn('${colId}')" style="background: #dc3545; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 11px;">Remove</button>
            `;
            customList.appendChild(colDiv);
            
            // Add column header to table (after last header in first row, before container colspan)
            const headerRow1 = document.getElementById('shipment-header-row-1');
            const newHeader = document.createElement('th');
            newHeader.rowSpan = 2;
            newHeader.dataset.col = colId;
            newHeader.className = `shipment-col-${colId}`;
            newHeader.style.cssText = 'color: #ffffff !important; background: #00476c !important;';
            newHeader.textContent = columnName;
            
            // Insert before the Containers colspan header
            const containersHeader = headerRow1.querySelector('[data-col="containers"]');
            if (containersHeader) {
                headerRow1.insertBefore(newHeader, containersHeader);
            } else {
                headerRow1.appendChild(newHeader);
            }
            
            // Add cells to each data row
            const dataRows = document.querySelectorAll('#shipment-delivery-table tbody tr:not(:last-child)');
            dataRows.forEach(row => {
                const newCell = document.createElement('td');
                newCell.dataset.col = colId;
                newCell.className = `editable-cell shipment-col-${colId}`;
                newCell.innerHTML = '<input type="text" placeholder="Enter data" style="width: 100%;">';
                
                // Insert before container-num cell
                const containerNumCell = row.querySelector('[data-col="container-num"]');
                if (containerNumCell) {
                    row.insertBefore(newCell, containerNumCell);
                } else {
                    row.appendChild(newCell);
                }
            });
            
            // Clear input
            input.value = '';
            
            // Update colspan
            updateShipmentColspan();
        }

        function removeCustomColumn(colId) {
            // Remove all elements with this column
            document.querySelectorAll(`[data-col="${colId}"]`).forEach(el => el.remove());
            document.querySelectorAll(`.shipment-col-${colId}`).forEach(el => el.remove());
            
            // Update colspan
            updateShipmentColspan();
        }

        function handleFormAUpload(input) {
            const file = input.files[0];
            const statusDiv = document.getElementById('upload-status');
            
            if (file) {
                // Show upload status
                statusDiv.innerHTML = `‚úÖ <strong>${file.name}</strong> uploaded successfully`;
                statusDiv.style.color = 'var(--unops-green-600)';
                
                // Add visual feedback to upload box
                input.closest('div').style.borderColor = 'var(--unops-green-500)';
                input.closest('div').style.background = 'var(--unops-green-0)';
            }
        }

        function downloadFormAPDF() {
            alert('Form A PDF download functionality would be implemented here.\n\nThis would generate a PDF with all partner information for signature collection.');
        }

        // Form D submission options toggling
        function toggleFormDSubmission() {
            const onlineChecked = document.getElementById('formDOnline').checked;
            const spreadsheetChecked = document.getElementById('formDSpreadsheet').checked;
            
            const onlineForm = document.getElementById('formDOnlineForm');
            const spreadsheetOptions = document.getElementById('formDSpreadsheetOptions');
            
            if (!onlineChecked && !spreadsheetChecked) {
                // If neither is checked, default to online only
                document.getElementById('formDOnline').checked = true;
                onlineForm.style.display = 'block';
                spreadsheetOptions.style.display = 'none';
                return;
            }
            
            // Show/hide based on selections
            onlineForm.style.display = onlineChecked ? 'block' : 'none';
            spreadsheetOptions.style.display = spreadsheetChecked ? 'block' : 'none';
        }

        function downloadTechnicalSpecsSpreadsheet() {
            alert('Technical Specifications Spreadsheet download functionality would be implemented here.\n\nThis would generate an Excel file with:\n- All UNSPSC codes and items\n- Technical specifications requirements\n- Delivery requirements\n- Pre-formatted cells for supplier input');
        }

        function handleTechSpecsUpload(input) {
            const file = input.files[0];
            const statusDiv = document.getElementById('tech-specs-upload-status');
            
            if (file) {
                // Validate file type
                const validTypes = ['.xlsx', '.xls'];
                const fileExtension = file.name.substring(file.name.lastIndexOf('.')).toLowerCase();
                
                if (!validTypes.includes(fileExtension)) {
                    statusDiv.innerHTML = '‚ùå Please upload an Excel file (.xlsx or .xls)';
                    statusDiv.style.color = 'var(--unops-red-600)';
                    input.value = '';
                    return;
                }
                
                // Show upload status
                statusDiv.innerHTML = `‚úÖ <strong>${file.name}</strong> uploaded successfully`;
                statusDiv.style.color = 'var(--unops-green-600)';
                
                // Add visual feedback to upload box
                input.closest('div').style.borderColor = 'var(--unops-green-500)';
                input.closest('div').style.background = 'var(--unops-green-0)';
            }
        }

        // Initialize Form A with one partner on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Check if we're on supplier view and if Form A partner container exists
            const supplierPartnerContainer = document.getElementById('partnersContainerSupplier');
            if (supplierPartnerContainer && supplierPartnerCount === 0) {
                addJVPartnerSupplier();
            }
            
            // Initialize Form D submission options
            toggleFormDSubmission();
        });

        // Download Form A as PDF
        function downloadFormAPDF() {
            // In a real implementation, this would generate a PDF of Form A with all partner data
            // For now, we'll show an alert as a placeholder
            alert('Form A PDF generation:\n\nIn the production system, this will:\n1. Generate a PDF of Form A with all partner information\n2. Include signature blocks for each partner\n3. Download the file for offline signing\n4. Allow you to upload the signed PDF back to the system\n\nFor this mockup, the functionality is simulated.');
            
            // Production implementation would use a library like jsPDF or send data to backend
            // Example: generatePDF('formA', partnersData);
        }

        // Toggle explanation field
        function toggleExplanation(id, show) {
            document.getElementById(id).style.display = show ? 'block' : 'none';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Section III: Returnable Bidding Forms loaded');
        });
    </script>
</body>
</html>
